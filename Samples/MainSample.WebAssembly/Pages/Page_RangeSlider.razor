@page "/range-slider"
@inherits BasePage

@using MainSample.WebAssembly.Examples
@using MudBlazor
@using MudBlazor.Extensions.Core
@using MudBlazor.Extensions.Helper
@using Nextended.Core.Contracts
@using Nextended.Core.Types

@attribute [DemoNew(Name = "Overview", Order = 0, Group = "RangeSlider", ForComponentTypes = new[] { typeof(MudExRangeSlider<>) })]

<SimpleExample />

<MudExDemoPage>

    <!-- Header / Intro -->
    <MudPaper Class="pa-6 mb-6">
        <MudText Typo="Typo.h4" GutterBottom="true">
            @L["MudEx Range Slider – Interactive range selection"]
        </MudText>

        <MudText Typo="Typo.body1">
            @L["On this page you can see several usage examples for the MudExRangeSlider: numeric ranges, date ranges and a vertical layout. Each example comes with a short explanation and can be tried out interactively."]
        </MudText>

        <MudAlert Severity="Severity.Info" Class="mt-4">
            @L["You can move the individual thumbs or the entire selected range to adjust start and end values. Depending on the configuration, minimum and maximum duration as well as different step sizes apply."]
        </MudAlert>
    </MudPaper>

    <!-- Quick overview (Key Features) -->
    <MudGrid Class="mb-6">
        <MudItem xs="12" md="4">
            <MudPaper Class="pa-4 h-100">
                <MudText Typo="Typo.subtitle1">
                    @L["Flexible data types"]
                </MudText>
                <MudText Typo="Typo.body2">
                    @L["Supports int and DateTime (other types via generics are possible)."]
                </MudText>
            </MudPaper>
        </MudItem>
        <MudItem xs="12" md="4">
            <MudPaper Class="pa-4 h-100">
                <MudText Typo="Typo.subtitle1">
                    @L["Min/max length & step size"]
                </MudText>
                <MudText Typo="Typo.body2">
                    @L["Define minimum and maximum duration for ranges as well as custom step sizes."]
                </MudText>
            </MudPaper>
        </MudItem>
        <MudItem xs="12" md="4">
            <MudPaper Class="pa-4 h-100">
                <MudText Typo="Typo.subtitle1">
                    @L["Horizontal & vertical orientation"]
                </MudText>
                <MudText Typo="Typo.body2">
                    @L["Use the slider horizontally or vertically – ideal for filters, dashboards and reports."]
                </MudText>
            </MudPaper>
        </MudItem>
    </MudGrid>

    <MudDivider Class="mb-6" />

    <!-- Demo 1: Simple numeric range slider -->
    <MudExDemoBox Title="1. Simple numeric range"
                  NavTitle="Simple numeric range"
                  Order="10"
                  FeaturesTitle="Configuration"
                  Features="@(new[]
                          {
                              "T = int – numeric range",
                              "SizeRange = 0–100",
                              "StepLength = 5 – values in steps of 5",
                              "@bind-Value = _nums – binds the selected range to your view model"
                          })">

        <DemoContent>
            <MudText Typo="Typo.body2" Class="mb-4">
                @L["In this example you control a simple numeric range from 0 to 100. The step size is set to 5 to allow coarse intervals."]
            </MudText>

            <MudText Typo="Typo.caption" Class="mt-2 mb-2">
                @L["Current range: {0} – {1}", _nums.Start, _nums.End]
            </MudText>

            <MudExCodeView Theme="@(MainLayout.Instance?.IsDark ?? false ? CodeBlockTheme.AtomOneDark : CodeBlockTheme.AtomOneLight)"
                           RenderChildContent="true">
                <MudExEditConfiguration>
                    <MudExRangeSlider T="int"
                                      SizeRange="@(new MudExRange<int>(0, 100))"
                                      StepLength="@(new RangeLength<int>(5))"
                                      @bind-Value="_nums" />
                </MudExEditConfiguration>
            </MudExCodeView>
        </DemoContent>
    </MudExDemoBox>

    <!-- Demo 2: Date range with daily steps -->
    <MudExDemoBox Title="2. Date range with daily step size"
                  NavTitle="Date range with daily step size"
                  Order="20"
                  FeaturesTitle="Highlights"
                  Features="@(new[]
                          {
                              "MinLength = 60 days – shortest allowed period",
                              "MaxLength = 730 days – longest allowed period",
                              "AllowWholeRangeDrag = true – entire period can be moved"
                          })">

        <DemoContent>
            <MudText Typo="Typo.body2" Class="mb-4">
                @L["This example shows a date range from 2015 until the end of 2022. The user can select a period of at least 60 days and at most 2 years. The step size is one day."]
            </MudText>

            <MudText Typo="Typo.caption" Class="mt-2 mb-2">
                @L["Current period: {0} – {1}", _period2.Start.ToShortDateString(), _period2.End.ToShortDateString()]
            </MudText>

            <MudExCodeView Theme="@(MainLayout.Instance?.IsDark ?? false ? CodeBlockTheme.AtomOneDark : CodeBlockTheme.AtomOneLight)"
                           RenderChildContent="true">
                <MudExRangeSlider T="DateTime"
                                  SizeRange="@(new RangeOf<DateTime>(new(2015, 1, 1), new(2022, 12, 31), null))"
                                  StepLength="@(new RangeLength<DateTime>(TimeSpan.FromDays(1).Ticks))"
                                  MinLength="@(new RangeLength<DateTime>(TimeSpan.FromDays(60).Ticks))"
                                  MaxLength="@(new RangeLength<DateTime>(TimeSpan.FromDays(365 * 2).Ticks))"
                                  @bind-Value="_period2"
                                  AllowWholeRangeDrag="true" />
            </MudExCodeView>
        </DemoContent>
    </MudExDemoBox>

    <!-- Demo 3: DateTime with StepResolver -->
    <MudExDemoBox Title="3. DateTime range with custom StepResolver"
                  NavTitle="DateTime range with custom StepResolver"
                  Order="30"
                  FeaturesTitle="StepResolver">

        <DemoContent>
            <MudText Typo="Typo.body2" Class="mb-4">
                @L["This example demonstrates a multi-year time range with a custom step behavior. With a StepResolver you define how the slider snaps (for example to months, quarters or hours)."]
            </MudText>

            <MudText Typo="Typo.caption" Class="mt-2 mb-2">
                @L["Current period: {0} – {1}", _period.Start.ToString("g"), _period.End.ToString("g")]
            </MudText>

            <MudExCodeView Theme="@(MainLayout.Instance?.IsDark ?? false ? CodeBlockTheme.AtomOneDark : CodeBlockTheme.AtomOneLight)"
                           RenderChildContent="true">
                <MudExRangeSlider T="DateTime"
                                  SizeRange="@(new MudExRange<DateTime>(new(2019, 1, 1, 2, 22, 12), new(2025, 12, 31, 6, 3, 12)))"
                                  StepResolver="@(StepResolvers.DateTime.Quarterly(_ => 1))"
                                  @bind-Value="_period"
                                  AllowWholeRangeDrag="true" />
            </MudExCodeView>

            <MudText Typo="Typo.body2" Class="mt-3">
                @L["With StepResolvers you can easily configure the stepping behavior. For date ranges we provide several predefined resolvers. In this example StepResolvers.DateTime.Quarterly(_ => 1) makes the slider snap to quarters."]
            </MudText>
        </DemoContent>
    </MudExDemoBox>

    <!-- Demo 4: Vertical range slider -->
    <MudExDemoBox Title="4. Vertical range slider"
                  NavTitle="Vertical range slider"
                  Order="40"
                  FeaturesTitle="Use cases"
                  Features="@(new[]
                          {
                              "Filters in dashboards or reports",
                              "Side filter panels in search or analytics UIs",
                              "Mobile UIs with limited horizontal space"
                          })">

        <DemoContent>
            <MudText Typo="Typo.body2" Class="mb-4">
                @L["The range slider can also be used vertically – ideal for sidebars or compact filter areas."]
            </MudText>

            <MudText Typo="Typo.caption" Class="mt-2 mb-2">
                @L["Current period (vertical): {0} – {1}", _period.Start.ToShortDateString(), _period.End.ToShortDateString()]
            </MudText>

            <MudExCodeView Theme="@(MainLayout.Instance?.IsDark ?? false ? CodeBlockTheme.AtomOneDark : CodeBlockTheme.AtomOneLight)"
                           RenderChildContent="true">
                <div style="height: 280px; display: flex; align-items: center;">
                    <MudExRangeSlider T="DateTime"
                                      Orientation="SliderOrientation.Vertical"
                                      SizeRange="@(new MudExRange<DateTime>(new(2016, 1, 1), new(2024, 12, 31)))"
                                      Size="Size.Large"
                                      ThumbColor="MudExColor.Tertiary"
                                      SelectionColor="MudExColor.Tertiary"
                                      @bind-Value="_period"
                                      AllowWholeRangeDrag="true">
                    </MudExRangeSlider>
                </div>
            </MudExCodeView>
        </DemoContent>
    </MudExDemoBox>

</MudExDemoPage>

<DemoNavigation CurrentPage="@this" />

@code {
    protected override Task OnInitializedAsync()
    {
        string hcls = MudExCss.Classes.General.MainClass;
        return base.OnInitializedAsync();
    }

    private IRange<int> _nums = new MudExRange<int>(20, 60);
    private IRange<DateTime> _period = new MudExRange<DateTime>(new(2021, 1, 1), new(2021, 12, 31));
    private IRange<DateTime> _period2 = new RangeOf<DateTime>(new(2021, 1, 1), new(2021, 12, 31), null);
}
