export function initializeMudExUploadEdit(n,t,i){function f(t){t.preventDefault();n.classList.add("hover")}function o(t){t.preventDefault();n.classList.remove("hover")}async function u(n,t){t=t||[];const i=[];for await(const[e,f]of n.entries())if(f.kind==="directory")t.push(e),i.push(...await u(f,t));else{var r=await f.getFile();r.relativePath=t?.join("/")+"/"+e;i.push(r)}return i}function r(n){t.files=Array.isArray(n)?h(n):n;t.dispatchEvent(new Event("change",{bubbles:!0}))}async function s(){const n=await window.showDirectoryPicker(),t=await u(n);r(t)}function h(n){const t=new DataTransfer;return(n||[]).forEach(n=>t.items.add(n)),t.files}function c(n){return!n.type||n.type===""?n.webkitGetAsEntry().isDirectory:!1}async function e(n){let t=[];for await(const i of n.dataTransfer?n.dataTransfer.items:n)c(i)?t.push(...await u(await i.getAsFileSystemHandle())):t.push(i.getAsFile());return t}async function l(t){t.preventDefault();t.stopPropagation();n.classList.remove("hover");i?(console.log("DROP WITH FOLDER UPLOAD "),console.log(t),r(await e(t))):(console.log("DROP WITHOUT FOLDER UPLOAD "),console.log(t),r(t.dataTransfer.files))}async function a(n){i?r(await e(n.clipboardData.items)):r(n.clipboardData.files)}return n&&(n.ondragenter=f,n.ondragover=f,n.ondragleave=o,n.ondrop=l,n.onpaste=a),{selectFolder:()=>{s()},dispose:()=>{n&&(n.ondragenter=null,n.ondragover=null,n.ondragleave=null,n.ondrop=null,n.onpaste=null)}}}