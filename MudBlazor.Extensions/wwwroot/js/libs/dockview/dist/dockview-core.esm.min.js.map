{"version":3,"file":"dockview-core.esm.min.js","sources":["../src/events.ts","../src/lifecycle.ts","../../../node_modules/style-inject/dist/style-inject.es.js","../src/dnd/dataTransfer.ts","../src/dom.ts","../src/array.ts","../src/math.ts","../src/splitview/viewItem.ts","../src/splitview/splitview.ts","../src/splitview/options.ts","../src/paneview/paneview.ts","../src/gridview/leafNode.ts","../src/gridview/branchNode.ts","../src/gridview/gridview.ts","../src/gridview/options.ts","../src/resizable.ts","../src/gridview/baseComponentGridview.ts","../src/api/component.api.ts","../src/dnd/abstractDragHandler.ts","../src/dnd/dnd.ts","../src/dnd/droptarget.ts","../src/paneview/options.ts","../src/api/panelApi.ts","../src/api/splitviewPanelApi.ts","../src/api/paneviewPanelApi.ts","../src/gridview/basePanelView.ts","../src/paneview/paneviewPanel.ts","../src/paneview/draggablePaneviewPanel.ts","../src/dockview/components/panel/content.ts","../src/dnd/ghost.ts","../src/dockview/components/tab/tab.ts","../src/dockview/events.ts","../src/dnd/groupDragHandler.ts","../src/dockview/components/titlebar/voidContainer.ts","../src/scrollbar.ts","../src/dockview/components/titlebar/tabs.ts","../src/svg.ts","../src/dockview/components/titlebar/tabsContainer.ts","../src/dockview/components/titlebar/tabOverflowControl.ts","../src/dockview/options.ts","../src/dockview/dockviewGroupPanelModel.ts","../src/api/gridviewPanelApi.ts","../src/gridview/gridviewPanel.ts","../src/api/dockviewGroupPanelApi.ts","../src/dockview/dockviewGroupPanel.ts","../src/dockview/theme.ts","../src/api/dockviewPanelApi.ts","../src/dockview/dockviewPanel.ts","../src/dockview/components/tab/defaultTab.ts","../src/dockview/dockviewPanelModel.ts","../src/dockview/deserializer.ts","../src/dockview/components/watermark/watermark.ts","../src/overlay/overlay.ts","../src/dockview/dockviewFloatingGroupPanel.ts","../src/constants.ts","../src/overlay/overlayRenderContainer.ts","../../../node_modules/tslib/tslib.es6.js","../src/popoutWindow.ts","../src/dockview/strictEventsSequencing.ts","../src/dockview/components/popupService.ts","../src/dnd/dropTargetAnchorContainer.ts","../src/dockview/dockviewComponent.ts","../src/gridview/gridviewComponent.ts","../src/splitview/splitviewComponent.ts","../src/paneview/defaultPaneviewHeader.ts","../src/paneview/paneviewComponent.ts","../src/splitview/splitviewPanel.ts","../src/api/entryPoints.ts"],"sourcesContent":["export var Event;\n(function (Event) {\n    Event.any = (...children) => {\n        return (listener) => {\n            const disposables = children.map((child) => child(listener));\n            return {\n                dispose: () => {\n                    disposables.forEach((d) => {\n                        d.dispose();\n                    });\n                },\n            };\n        };\n    };\n})(Event || (Event = {}));\nexport class DockviewEvent {\n    constructor() {\n        this._defaultPrevented = false;\n    }\n    get defaultPrevented() {\n        return this._defaultPrevented;\n    }\n    preventDefault() {\n        this._defaultPrevented = true;\n    }\n}\nexport class AcceptableEvent {\n    constructor() {\n        this._isAccepted = false;\n    }\n    get isAccepted() {\n        return this._isAccepted;\n    }\n    accept() {\n        this._isAccepted = true;\n    }\n}\nclass LeakageMonitor {\n    constructor() {\n        this.events = new Map();\n    }\n    get size() {\n        return this.events.size;\n    }\n    add(event, stacktrace) {\n        this.events.set(event, stacktrace);\n    }\n    delete(event) {\n        this.events.delete(event);\n    }\n    clear() {\n        this.events.clear();\n    }\n}\nclass Stacktrace {\n    static create() {\n        var _a;\n        return new Stacktrace((_a = new Error().stack) !== null && _a !== void 0 ? _a : '');\n    }\n    constructor(value) {\n        this.value = value;\n    }\n    print() {\n        console.warn('dockview: stacktrace', this.value);\n    }\n}\nclass Listener {\n    constructor(callback, stacktrace) {\n        this.callback = callback;\n        this.stacktrace = stacktrace;\n    }\n}\n// relatively simple event emitter taken from https://github.com/microsoft/vscode/blob/master/src/vs/base/common/event.ts\nexport class Emitter {\n    static setLeakageMonitorEnabled(isEnabled) {\n        if (isEnabled !== Emitter.ENABLE_TRACKING) {\n            Emitter.MEMORY_LEAK_WATCHER.clear();\n        }\n        Emitter.ENABLE_TRACKING = isEnabled;\n    }\n    get value() {\n        return this._last;\n    }\n    constructor(options) {\n        this.options = options;\n        this._listeners = [];\n        this._disposed = false;\n    }\n    get event() {\n        if (!this._event) {\n            this._event = (callback) => {\n                var _a;\n                if (((_a = this.options) === null || _a === void 0 ? void 0 : _a.replay) && this._last !== undefined) {\n                    callback(this._last);\n                }\n                const listener = new Listener(callback, Emitter.ENABLE_TRACKING ? Stacktrace.create() : undefined);\n                this._listeners.push(listener);\n                return {\n                    dispose: () => {\n                        const index = this._listeners.indexOf(listener);\n                        if (index > -1) {\n                            this._listeners.splice(index, 1);\n                        }\n                        else if (Emitter.ENABLE_TRACKING) {\n                            // console.warn(\n                            //     `dockview: listener already disposed`,\n                            //     Stacktrace.create().print()\n                            // );\n                        }\n                    },\n                };\n            };\n            if (Emitter.ENABLE_TRACKING) {\n                Emitter.MEMORY_LEAK_WATCHER.add(this._event, Stacktrace.create());\n            }\n        }\n        return this._event;\n    }\n    fire(e) {\n        var _a;\n        if ((_a = this.options) === null || _a === void 0 ? void 0 : _a.replay) {\n            this._last = e;\n        }\n        for (const listener of this._listeners) {\n            listener.callback(e);\n        }\n    }\n    dispose() {\n        if (!this._disposed) {\n            this._disposed = true;\n            if (this._listeners.length > 0) {\n                if (Emitter.ENABLE_TRACKING) {\n                    queueMicrotask(() => {\n                        var _a;\n                        // don't check until stack of execution is completed to allow for out-of-order disposals within the same execution block\n                        for (const listener of this._listeners) {\n                            console.warn('dockview: stacktrace', (_a = listener.stacktrace) === null || _a === void 0 ? void 0 : _a.print());\n                        }\n                    });\n                }\n                this._listeners = [];\n            }\n            if (Emitter.ENABLE_TRACKING && this._event) {\n                Emitter.MEMORY_LEAK_WATCHER.delete(this._event);\n            }\n        }\n    }\n}\nEmitter.ENABLE_TRACKING = false;\nEmitter.MEMORY_LEAK_WATCHER = new LeakageMonitor();\nexport function addDisposableListener(element, type, listener, options) {\n    element.addEventListener(type, listener, options);\n    return {\n        dispose: () => {\n            element.removeEventListener(type, listener, options);\n        },\n    };\n}\n/**\n *\n * Event Emitter that fires events from a Microtask callback, only one event will fire per event-loop cycle.\n *\n * It's kind of like using an `asapScheduler` in RxJs with additional logic to only fire once per event-loop cycle.\n * This implementation exists to avoid external dependencies.\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/API/queueMicrotask\n * @see https://rxjs.dev/api/index/const/asapScheduler\n */\nexport class AsapEvent {\n    constructor() {\n        this._onFired = new Emitter();\n        this._currentFireCount = 0;\n        this._queued = false;\n        this.onEvent = (e) => {\n            /**\n             * when the event is first subscribed to take note of the current fire count\n             */\n            const fireCountAtTimeOfEventSubscription = this._currentFireCount;\n            return this._onFired.event(() => {\n                /**\n                 * if the current fire count is greater than the fire count at event subscription\n                 * then the event has been fired since we subscribed and it's ok to \"on_next\" the event.\n                 *\n                 * if the count is not greater then what we are recieving is an event from the microtask\n                 * queue that was triggered before we actually subscribed and therfore we should ignore it.\n                 */\n                if (this._currentFireCount > fireCountAtTimeOfEventSubscription) {\n                    e();\n                }\n            });\n        };\n    }\n    fire() {\n        this._currentFireCount++;\n        if (this._queued) {\n            return;\n        }\n        this._queued = true;\n        queueMicrotask(() => {\n            this._queued = false;\n            this._onFired.fire();\n        });\n    }\n    dispose() {\n        this._onFired.dispose();\n    }\n}\n","export var Disposable;\n(function (Disposable) {\n    Disposable.NONE = {\n        dispose: () => {\n            // noop\n        },\n    };\n    function from(func) {\n        return {\n            dispose: () => {\n                func();\n            },\n        };\n    }\n    Disposable.from = from;\n})(Disposable || (Disposable = {}));\nexport class CompositeDisposable {\n    get isDisposed() {\n        return this._isDisposed;\n    }\n    constructor(...args) {\n        this._isDisposed = false;\n        this._disposables = args;\n    }\n    addDisposables(...args) {\n        args.forEach((arg) => this._disposables.push(arg));\n    }\n    dispose() {\n        if (this._isDisposed) {\n            return;\n        }\n        this._isDisposed = true;\n        this._disposables.forEach((arg) => arg.dispose());\n        this._disposables = [];\n    }\n}\nexport class MutableDisposable {\n    constructor() {\n        this._disposable = Disposable.NONE;\n    }\n    set value(disposable) {\n        if (this._disposable) {\n            this._disposable.dispose();\n        }\n        this._disposable = disposable;\n    }\n    dispose() {\n        if (this._disposable) {\n            this._disposable.dispose();\n            this._disposable = Disposable.NONE;\n        }\n    }\n}\n","function styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nexport default styleInject;\n","class TransferObject {\n}\nexport class PanelTransfer extends TransferObject {\n    constructor(viewId, groupId, panelId) {\n        super();\n        this.viewId = viewId;\n        this.groupId = groupId;\n        this.panelId = panelId;\n    }\n}\nexport class PaneTransfer extends TransferObject {\n    constructor(viewId, paneId) {\n        super();\n        this.viewId = viewId;\n        this.paneId = paneId;\n    }\n}\n/**\n * A singleton to store transfer data during drag & drop operations that are only valid within the application.\n */\nexport class LocalSelectionTransfer {\n    constructor() {\n        // protect against external instantiation\n    }\n    static getInstance() {\n        return LocalSelectionTransfer.INSTANCE;\n    }\n    hasData(proto) {\n        return proto && proto === this.proto;\n    }\n    clearData(proto) {\n        if (this.hasData(proto)) {\n            this.proto = undefined;\n            this.data = undefined;\n        }\n    }\n    getData(proto) {\n        if (this.hasData(proto)) {\n            return this.data;\n        }\n        return undefined;\n    }\n    setData(data, proto) {\n        if (proto) {\n            this.data = data;\n            this.proto = proto;\n        }\n    }\n}\nLocalSelectionTransfer.INSTANCE = new LocalSelectionTransfer();\nexport function getPanelData() {\n    const panelTransfer = LocalSelectionTransfer.getInstance();\n    const isPanelEvent = panelTransfer.hasData(PanelTransfer.prototype);\n    if (!isPanelEvent) {\n        return undefined;\n    }\n    return panelTransfer.getData(PanelTransfer.prototype)[0];\n}\nexport function getPaneData() {\n    const paneTransfer = LocalSelectionTransfer.getInstance();\n    const isPanelEvent = paneTransfer.hasData(PaneTransfer.prototype);\n    if (!isPanelEvent) {\n        return undefined;\n    }\n    return paneTransfer.getData(PaneTransfer.prototype)[0];\n}\n","import { Emitter, addDisposableListener, } from './events';\nimport { CompositeDisposable } from './lifecycle';\nexport class OverflowObserver extends CompositeDisposable {\n    constructor(el) {\n        super();\n        this._onDidChange = new Emitter();\n        this.onDidChange = this._onDidChange.event;\n        this._value = null;\n        this.addDisposables(this._onDidChange, watchElementResize(el, (entry) => {\n            const hasScrollX = entry.target.scrollWidth > entry.target.clientWidth;\n            const hasScrollY = entry.target.scrollHeight > entry.target.clientHeight;\n            this._value = { hasScrollX, hasScrollY };\n            this._onDidChange.fire(this._value);\n        }));\n    }\n}\nexport function watchElementResize(element, cb) {\n    const observer = new ResizeObserver((entires) => {\n        /**\n         * Fast browser window resize produces Error: ResizeObserver loop limit exceeded.\n         * The error isn't visible in browser console, doesn't affect functionality, but degrades performance.\n         * See https://stackoverflow.com/questions/49384120/resizeobserver-loop-limit-exceeded/58701523#58701523\n         */\n        requestAnimationFrame(() => {\n            const firstEntry = entires[0];\n            cb(firstEntry);\n        });\n    });\n    observer.observe(element);\n    return {\n        dispose: () => {\n            observer.unobserve(element);\n            observer.disconnect();\n        },\n    };\n}\nexport const removeClasses = (element, ...classes) => {\n    for (const classname of classes) {\n        if (element.classList.contains(classname)) {\n            element.classList.remove(classname);\n        }\n    }\n};\nexport const addClasses = (element, ...classes) => {\n    for (const classname of classes) {\n        if (!element.classList.contains(classname)) {\n            element.classList.add(classname);\n        }\n    }\n};\nexport const toggleClass = (element, className, isToggled) => {\n    const hasClass = element.classList.contains(className);\n    if (isToggled && !hasClass) {\n        element.classList.add(className);\n    }\n    if (!isToggled && hasClass) {\n        element.classList.remove(className);\n    }\n};\nexport function isAncestor(testChild, testAncestor) {\n    while (testChild) {\n        if (testChild === testAncestor) {\n            return true;\n        }\n        testChild = testChild.parentNode;\n    }\n    return false;\n}\nexport function getElementsByTagName(tag, document) {\n    return Array.prototype.slice.call(document.querySelectorAll(tag), 0);\n}\nexport function trackFocus(element) {\n    return new FocusTracker(element);\n}\n/**\n * Track focus on an element. Ensure tabIndex is set when an HTMLElement is not focusable by default\n */\nclass FocusTracker extends CompositeDisposable {\n    constructor(element) {\n        super();\n        this._onDidFocus = new Emitter();\n        this.onDidFocus = this._onDidFocus.event;\n        this._onDidBlur = new Emitter();\n        this.onDidBlur = this._onDidBlur.event;\n        this.addDisposables(this._onDidFocus, this._onDidBlur);\n        let hasFocus = isAncestor(document.activeElement, element);\n        let loosingFocus = false;\n        const onFocus = () => {\n            loosingFocus = false;\n            if (!hasFocus) {\n                hasFocus = true;\n                this._onDidFocus.fire();\n            }\n        };\n        const onBlur = () => {\n            if (hasFocus) {\n                loosingFocus = true;\n                window.setTimeout(() => {\n                    if (loosingFocus) {\n                        loosingFocus = false;\n                        hasFocus = false;\n                        this._onDidBlur.fire();\n                    }\n                }, 0);\n            }\n        };\n        this._refreshStateHandler = () => {\n            const currentNodeHasFocus = isAncestor(document.activeElement, element);\n            if (currentNodeHasFocus !== hasFocus) {\n                if (hasFocus) {\n                    onBlur();\n                }\n                else {\n                    onFocus();\n                }\n            }\n        };\n        this.addDisposables(addDisposableListener(element, 'focus', onFocus, true));\n        this.addDisposables(addDisposableListener(element, 'blur', onBlur, true));\n    }\n    refreshState() {\n        this._refreshStateHandler();\n    }\n}\n// quasi: apparently, but not really; seemingly\nconst QUASI_PREVENT_DEFAULT_KEY = 'dv-quasiPreventDefault';\n// mark an event directly for other listeners to check\nexport function quasiPreventDefault(event) {\n    event[QUASI_PREVENT_DEFAULT_KEY] = true;\n}\n// check if this event has been marked\nexport function quasiDefaultPrevented(event) {\n    return event[QUASI_PREVENT_DEFAULT_KEY];\n}\nexport function addStyles(document, styleSheetList) {\n    const styleSheets = Array.from(styleSheetList);\n    for (const styleSheet of styleSheets) {\n        if (styleSheet.href) {\n            const link = document.createElement('link');\n            link.href = styleSheet.href;\n            link.type = styleSheet.type;\n            link.rel = 'stylesheet';\n            document.head.appendChild(link);\n        }\n        let cssTexts = [];\n        try {\n            if (styleSheet.cssRules) {\n                cssTexts = Array.from(styleSheet.cssRules).map((rule) => rule.cssText);\n            }\n        }\n        catch (err) {\n            // security errors (lack of permissions), ignore\n        }\n        for (const rule of cssTexts) {\n            const style = document.createElement('style');\n            style.appendChild(document.createTextNode(rule));\n            document.head.appendChild(style);\n        }\n    }\n}\nexport function getDomNodePagePosition(domNode) {\n    const { left, top, width, height } = domNode.getBoundingClientRect();\n    return {\n        left: left + window.scrollX,\n        top: top + window.scrollY,\n        width: width,\n        height: height,\n    };\n}\n/**\n * Check whether an element is in the DOM (including the Shadow DOM)\n * @see https://terodox.tech/how-to-tell-if-an-element-is-in-the-dom-including-the-shadow-dom/\n */\nexport function isInDocument(element) {\n    let currentElement = element;\n    while (currentElement === null || currentElement === void 0 ? void 0 : currentElement.parentNode) {\n        if (currentElement.parentNode === document) {\n            return true;\n        }\n        else if (currentElement.parentNode instanceof DocumentFragment) {\n            // handle shadow DOMs\n            currentElement = currentElement.parentNode.host;\n        }\n        else {\n            currentElement = currentElement.parentNode;\n        }\n    }\n    return false;\n}\nexport function addTestId(element, id) {\n    element.setAttribute('data-testid', id);\n}\n/**\n * Should be more efficient than element.querySelectorAll(\"*\") since there\n * is no need to store every element in-memory using this approach\n */\nfunction allTagsNamesInclusiveOfShadowDoms(tagNames) {\n    const iframes = [];\n    function findIframesInNode(node) {\n        if (node.nodeType === Node.ELEMENT_NODE) {\n            if (tagNames.includes(node.tagName)) {\n                iframes.push(node);\n            }\n            if (node.shadowRoot) {\n                findIframesInNode(node.shadowRoot);\n            }\n            for (const child of node.children) {\n                findIframesInNode(child);\n            }\n        }\n    }\n    findIframesInNode(document.documentElement);\n    return iframes;\n}\nexport function disableIframePointEvents(rootNode = document) {\n    const iframes = allTagsNamesInclusiveOfShadowDoms(['IFRAME', 'WEBVIEW']);\n    const original = new WeakMap(); // don't hold onto HTMLElement references longer than required\n    for (const iframe of iframes) {\n        original.set(iframe, iframe.style.pointerEvents);\n        iframe.style.pointerEvents = 'none';\n    }\n    return {\n        release: () => {\n            var _a;\n            for (const iframe of iframes) {\n                iframe.style.pointerEvents = (_a = original.get(iframe)) !== null && _a !== void 0 ? _a : 'auto';\n            }\n            iframes.splice(0, iframes.length); // don't hold onto HTMLElement references longer than required\n        },\n    };\n}\nexport function getDockviewTheme(element) {\n    function toClassList(element) {\n        const list = [];\n        for (let i = 0; i < element.classList.length; i++) {\n            list.push(element.classList.item(i));\n        }\n        return list;\n    }\n    let theme = undefined;\n    let parent = element;\n    while (parent !== null) {\n        theme = toClassList(parent).find((cls) => cls.startsWith('dockview-theme-'));\n        if (typeof theme === 'string') {\n            break;\n        }\n        parent = parent.parentElement;\n    }\n    return theme;\n}\nexport class Classnames {\n    constructor(element) {\n        this.element = element;\n        this._classNames = [];\n    }\n    setClassNames(classNames) {\n        for (const className of this._classNames) {\n            toggleClass(this.element, className, false);\n        }\n        this._classNames = classNames\n            .split(' ')\n            .filter((v) => v.trim().length > 0);\n        for (const className of this._classNames) {\n            toggleClass(this.element, className, true);\n        }\n    }\n}\nconst DEBOUCE_DELAY = 100;\nexport function isChildEntirelyVisibleWithinParent(child, parent) {\n    //\n    const childPosition = getDomNodePagePosition(child);\n    const parentPosition = getDomNodePagePosition(parent);\n    if (childPosition.left < parentPosition.left) {\n        return false;\n    }\n    if (childPosition.left + childPosition.width >\n        parentPosition.left + parentPosition.width) {\n        return false;\n    }\n    return true;\n}\nexport function onDidWindowMoveEnd(window) {\n    const emitter = new Emitter();\n    let previousScreenX = window.screenX;\n    let previousScreenY = window.screenY;\n    let timeout;\n    const checkMovement = () => {\n        if (window.closed) {\n            return;\n        }\n        const currentScreenX = window.screenX;\n        const currentScreenY = window.screenY;\n        if (currentScreenX !== previousScreenX ||\n            currentScreenY !== previousScreenY) {\n            clearTimeout(timeout);\n            timeout = setTimeout(() => {\n                emitter.fire();\n            }, DEBOUCE_DELAY);\n            previousScreenX = currentScreenX;\n            previousScreenY = currentScreenY;\n        }\n        requestAnimationFrame(checkMovement);\n    };\n    checkMovement();\n    return emitter;\n}\nexport function onDidWindowResizeEnd(element, cb) {\n    let resizeTimeout;\n    const disposable = new CompositeDisposable(addDisposableListener(element, 'resize', () => {\n        clearTimeout(resizeTimeout);\n        resizeTimeout = setTimeout(() => {\n            cb();\n        }, DEBOUCE_DELAY);\n    }));\n    return disposable;\n}\nexport function shiftAbsoluteElementIntoView(element, root, options = { buffer: 10 }) {\n    const buffer = options.buffer;\n    const rect = element.getBoundingClientRect();\n    const rootRect = root.getBoundingClientRect();\n    let translateX = 0;\n    let translateY = 0;\n    const left = rect.left - rootRect.left;\n    const top = rect.top - rootRect.top;\n    const bottom = rect.bottom - rootRect.bottom;\n    const right = rect.right - rootRect.right;\n    // Check horizontal overflow\n    if (left < buffer) {\n        translateX = buffer - left;\n    }\n    else if (right > buffer) {\n        translateX = -buffer - right;\n    }\n    // Check vertical overflow\n    if (top < buffer) {\n        translateY = buffer - top;\n    }\n    else if (bottom > buffer) {\n        translateY = -bottom - buffer;\n    }\n    // Apply the translation if needed\n    if (translateX !== 0 || translateY !== 0) {\n        element.style.transform = `translate(${translateX}px, ${translateY}px)`;\n    }\n}\nexport function findRelativeZIndexParent(el) {\n    let tmp = el;\n    while (tmp && (tmp.style.zIndex === 'auto' || tmp.style.zIndex === '')) {\n        tmp = tmp.parentElement;\n    }\n    return tmp;\n}\n","export function tail(arr) {\n    if (arr.length === 0) {\n        throw new Error('Invalid tail call');\n    }\n    return [arr.slice(0, arr.length - 1), arr[arr.length - 1]];\n}\nexport function last(arr) {\n    return arr.length > 0 ? arr[arr.length - 1] : undefined;\n}\nexport function sequenceEquals(arr1, arr2) {\n    if (arr1.length !== arr2.length) {\n        return false;\n    }\n    for (let i = 0; i < arr1.length; i++) {\n        if (arr1[i] !== arr2[i]) {\n            return false;\n        }\n    }\n    return true;\n}\n/**\n * Pushes an element to the start of the array, if found.\n */\nexport function pushToStart(arr, value) {\n    const index = arr.indexOf(value);\n    if (index > -1) {\n        arr.splice(index, 1);\n        arr.unshift(value);\n    }\n}\n/**\n * Pushes an element to the end of the array, if found.\n */\nexport function pushToEnd(arr, value) {\n    const index = arr.indexOf(value);\n    if (index > -1) {\n        arr.splice(index, 1);\n        arr.push(value);\n    }\n}\nexport function firstIndex(array, fn) {\n    for (let i = 0; i < array.length; i++) {\n        const element = array[i];\n        if (fn(element)) {\n            return i;\n        }\n    }\n    return -1;\n}\nexport function remove(array, value) {\n    const index = array.findIndex((t) => t === value);\n    if (index > -1) {\n        array.splice(index, 1);\n        return true;\n    }\n    return false;\n}\n","export const clamp = (value, min, max) => {\n    if (min > max) {\n        /**\n         * caveat: an error should be thrown here if this was a proper `clamp` function but we need to handle\n         * cases where `min` > `max` and in those cases return `min`.\n         */\n        return min;\n    }\n    return Math.min(max, Math.max(value, min));\n};\nexport const sequentialNumberGenerator = () => {\n    let value = 1;\n    return { next: () => (value++).toString() };\n};\nexport const range = (from, to) => {\n    const result = [];\n    if (typeof to !== 'number') {\n        to = from;\n        from = 0;\n    }\n    if (from <= to) {\n        for (let i = from; i < to; i++) {\n            result.push(i);\n        }\n    }\n    else {\n        for (let i = from; i > to; i--) {\n            result.push(i);\n        }\n    }\n    return result;\n};\n","import { clamp } from '../math';\nexport class ViewItem {\n    set size(size) {\n        this._size = size;\n    }\n    get size() {\n        return this._size;\n    }\n    get cachedVisibleSize() {\n        return this._cachedVisibleSize;\n    }\n    get visible() {\n        return typeof this._cachedVisibleSize === 'undefined';\n    }\n    get minimumSize() {\n        return this.visible ? this.view.minimumSize : 0;\n    }\n    get viewMinimumSize() {\n        return this.view.minimumSize;\n    }\n    get maximumSize() {\n        return this.visible ? this.view.maximumSize : 0;\n    }\n    get viewMaximumSize() {\n        return this.view.maximumSize;\n    }\n    get priority() {\n        return this.view.priority;\n    }\n    get snap() {\n        return !!this.view.snap;\n    }\n    set enabled(enabled) {\n        this.container.style.pointerEvents = enabled ? '' : 'none';\n    }\n    constructor(container, view, size, disposable) {\n        this.container = container;\n        this.view = view;\n        this.disposable = disposable;\n        this._cachedVisibleSize = undefined;\n        if (typeof size === 'number') {\n            this._size = size;\n            this._cachedVisibleSize = undefined;\n            container.classList.add('visible');\n        }\n        else {\n            this._size = 0;\n            this._cachedVisibleSize = size.cachedVisibleSize;\n        }\n    }\n    setVisible(visible, size) {\n        var _a;\n        if (visible === this.visible) {\n            return;\n        }\n        if (visible) {\n            this.size = clamp((_a = this._cachedVisibleSize) !== null && _a !== void 0 ? _a : 0, this.viewMinimumSize, this.viewMaximumSize);\n            this._cachedVisibleSize = undefined;\n        }\n        else {\n            this._cachedVisibleSize =\n                typeof size === 'number' ? size : this.size;\n            this.size = 0;\n        }\n        this.container.classList.toggle('visible', visible);\n        if (this.view.setVisible) {\n            this.view.setVisible(visible);\n        }\n    }\n    dispose() {\n        this.disposable.dispose();\n        return this.view;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n * Accreditation: This file is largly based upon the MIT licenced VSCode sourcecode found at:\n * https://github.com/microsoft/vscode/tree/main/src/vs/base/browser/ui/splitview\n *--------------------------------------------------------------------------------------------*/\nimport { removeClasses, addClasses, toggleClass, disableIframePointEvents, } from '../dom';\nimport { Emitter } from '../events';\nimport { pushToStart, pushToEnd, firstIndex } from '../array';\nimport { range, clamp } from '../math';\nimport { ViewItem } from './viewItem';\nexport var Orientation;\n(function (Orientation) {\n    Orientation[\"HORIZONTAL\"] = \"HORIZONTAL\";\n    Orientation[\"VERTICAL\"] = \"VERTICAL\";\n})(Orientation || (Orientation = {}));\nexport var SashState;\n(function (SashState) {\n    SashState[SashState[\"MAXIMUM\"] = 0] = \"MAXIMUM\";\n    SashState[SashState[\"MINIMUM\"] = 1] = \"MINIMUM\";\n    SashState[SashState[\"DISABLED\"] = 2] = \"DISABLED\";\n    SashState[SashState[\"ENABLED\"] = 3] = \"ENABLED\";\n})(SashState || (SashState = {}));\nexport var LayoutPriority;\n(function (LayoutPriority) {\n    LayoutPriority[\"Low\"] = \"low\";\n    LayoutPriority[\"High\"] = \"high\";\n    LayoutPriority[\"Normal\"] = \"normal\";\n})(LayoutPriority || (LayoutPriority = {}));\nexport var Sizing;\n(function (Sizing) {\n    Sizing.Distribute = { type: 'distribute' };\n    function Split(index) {\n        return { type: 'split', index };\n    }\n    Sizing.Split = Split;\n    function Invisible(cachedVisibleSize) {\n        return { type: 'invisible', cachedVisibleSize };\n    }\n    Sizing.Invisible = Invisible;\n})(Sizing || (Sizing = {}));\nexport class Splitview {\n    get contentSize() {\n        return this._contentSize;\n    }\n    get size() {\n        return this._size;\n    }\n    set size(value) {\n        this._size = value;\n    }\n    get orthogonalSize() {\n        return this._orthogonalSize;\n    }\n    set orthogonalSize(value) {\n        this._orthogonalSize = value;\n    }\n    get length() {\n        return this.viewItems.length;\n    }\n    get proportions() {\n        return this._proportions ? [...this._proportions] : undefined;\n    }\n    get orientation() {\n        return this._orientation;\n    }\n    set orientation(value) {\n        this._orientation = value;\n        const tmp = this.size;\n        this.size = this.orthogonalSize;\n        this.orthogonalSize = tmp;\n        removeClasses(this.element, 'dv-horizontal', 'dv-vertical');\n        this.element.classList.add(this.orientation == Orientation.HORIZONTAL\n            ? 'dv-horizontal'\n            : 'dv-vertical');\n    }\n    get minimumSize() {\n        return this.viewItems.reduce((r, item) => r + item.minimumSize, 0);\n    }\n    get maximumSize() {\n        return this.length === 0\n            ? Number.POSITIVE_INFINITY\n            : this.viewItems.reduce((r, item) => r + item.maximumSize, 0);\n    }\n    get startSnappingEnabled() {\n        return this._startSnappingEnabled;\n    }\n    set startSnappingEnabled(startSnappingEnabled) {\n        if (this._startSnappingEnabled === startSnappingEnabled) {\n            return;\n        }\n        this._startSnappingEnabled = startSnappingEnabled;\n        this.updateSashEnablement();\n    }\n    get endSnappingEnabled() {\n        return this._endSnappingEnabled;\n    }\n    set endSnappingEnabled(endSnappingEnabled) {\n        if (this._endSnappingEnabled === endSnappingEnabled) {\n            return;\n        }\n        this._endSnappingEnabled = endSnappingEnabled;\n        this.updateSashEnablement();\n    }\n    get disabled() {\n        return this._disabled;\n    }\n    set disabled(value) {\n        this._disabled = value;\n        toggleClass(this.element, 'dv-splitview-disabled', value);\n    }\n    get margin() {\n        return this._margin;\n    }\n    set margin(value) {\n        this._margin = value;\n        toggleClass(this.element, 'dv-splitview-has-margin', value !== 0);\n    }\n    constructor(container, options) {\n        var _a, _b;\n        this.container = container;\n        this.viewItems = [];\n        this.sashes = [];\n        this._size = 0;\n        this._orthogonalSize = 0;\n        this._contentSize = 0;\n        this._proportions = undefined;\n        this._startSnappingEnabled = true;\n        this._endSnappingEnabled = true;\n        this._disabled = false;\n        this._margin = 0;\n        this._onDidSashEnd = new Emitter();\n        this.onDidSashEnd = this._onDidSashEnd.event;\n        this._onDidAddView = new Emitter();\n        this.onDidAddView = this._onDidAddView.event;\n        this._onDidRemoveView = new Emitter();\n        this.onDidRemoveView = this._onDidRemoveView.event;\n        this.resize = (index, delta, sizes = this.viewItems.map((x) => x.size), lowPriorityIndexes, highPriorityIndexes, overloadMinDelta = Number.NEGATIVE_INFINITY, overloadMaxDelta = Number.POSITIVE_INFINITY, snapBefore, snapAfter) => {\n            if (index < 0 || index > this.viewItems.length) {\n                return 0;\n            }\n            const upIndexes = range(index, -1);\n            const downIndexes = range(index + 1, this.viewItems.length);\n            //\n            if (highPriorityIndexes) {\n                for (const i of highPriorityIndexes) {\n                    pushToStart(upIndexes, i);\n                    pushToStart(downIndexes, i);\n                }\n            }\n            if (lowPriorityIndexes) {\n                for (const i of lowPriorityIndexes) {\n                    pushToEnd(upIndexes, i);\n                    pushToEnd(downIndexes, i);\n                }\n            }\n            //\n            const upItems = upIndexes.map((i) => this.viewItems[i]);\n            const upSizes = upIndexes.map((i) => sizes[i]);\n            //\n            const downItems = downIndexes.map((i) => this.viewItems[i]);\n            const downSizes = downIndexes.map((i) => sizes[i]);\n            //\n            const minDeltaUp = upIndexes.reduce((_, i) => _ + this.viewItems[i].minimumSize - sizes[i], 0);\n            const maxDeltaUp = upIndexes.reduce((_, i) => _ + this.viewItems[i].maximumSize - sizes[i], 0);\n            //\n            const maxDeltaDown = downIndexes.length === 0\n                ? Number.POSITIVE_INFINITY\n                : downIndexes.reduce((_, i) => _ + sizes[i] - this.viewItems[i].minimumSize, 0);\n            const minDeltaDown = downIndexes.length === 0\n                ? Number.NEGATIVE_INFINITY\n                : downIndexes.reduce((_, i) => _ + sizes[i] - this.viewItems[i].maximumSize, 0);\n            //\n            const minDelta = Math.max(minDeltaUp, minDeltaDown);\n            const maxDelta = Math.min(maxDeltaDown, maxDeltaUp);\n            //\n            let snapped = false;\n            if (snapBefore) {\n                const snapView = this.viewItems[snapBefore.index];\n                const visible = delta >= snapBefore.limitDelta;\n                snapped = visible !== snapView.visible;\n                snapView.setVisible(visible, snapBefore.size);\n            }\n            if (!snapped && snapAfter) {\n                const snapView = this.viewItems[snapAfter.index];\n                const visible = delta < snapAfter.limitDelta;\n                snapped = visible !== snapView.visible;\n                snapView.setVisible(visible, snapAfter.size);\n            }\n            if (snapped) {\n                return this.resize(index, delta, sizes, lowPriorityIndexes, highPriorityIndexes, overloadMinDelta, overloadMaxDelta);\n            }\n            //\n            const tentativeDelta = clamp(delta, minDelta, maxDelta);\n            let actualDelta = 0;\n            //\n            let deltaUp = tentativeDelta;\n            for (let i = 0; i < upItems.length; i++) {\n                const item = upItems[i];\n                const size = clamp(upSizes[i] + deltaUp, item.minimumSize, item.maximumSize);\n                const viewDelta = size - upSizes[i];\n                actualDelta += viewDelta;\n                deltaUp -= viewDelta;\n                item.size = size;\n            }\n            //\n            let deltaDown = actualDelta;\n            for (let i = 0; i < downItems.length; i++) {\n                const item = downItems[i];\n                const size = clamp(downSizes[i] - deltaDown, item.minimumSize, item.maximumSize);\n                const viewDelta = size - downSizes[i];\n                deltaDown += viewDelta;\n                item.size = size;\n            }\n            //\n            return delta;\n        };\n        this._orientation = (_a = options.orientation) !== null && _a !== void 0 ? _a : Orientation.VERTICAL;\n        this.element = this.createContainer();\n        this.margin = (_b = options.margin) !== null && _b !== void 0 ? _b : 0;\n        this.proportionalLayout =\n            options.proportionalLayout === undefined\n                ? true\n                : !!options.proportionalLayout;\n        this.viewContainer = this.createViewContainer();\n        this.sashContainer = this.createSashContainer();\n        this.element.appendChild(this.sashContainer);\n        this.element.appendChild(this.viewContainer);\n        this.container.appendChild(this.element);\n        this.style(options.styles);\n        // We have an existing set of view, add them now\n        if (options.descriptor) {\n            this._size = options.descriptor.size;\n            options.descriptor.views.forEach((viewDescriptor, index) => {\n                const sizing = viewDescriptor.visible === undefined ||\n                    viewDescriptor.visible\n                    ? viewDescriptor.size\n                    : {\n                        type: 'invisible',\n                        cachedVisibleSize: viewDescriptor.size,\n                    };\n                const view = viewDescriptor.view;\n                this.addView(view, sizing, index, true\n                // true skip layout\n                );\n            });\n            // Initialize content size and proportions for first layout\n            this._contentSize = this.viewItems.reduce((r, i) => r + i.size, 0);\n            this.saveProportions();\n        }\n    }\n    style(styles) {\n        if ((styles === null || styles === void 0 ? void 0 : styles.separatorBorder) === 'transparent') {\n            removeClasses(this.element, 'dv-separator-border');\n            this.element.style.removeProperty('--dv-separator-border');\n        }\n        else {\n            addClasses(this.element, 'dv-separator-border');\n            if (styles === null || styles === void 0 ? void 0 : styles.separatorBorder) {\n                this.element.style.setProperty('--dv-separator-border', styles.separatorBorder);\n            }\n        }\n    }\n    isViewVisible(index) {\n        if (index < 0 || index >= this.viewItems.length) {\n            throw new Error('Index out of bounds');\n        }\n        const viewItem = this.viewItems[index];\n        return viewItem.visible;\n    }\n    setViewVisible(index, visible) {\n        if (index < 0 || index >= this.viewItems.length) {\n            throw new Error('Index out of bounds');\n        }\n        const viewItem = this.viewItems[index];\n        viewItem.setVisible(visible, viewItem.size);\n        this.distributeEmptySpace(index);\n        this.layoutViews();\n        this.saveProportions();\n    }\n    getViewSize(index) {\n        if (index < 0 || index >= this.viewItems.length) {\n            return -1;\n        }\n        return this.viewItems[index].size;\n    }\n    resizeView(index, size) {\n        if (index < 0 || index >= this.viewItems.length) {\n            return;\n        }\n        const indexes = range(this.viewItems.length).filter((i) => i !== index);\n        const lowPriorityIndexes = [\n            ...indexes.filter((i) => this.viewItems[i].priority === LayoutPriority.Low),\n            index,\n        ];\n        const highPriorityIndexes = indexes.filter((i) => this.viewItems[i].priority === LayoutPriority.High);\n        const item = this.viewItems[index];\n        size = Math.round(size);\n        size = clamp(size, item.minimumSize, Math.min(item.maximumSize, this._size));\n        item.size = size;\n        this.relayout(lowPriorityIndexes, highPriorityIndexes);\n    }\n    getViews() {\n        return this.viewItems.map((x) => x.view);\n    }\n    onDidChange(item, size) {\n        const index = this.viewItems.indexOf(item);\n        if (index < 0 || index >= this.viewItems.length) {\n            return;\n        }\n        size = typeof size === 'number' ? size : item.size;\n        size = clamp(size, item.minimumSize, item.maximumSize);\n        item.size = size;\n        const indexes = range(this.viewItems.length).filter((i) => i !== index);\n        const lowPriorityIndexes = [\n            ...indexes.filter((i) => this.viewItems[i].priority === LayoutPriority.Low),\n            index,\n        ];\n        const highPriorityIndexes = indexes.filter((i) => this.viewItems[i].priority === LayoutPriority.High);\n        /**\n         * add this view we are changing to the low-index list since we have determined the size\n         * here and don't want it changed\n         */\n        this.relayout([...lowPriorityIndexes, index], highPriorityIndexes);\n    }\n    addView(view, size = { type: 'distribute' }, index = this.viewItems.length, skipLayout) {\n        const container = document.createElement('div');\n        container.className = 'dv-view';\n        container.appendChild(view.element);\n        let viewSize;\n        if (typeof size === 'number') {\n            viewSize = size;\n        }\n        else if (size.type === 'split') {\n            viewSize = this.getViewSize(size.index) / 2;\n        }\n        else if (size.type === 'invisible') {\n            viewSize = { cachedVisibleSize: size.cachedVisibleSize };\n        }\n        else {\n            viewSize = view.minimumSize;\n        }\n        const disposable = view.onDidChange((newSize) => this.onDidChange(viewItem, newSize.size));\n        const viewItem = new ViewItem(container, view, viewSize, {\n            dispose: () => {\n                disposable.dispose();\n                this.viewContainer.removeChild(container);\n            },\n        });\n        if (index === this.viewItems.length) {\n            this.viewContainer.appendChild(container);\n        }\n        else {\n            this.viewContainer.insertBefore(container, this.viewContainer.children.item(index));\n        }\n        this.viewItems.splice(index, 0, viewItem);\n        if (this.viewItems.length > 1) {\n            //add sash\n            const sash = document.createElement('div');\n            sash.className = 'dv-sash';\n            const onPointerStart = (event) => {\n                for (const item of this.viewItems) {\n                    item.enabled = false;\n                }\n                const iframes = disableIframePointEvents();\n                const start = this._orientation === Orientation.HORIZONTAL\n                    ? event.clientX\n                    : event.clientY;\n                const sashIndex = firstIndex(this.sashes, (s) => s.container === sash);\n                //\n                const sizes = this.viewItems.map((x) => x.size);\n                //\n                let snapBefore;\n                let snapAfter;\n                const upIndexes = range(sashIndex, -1);\n                const downIndexes = range(sashIndex + 1, this.viewItems.length);\n                const minDeltaUp = upIndexes.reduce((r, i) => r + (this.viewItems[i].minimumSize - sizes[i]), 0);\n                const maxDeltaUp = upIndexes.reduce((r, i) => r + (this.viewItems[i].viewMaximumSize - sizes[i]), 0);\n                const maxDeltaDown = downIndexes.length === 0\n                    ? Number.POSITIVE_INFINITY\n                    : downIndexes.reduce((r, i) => r +\n                        (sizes[i] - this.viewItems[i].minimumSize), 0);\n                const minDeltaDown = downIndexes.length === 0\n                    ? Number.NEGATIVE_INFINITY\n                    : downIndexes.reduce((r, i) => r +\n                        (sizes[i] -\n                            this.viewItems[i].viewMaximumSize), 0);\n                const minDelta = Math.max(minDeltaUp, minDeltaDown);\n                const maxDelta = Math.min(maxDeltaDown, maxDeltaUp);\n                const snapBeforeIndex = this.findFirstSnapIndex(upIndexes);\n                const snapAfterIndex = this.findFirstSnapIndex(downIndexes);\n                if (typeof snapBeforeIndex === 'number') {\n                    const snappedViewItem = this.viewItems[snapBeforeIndex];\n                    const halfSize = Math.floor(snappedViewItem.viewMinimumSize / 2);\n                    snapBefore = {\n                        index: snapBeforeIndex,\n                        limitDelta: snappedViewItem.visible\n                            ? minDelta - halfSize\n                            : minDelta + halfSize,\n                        size: snappedViewItem.size,\n                    };\n                }\n                if (typeof snapAfterIndex === 'number') {\n                    const snappedViewItem = this.viewItems[snapAfterIndex];\n                    const halfSize = Math.floor(snappedViewItem.viewMinimumSize / 2);\n                    snapAfter = {\n                        index: snapAfterIndex,\n                        limitDelta: snappedViewItem.visible\n                            ? maxDelta + halfSize\n                            : maxDelta - halfSize,\n                        size: snappedViewItem.size,\n                    };\n                }\n                const onPointerMove = (event) => {\n                    const current = this._orientation === Orientation.HORIZONTAL\n                        ? event.clientX\n                        : event.clientY;\n                    const delta = current - start;\n                    this.resize(sashIndex, delta, sizes, undefined, undefined, minDelta, maxDelta, snapBefore, snapAfter);\n                    this.distributeEmptySpace();\n                    this.layoutViews();\n                };\n                const end = () => {\n                    for (const item of this.viewItems) {\n                        item.enabled = true;\n                    }\n                    iframes.release();\n                    this.saveProportions();\n                    document.removeEventListener('pointermove', onPointerMove);\n                    document.removeEventListener('pointerup', end);\n                    document.removeEventListener('pointercancel', end);\n                    this._onDidSashEnd.fire(undefined);\n                };\n                document.addEventListener('pointermove', onPointerMove);\n                document.addEventListener('pointerup', end);\n                document.addEventListener('pointercancel', end);\n            };\n            sash.addEventListener('pointerdown', onPointerStart);\n            const sashItem = {\n                container: sash,\n                disposable: () => {\n                    sash.removeEventListener('pointerdown', onPointerStart);\n                    this.sashContainer.removeChild(sash);\n                },\n            };\n            this.sashContainer.appendChild(sash);\n            this.sashes.push(sashItem);\n        }\n        if (!skipLayout) {\n            this.relayout([index]);\n        }\n        if (!skipLayout &&\n            typeof size !== 'number' &&\n            size.type === 'distribute') {\n            this.distributeViewSizes();\n        }\n        this._onDidAddView.fire(view);\n    }\n    distributeViewSizes() {\n        const flexibleViewItems = [];\n        let flexibleSize = 0;\n        for (const item of this.viewItems) {\n            if (item.maximumSize - item.minimumSize > 0) {\n                flexibleViewItems.push(item);\n                flexibleSize += item.size;\n            }\n        }\n        const size = Math.floor(flexibleSize / flexibleViewItems.length);\n        for (const item of flexibleViewItems) {\n            item.size = clamp(size, item.minimumSize, item.maximumSize);\n        }\n        const indexes = range(this.viewItems.length);\n        const lowPriorityIndexes = indexes.filter((i) => this.viewItems[i].priority === LayoutPriority.Low);\n        const highPriorityIndexes = indexes.filter((i) => this.viewItems[i].priority === LayoutPriority.High);\n        this.relayout(lowPriorityIndexes, highPriorityIndexes);\n    }\n    removeView(index, sizing, skipLayout = false) {\n        // Remove view\n        const viewItem = this.viewItems.splice(index, 1)[0];\n        viewItem.dispose();\n        // Remove sash\n        if (this.viewItems.length >= 1) {\n            const sashIndex = Math.max(index - 1, 0);\n            const sashItem = this.sashes.splice(sashIndex, 1)[0];\n            sashItem.disposable();\n        }\n        if (!skipLayout) {\n            this.relayout();\n        }\n        if (sizing && sizing.type === 'distribute') {\n            this.distributeViewSizes();\n        }\n        this._onDidRemoveView.fire(viewItem.view);\n        return viewItem.view;\n    }\n    getViewCachedVisibleSize(index) {\n        if (index < 0 || index >= this.viewItems.length) {\n            throw new Error('Index out of bounds');\n        }\n        const viewItem = this.viewItems[index];\n        return viewItem.cachedVisibleSize;\n    }\n    moveView(from, to) {\n        const cachedVisibleSize = this.getViewCachedVisibleSize(from);\n        const sizing = typeof cachedVisibleSize === 'undefined'\n            ? this.getViewSize(from)\n            : Sizing.Invisible(cachedVisibleSize);\n        const view = this.removeView(from, undefined, true);\n        this.addView(view, sizing, to);\n    }\n    layout(size, orthogonalSize) {\n        const previousSize = Math.max(this.size, this._contentSize);\n        this.size = size;\n        this.orthogonalSize = orthogonalSize;\n        if (!this.proportions) {\n            const indexes = range(this.viewItems.length);\n            const lowPriorityIndexes = indexes.filter((i) => this.viewItems[i].priority === LayoutPriority.Low);\n            const highPriorityIndexes = indexes.filter((i) => this.viewItems[i].priority === LayoutPriority.High);\n            this.resize(this.viewItems.length - 1, size - previousSize, undefined, lowPriorityIndexes, highPriorityIndexes);\n        }\n        else {\n            let total = 0;\n            for (let i = 0; i < this.viewItems.length; i++) {\n                const item = this.viewItems[i];\n                const proportion = this.proportions[i];\n                if (typeof proportion === 'number') {\n                    total += proportion;\n                }\n                else {\n                    size -= item.size;\n                }\n            }\n            for (let i = 0; i < this.viewItems.length; i++) {\n                const item = this.viewItems[i];\n                const proportion = this.proportions[i];\n                if (typeof proportion === 'number' && total > 0) {\n                    item.size = clamp(Math.round((proportion * size) / total), item.minimumSize, item.maximumSize);\n                }\n            }\n        }\n        this.distributeEmptySpace();\n        this.layoutViews();\n    }\n    relayout(lowPriorityIndexes, highPriorityIndexes) {\n        const contentSize = this.viewItems.reduce((r, i) => r + i.size, 0);\n        this.resize(this.viewItems.length - 1, this._size - contentSize, undefined, lowPriorityIndexes, highPriorityIndexes);\n        this.distributeEmptySpace();\n        this.layoutViews();\n        this.saveProportions();\n    }\n    distributeEmptySpace(lowPriorityIndex) {\n        const contentSize = this.viewItems.reduce((r, i) => r + i.size, 0);\n        let emptyDelta = this.size - contentSize;\n        const indexes = range(this.viewItems.length - 1, -1);\n        const lowPriorityIndexes = indexes.filter((i) => this.viewItems[i].priority === LayoutPriority.Low);\n        const highPriorityIndexes = indexes.filter((i) => this.viewItems[i].priority === LayoutPriority.High);\n        for (const index of highPriorityIndexes) {\n            pushToStart(indexes, index);\n        }\n        for (const index of lowPriorityIndexes) {\n            pushToEnd(indexes, index);\n        }\n        if (typeof lowPriorityIndex === 'number') {\n            pushToEnd(indexes, lowPriorityIndex);\n        }\n        for (let i = 0; emptyDelta !== 0 && i < indexes.length; i++) {\n            const item = this.viewItems[indexes[i]];\n            const size = clamp(item.size + emptyDelta, item.minimumSize, item.maximumSize);\n            const viewDelta = size - item.size;\n            emptyDelta -= viewDelta;\n            item.size = size;\n        }\n    }\n    saveProportions() {\n        if (this.proportionalLayout && this._contentSize > 0) {\n            this._proportions = this.viewItems.map((i) => i.visible ? i.size / this._contentSize : undefined);\n        }\n    }\n    /**\n     * Margin explain:\n     *\n     * For `n` views in a splitview there will be `n-1` margins `m`.\n     *\n     * To fit the margins each view must reduce in size by `(m * (n - 1)) / n`.\n     *\n     * For each view `i` the offet must be adjusted by `m * i/(n - 1)`.\n     */\n    layoutViews() {\n        this._contentSize = this.viewItems.reduce((r, i) => r + i.size, 0);\n        this.updateSashEnablement();\n        if (this.viewItems.length === 0) {\n            return;\n        }\n        const visibleViewItems = this.viewItems.filter((i) => i.visible);\n        const sashCount = Math.max(0, visibleViewItems.length - 1);\n        const marginReducedSize = (this.margin * sashCount) / Math.max(1, visibleViewItems.length);\n        let totalLeftOffset = 0;\n        const viewLeftOffsets = [];\n        const sashWidth = 4; // hardcoded in css\n        const runningVisiblePanelCount = this.viewItems.reduce((arr, viewItem, i) => {\n            const flag = viewItem.visible ? 1 : 0;\n            if (i === 0) {\n                arr.push(flag);\n            }\n            else {\n                arr.push(arr[i - 1] + flag);\n            }\n            return arr;\n        }, []);\n        // calculate both view and cash positions\n        this.viewItems.forEach((view, i) => {\n            totalLeftOffset += this.viewItems[i].size;\n            viewLeftOffsets.push(totalLeftOffset);\n            const size = view.visible ? view.size - marginReducedSize : 0;\n            const visiblePanelsBeforeThisView = Math.max(0, runningVisiblePanelCount[i] - 1);\n            const offset = i === 0 || visiblePanelsBeforeThisView === 0\n                ? 0\n                : viewLeftOffsets[i - 1] +\n                    (visiblePanelsBeforeThisView / sashCount) *\n                        marginReducedSize;\n            if (i < this.viewItems.length - 1) {\n                // calculate sash position\n                const newSize = view.visible\n                    ? offset + size - sashWidth / 2 + this.margin / 2\n                    : offset;\n                if (this._orientation === Orientation.HORIZONTAL) {\n                    this.sashes[i].container.style.left = `${newSize}px`;\n                    this.sashes[i].container.style.top = `0px`;\n                }\n                if (this._orientation === Orientation.VERTICAL) {\n                    this.sashes[i].container.style.left = `0px`;\n                    this.sashes[i].container.style.top = `${newSize}px`;\n                }\n            }\n            // calculate view position\n            if (this._orientation === Orientation.HORIZONTAL) {\n                view.container.style.width = `${size}px`;\n                view.container.style.left = `${offset}px`;\n                view.container.style.top = '';\n                view.container.style.height = '';\n            }\n            if (this._orientation === Orientation.VERTICAL) {\n                view.container.style.height = `${size}px`;\n                view.container.style.top = `${offset}px`;\n                view.container.style.width = '';\n                view.container.style.left = '';\n            }\n            view.view.layout(view.size - marginReducedSize, this._orthogonalSize);\n        });\n    }\n    findFirstSnapIndex(indexes) {\n        // visible views first\n        for (const index of indexes) {\n            const viewItem = this.viewItems[index];\n            if (!viewItem.visible) {\n                continue;\n            }\n            if (viewItem.snap) {\n                return index;\n            }\n        }\n        // then, hidden views\n        for (const index of indexes) {\n            const viewItem = this.viewItems[index];\n            if (viewItem.visible &&\n                viewItem.maximumSize - viewItem.minimumSize > 0) {\n                return undefined;\n            }\n            if (!viewItem.visible && viewItem.snap) {\n                return index;\n            }\n        }\n        return undefined;\n    }\n    updateSashEnablement() {\n        let previous = false;\n        const collapsesDown = this.viewItems.map((i) => (previous = i.size - i.minimumSize > 0 || previous));\n        previous = false;\n        const expandsDown = this.viewItems.map((i) => (previous = i.maximumSize - i.size > 0 || previous));\n        const reverseViews = [...this.viewItems].reverse();\n        previous = false;\n        const collapsesUp = reverseViews\n            .map((i) => (previous = i.size - i.minimumSize > 0 || previous))\n            .reverse();\n        previous = false;\n        const expandsUp = reverseViews\n            .map((i) => (previous = i.maximumSize - i.size > 0 || previous))\n            .reverse();\n        let position = 0;\n        for (let index = 0; index < this.sashes.length; index++) {\n            const sash = this.sashes[index];\n            const viewItem = this.viewItems[index];\n            position += viewItem.size;\n            const min = !(collapsesDown[index] && expandsUp[index + 1]);\n            const max = !(expandsDown[index] && collapsesUp[index + 1]);\n            if (min && max) {\n                const upIndexes = range(index, -1);\n                const downIndexes = range(index + 1, this.viewItems.length);\n                const snapBeforeIndex = this.findFirstSnapIndex(upIndexes);\n                const snapAfterIndex = this.findFirstSnapIndex(downIndexes);\n                const snappedBefore = typeof snapBeforeIndex === 'number' &&\n                    !this.viewItems[snapBeforeIndex].visible;\n                const snappedAfter = typeof snapAfterIndex === 'number' &&\n                    !this.viewItems[snapAfterIndex].visible;\n                if (snappedBefore &&\n                    collapsesUp[index] &&\n                    (position > 0 || this.startSnappingEnabled)) {\n                    this.updateSash(sash, SashState.MINIMUM);\n                }\n                else if (snappedAfter &&\n                    collapsesDown[index] &&\n                    (position < this._contentSize || this.endSnappingEnabled)) {\n                    this.updateSash(sash, SashState.MAXIMUM);\n                }\n                else {\n                    this.updateSash(sash, SashState.DISABLED);\n                }\n            }\n            else if (min && !max) {\n                this.updateSash(sash, SashState.MINIMUM);\n            }\n            else if (!min && max) {\n                this.updateSash(sash, SashState.MAXIMUM);\n            }\n            else {\n                this.updateSash(sash, SashState.ENABLED);\n            }\n        }\n    }\n    updateSash(sash, state) {\n        toggleClass(sash.container, 'dv-disabled', state === SashState.DISABLED);\n        toggleClass(sash.container, 'dv-enabled', state === SashState.ENABLED);\n        toggleClass(sash.container, 'dv-maximum', state === SashState.MAXIMUM);\n        toggleClass(sash.container, 'dv-minimum', state === SashState.MINIMUM);\n    }\n    createViewContainer() {\n        const element = document.createElement('div');\n        element.className = 'dv-view-container';\n        return element;\n    }\n    createSashContainer() {\n        const element = document.createElement('div');\n        element.className = 'dv-sash-container';\n        return element;\n    }\n    createContainer() {\n        const element = document.createElement('div');\n        const orientationClassname = this._orientation === Orientation.HORIZONTAL\n            ? 'dv-horizontal'\n            : 'dv-vertical';\n        element.className = `dv-split-view-container ${orientationClassname}`;\n        return element;\n    }\n    dispose() {\n        this._onDidSashEnd.dispose();\n        this._onDidAddView.dispose();\n        this._onDidRemoveView.dispose();\n        for (let i = 0; i < this.element.children.length; i++) {\n            if (this.element.children.item(i) === this.element) {\n                this.element.removeChild(this.element);\n                break;\n            }\n        }\n        for (const viewItem of this.viewItems) {\n            viewItem.dispose();\n        }\n        this.element.remove();\n    }\n}\n","export const PROPERTY_KEYS_SPLITVIEW = (() => {\n    /**\n     * by readong the keys from an empty value object TypeScript will error\n     * when we add or remove new properties to `DockviewOptions`\n     */\n    const properties = {\n        orientation: undefined,\n        descriptor: undefined,\n        proportionalLayout: undefined,\n        styles: undefined,\n        margin: undefined,\n        disableAutoResizing: undefined,\n        className: undefined,\n    };\n    return Object.keys(properties);\n})();\n","import { Splitview, Orientation, } from '../splitview/splitview';\nimport { CompositeDisposable } from '../lifecycle';\nimport { Emitter } from '../events';\nimport { addClasses, removeClasses } from '../dom';\nexport class Paneview extends CompositeDisposable {\n    get onDidAddView() {\n        return this.splitview.onDidAddView;\n    }\n    get onDidRemoveView() {\n        return this.splitview.onDidRemoveView;\n    }\n    get minimumSize() {\n        return this.splitview.minimumSize;\n    }\n    get maximumSize() {\n        return this.splitview.maximumSize;\n    }\n    get orientation() {\n        return this.splitview.orientation;\n    }\n    get size() {\n        return this.splitview.size;\n    }\n    get orthogonalSize() {\n        return this.splitview.orthogonalSize;\n    }\n    constructor(container, options) {\n        var _a;\n        super();\n        this.paneItems = [];\n        this.skipAnimation = false;\n        this._onDidChange = new Emitter();\n        this.onDidChange = this._onDidChange.event;\n        this._orientation = (_a = options.orientation) !== null && _a !== void 0 ? _a : Orientation.VERTICAL;\n        this.element = document.createElement('div');\n        this.element.className = 'dv-pane-container';\n        container.appendChild(this.element);\n        this.splitview = new Splitview(this.element, {\n            orientation: this._orientation,\n            proportionalLayout: false,\n            descriptor: options.descriptor,\n        });\n        // if we've added views from the descriptor we need to\n        // add the panes to our Pane array and setup animation\n        this.getPanes().forEach((pane) => {\n            const disposable = new CompositeDisposable(pane.onDidChangeExpansionState(() => {\n                this.setupAnimation();\n                this._onDidChange.fire(undefined);\n            }));\n            const paneItem = {\n                pane,\n                disposable: {\n                    dispose: () => {\n                        disposable.dispose();\n                    },\n                },\n            };\n            this.paneItems.push(paneItem);\n            pane.orthogonalSize = this.splitview.orthogonalSize;\n        });\n        this.addDisposables(this._onDidChange, this.splitview.onDidSashEnd(() => {\n            this._onDidChange.fire(undefined);\n        }), this.splitview.onDidAddView(() => {\n            this._onDidChange.fire();\n        }), this.splitview.onDidRemoveView(() => {\n            this._onDidChange.fire();\n        }));\n    }\n    setViewVisible(index, visible) {\n        this.splitview.setViewVisible(index, visible);\n    }\n    addPane(pane, size, index = this.splitview.length, skipLayout = false) {\n        const disposable = pane.onDidChangeExpansionState(() => {\n            this.setupAnimation();\n            this._onDidChange.fire(undefined);\n        });\n        const paneItem = {\n            pane,\n            disposable: {\n                dispose: () => {\n                    disposable.dispose();\n                },\n            },\n        };\n        this.paneItems.splice(index, 0, paneItem);\n        pane.orthogonalSize = this.splitview.orthogonalSize;\n        this.splitview.addView(pane, size, index, skipLayout);\n    }\n    getViewSize(index) {\n        return this.splitview.getViewSize(index);\n    }\n    getPanes() {\n        return this.splitview.getViews();\n    }\n    removePane(index, options = { skipDispose: false }) {\n        const paneItem = this.paneItems.splice(index, 1)[0];\n        this.splitview.removeView(index);\n        if (!options.skipDispose) {\n            paneItem.disposable.dispose();\n            paneItem.pane.dispose();\n        }\n        return paneItem;\n    }\n    moveView(from, to) {\n        if (from === to) {\n            return;\n        }\n        const view = this.removePane(from, { skipDispose: true });\n        this.skipAnimation = true;\n        try {\n            this.addPane(view.pane, view.pane.size, to, false);\n        }\n        finally {\n            this.skipAnimation = false;\n        }\n    }\n    layout(size, orthogonalSize) {\n        this.splitview.layout(size, orthogonalSize);\n    }\n    setupAnimation() {\n        if (this.skipAnimation) {\n            return;\n        }\n        if (this.animationTimer) {\n            clearTimeout(this.animationTimer);\n            this.animationTimer = undefined;\n        }\n        addClasses(this.element, 'dv-animated');\n        this.animationTimer = setTimeout(() => {\n            this.animationTimer = undefined;\n            removeClasses(this.element, 'dv-animated');\n        }, 200);\n    }\n    dispose() {\n        super.dispose();\n        if (this.animationTimer) {\n            clearTimeout(this.animationTimer);\n            this.animationTimer = undefined;\n        }\n        this.paneItems.forEach((paneItem) => {\n            paneItem.disposable.dispose();\n            paneItem.pane.dispose();\n        });\n        this.paneItems = [];\n        this.splitview.dispose();\n        this.element.remove();\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n * Accreditation: This file is largly based upon the MIT licenced VSCode sourcecode found at:\n * https://github.com/microsoft/vscode/tree/main/src/vs/base/browser/ui/grid\n *--------------------------------------------------------------------------------------------*/\nimport { Orientation } from '../splitview/splitview';\nimport { Emitter } from '../events';\nexport class LeafNode {\n    get minimumWidth() {\n        return this.view.minimumWidth;\n    }\n    get maximumWidth() {\n        return this.view.maximumWidth;\n    }\n    get minimumHeight() {\n        return this.view.minimumHeight;\n    }\n    get maximumHeight() {\n        return this.view.maximumHeight;\n    }\n    get priority() {\n        return this.view.priority;\n    }\n    get snap() {\n        return this.view.snap;\n    }\n    get minimumSize() {\n        return this.orientation === Orientation.HORIZONTAL\n            ? this.minimumHeight\n            : this.minimumWidth;\n    }\n    get maximumSize() {\n        return this.orientation === Orientation.HORIZONTAL\n            ? this.maximumHeight\n            : this.maximumWidth;\n    }\n    get minimumOrthogonalSize() {\n        return this.orientation === Orientation.HORIZONTAL\n            ? this.minimumWidth\n            : this.minimumHeight;\n    }\n    get maximumOrthogonalSize() {\n        return this.orientation === Orientation.HORIZONTAL\n            ? this.maximumWidth\n            : this.maximumHeight;\n    }\n    get orthogonalSize() {\n        return this._orthogonalSize;\n    }\n    get size() {\n        return this._size;\n    }\n    get element() {\n        return this.view.element;\n    }\n    get width() {\n        return this.orientation === Orientation.HORIZONTAL\n            ? this.orthogonalSize\n            : this.size;\n    }\n    get height() {\n        return this.orientation === Orientation.HORIZONTAL\n            ? this.size\n            : this.orthogonalSize;\n    }\n    constructor(view, orientation, orthogonalSize, size = 0) {\n        this.view = view;\n        this.orientation = orientation;\n        this._onDidChange = new Emitter();\n        this.onDidChange = this._onDidChange.event;\n        this._orthogonalSize = orthogonalSize;\n        this._size = size;\n        this._disposable = this.view.onDidChange((event) => {\n            if (event) {\n                this._onDidChange.fire({\n                    size: this.orientation === Orientation.VERTICAL\n                        ? event.width\n                        : event.height,\n                    orthogonalSize: this.orientation === Orientation.VERTICAL\n                        ? event.height\n                        : event.width,\n                });\n            }\n            else {\n                this._onDidChange.fire({});\n            }\n        });\n    }\n    setVisible(visible) {\n        if (this.view.setVisible) {\n            this.view.setVisible(visible);\n        }\n    }\n    layout(size, orthogonalSize) {\n        this._size = size;\n        this._orthogonalSize = orthogonalSize;\n        this.view.layout(this.width, this.height);\n    }\n    dispose() {\n        this._onDidChange.dispose();\n        this._disposable.dispose();\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n * Accreditation: This file is largly based upon the MIT licenced VSCode sourcecode found at:\n * https://github.com/microsoft/vscode/tree/main/src/vs/base/browser/ui/grid\n *--------------------------------------------------------------------------------------------*/\nimport { Splitview, Orientation, LayoutPriority, } from '../splitview/splitview';\nimport { Emitter, Event } from '../events';\nimport { LeafNode } from './leafNode';\nimport { CompositeDisposable, Disposable } from '../lifecycle';\nexport class BranchNode extends CompositeDisposable {\n    get width() {\n        return this.orientation === Orientation.HORIZONTAL\n            ? this.size\n            : this.orthogonalSize;\n    }\n    get height() {\n        return this.orientation === Orientation.HORIZONTAL\n            ? this.orthogonalSize\n            : this.size;\n    }\n    get minimumSize() {\n        return this.children.length === 0\n            ? 0\n            : Math.max(...this.children.map((c, index) => this.splitview.isViewVisible(index)\n                ? c.minimumOrthogonalSize\n                : 0));\n    }\n    get maximumSize() {\n        return Math.min(...this.children.map((c, index) => this.splitview.isViewVisible(index)\n            ? c.maximumOrthogonalSize\n            : Number.POSITIVE_INFINITY));\n    }\n    get minimumOrthogonalSize() {\n        return this.splitview.minimumSize;\n    }\n    get maximumOrthogonalSize() {\n        return this.splitview.maximumSize;\n    }\n    get orthogonalSize() {\n        return this._orthogonalSize;\n    }\n    get size() {\n        return this._size;\n    }\n    get minimumWidth() {\n        return this.orientation === Orientation.HORIZONTAL\n            ? this.minimumOrthogonalSize\n            : this.minimumSize;\n    }\n    get minimumHeight() {\n        return this.orientation === Orientation.HORIZONTAL\n            ? this.minimumSize\n            : this.minimumOrthogonalSize;\n    }\n    get maximumWidth() {\n        return this.orientation === Orientation.HORIZONTAL\n            ? this.maximumOrthogonalSize\n            : this.maximumSize;\n    }\n    get maximumHeight() {\n        return this.orientation === Orientation.HORIZONTAL\n            ? this.maximumSize\n            : this.maximumOrthogonalSize;\n    }\n    get priority() {\n        if (this.children.length === 0) {\n            return LayoutPriority.Normal;\n        }\n        const priorities = this.children.map((c) => typeof c.priority === 'undefined'\n            ? LayoutPriority.Normal\n            : c.priority);\n        if (priorities.some((p) => p === LayoutPriority.High)) {\n            return LayoutPriority.High;\n        }\n        else if (priorities.some((p) => p === LayoutPriority.Low)) {\n            return LayoutPriority.Low;\n        }\n        return LayoutPriority.Normal;\n    }\n    get disabled() {\n        return this.splitview.disabled;\n    }\n    set disabled(value) {\n        this.splitview.disabled = value;\n    }\n    get margin() {\n        return this.splitview.margin;\n    }\n    set margin(value) {\n        this.splitview.margin = value;\n        this.children.forEach((child) => {\n            if (child instanceof BranchNode) {\n                child.margin = value;\n            }\n        });\n    }\n    constructor(orientation, proportionalLayout, styles, size, orthogonalSize, disabled, margin, childDescriptors) {\n        super();\n        this.orientation = orientation;\n        this.proportionalLayout = proportionalLayout;\n        this.styles = styles;\n        this._childrenDisposable = Disposable.NONE;\n        this.children = [];\n        this._onDidChange = new Emitter();\n        this.onDidChange = this._onDidChange.event;\n        this._onDidVisibilityChange = new Emitter();\n        this.onDidVisibilityChange = this._onDidVisibilityChange.event;\n        this._orthogonalSize = orthogonalSize;\n        this._size = size;\n        this.element = document.createElement('div');\n        this.element.className = 'dv-branch-node';\n        if (!childDescriptors) {\n            this.splitview = new Splitview(this.element, {\n                orientation: this.orientation,\n                proportionalLayout,\n                styles,\n                margin,\n            });\n            this.splitview.layout(this.size, this.orthogonalSize);\n        }\n        else {\n            const descriptor = {\n                views: childDescriptors.map((childDescriptor) => {\n                    return {\n                        view: childDescriptor.node,\n                        size: childDescriptor.node.size,\n                        visible: childDescriptor.node instanceof LeafNode &&\n                            childDescriptor.visible !== undefined\n                            ? childDescriptor.visible\n                            : true,\n                    };\n                }),\n                size: this.orthogonalSize,\n            };\n            this.children = childDescriptors.map((c) => c.node);\n            this.splitview = new Splitview(this.element, {\n                orientation: this.orientation,\n                descriptor,\n                proportionalLayout,\n                styles,\n                margin,\n            });\n        }\n        this.disabled = disabled;\n        this.addDisposables(this._onDidChange, this._onDidVisibilityChange, this.splitview.onDidSashEnd(() => {\n            this._onDidChange.fire({});\n        }));\n        this.setupChildrenEvents();\n    }\n    setVisible(_visible) {\n        // noop\n    }\n    isChildVisible(index) {\n        if (index < 0 || index >= this.children.length) {\n            throw new Error('Invalid index');\n        }\n        return this.splitview.isViewVisible(index);\n    }\n    setChildVisible(index, visible) {\n        if (index < 0 || index >= this.children.length) {\n            throw new Error('Invalid index');\n        }\n        if (this.splitview.isViewVisible(index) === visible) {\n            return;\n        }\n        const wereAllChildrenHidden = this.splitview.contentSize === 0;\n        this.splitview.setViewVisible(index, visible);\n        // }\n        const areAllChildrenHidden = this.splitview.contentSize === 0;\n        // If all children are hidden then the parent should hide the entire splitview\n        // If the entire splitview is hidden then the parent should show the splitview when a child is shown\n        if ((visible && wereAllChildrenHidden) ||\n            (!visible && areAllChildrenHidden)) {\n            this._onDidVisibilityChange.fire({ visible });\n        }\n    }\n    moveChild(from, to) {\n        if (from === to) {\n            return;\n        }\n        if (from < 0 || from >= this.children.length) {\n            throw new Error('Invalid from index');\n        }\n        if (from < to) {\n            to--;\n        }\n        this.splitview.moveView(from, to);\n        const child = this._removeChild(from);\n        this._addChild(child, to);\n    }\n    getChildSize(index) {\n        if (index < 0 || index >= this.children.length) {\n            throw new Error('Invalid index');\n        }\n        return this.splitview.getViewSize(index);\n    }\n    resizeChild(index, size) {\n        if (index < 0 || index >= this.children.length) {\n            throw new Error('Invalid index');\n        }\n        this.splitview.resizeView(index, size);\n    }\n    layout(size, orthogonalSize) {\n        this._size = orthogonalSize;\n        this._orthogonalSize = size;\n        this.splitview.layout(orthogonalSize, size);\n    }\n    addChild(node, size, index, skipLayout) {\n        if (index < 0 || index > this.children.length) {\n            throw new Error('Invalid index');\n        }\n        this.splitview.addView(node, size, index, skipLayout);\n        this._addChild(node, index);\n    }\n    getChildCachedVisibleSize(index) {\n        if (index < 0 || index >= this.children.length) {\n            throw new Error('Invalid index');\n        }\n        return this.splitview.getViewCachedVisibleSize(index);\n    }\n    removeChild(index, sizing) {\n        if (index < 0 || index >= this.children.length) {\n            throw new Error('Invalid index');\n        }\n        this.splitview.removeView(index, sizing);\n        return this._removeChild(index);\n    }\n    _addChild(node, index) {\n        this.children.splice(index, 0, node);\n        this.setupChildrenEvents();\n    }\n    _removeChild(index) {\n        const [child] = this.children.splice(index, 1);\n        this.setupChildrenEvents();\n        return child;\n    }\n    setupChildrenEvents() {\n        this._childrenDisposable.dispose();\n        this._childrenDisposable = new CompositeDisposable(Event.any(...this.children.map((c) => c.onDidChange))((e) => {\n            /**\n             * indicate a change has occured to allows any re-rendering but don't bubble\n             * event because that was specific to this branch\n             */\n            this._onDidChange.fire({ size: e.orthogonalSize });\n        }), ...this.children.map((c, i) => {\n            if (c instanceof BranchNode) {\n                return c.onDidVisibilityChange(({ visible }) => {\n                    this.setChildVisible(i, visible);\n                });\n            }\n            return Disposable.NONE;\n        }));\n    }\n    dispose() {\n        this._childrenDisposable.dispose();\n        this.splitview.dispose();\n        this.children.forEach((child) => child.dispose());\n        super.dispose();\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n * Accreditation: This file is largly based upon the MIT licenced VSCode sourcecode found at:\n * https://github.com/microsoft/vscode/tree/main/src/vs/base/browser/ui/grid\n *--------------------------------------------------------------------------------------------*/\nimport { Orientation, Sizing, } from '../splitview/splitview';\nimport { tail } from '../array';\nimport { LeafNode } from './leafNode';\nimport { BranchNode } from './branchNode';\nimport { Emitter } from '../events';\nimport { MutableDisposable } from '../lifecycle';\nfunction findLeaf(candiateNode, last) {\n    if (candiateNode instanceof LeafNode) {\n        return candiateNode;\n    }\n    if (candiateNode instanceof BranchNode) {\n        return findLeaf(candiateNode.children[last ? candiateNode.children.length - 1 : 0], last);\n    }\n    throw new Error('invalid node');\n}\nfunction cloneNode(node, size, orthogonalSize) {\n    if (node instanceof BranchNode) {\n        const result = new BranchNode(node.orientation, node.proportionalLayout, node.styles, size, orthogonalSize, node.disabled, node.margin);\n        for (let i = node.children.length - 1; i >= 0; i--) {\n            const child = node.children[i];\n            result.addChild(cloneNode(child, child.size, child.orthogonalSize), child.size, 0, true);\n        }\n        return result;\n    }\n    else {\n        return new LeafNode(node.view, node.orientation, orthogonalSize);\n    }\n}\nfunction flipNode(node, size, orthogonalSize) {\n    if (node instanceof BranchNode) {\n        const result = new BranchNode(orthogonal(node.orientation), node.proportionalLayout, node.styles, size, orthogonalSize, node.disabled, node.margin);\n        let totalSize = 0;\n        for (let i = node.children.length - 1; i >= 0; i--) {\n            const child = node.children[i];\n            const childSize = child instanceof BranchNode ? child.orthogonalSize : child.size;\n            let newSize = node.size === 0\n                ? 0\n                : Math.round((size * childSize) / node.size);\n            totalSize += newSize;\n            // The last view to add should adjust to rounding errors\n            if (i === 0) {\n                newSize += size - totalSize;\n            }\n            result.addChild(flipNode(child, orthogonalSize, newSize), newSize, 0, true);\n        }\n        return result;\n    }\n    else {\n        return new LeafNode(node.view, orthogonal(node.orientation), orthogonalSize);\n    }\n}\nexport function indexInParent(element) {\n    const parentElement = element.parentElement;\n    if (!parentElement) {\n        throw new Error('Invalid grid element');\n    }\n    let el = parentElement.firstElementChild;\n    let index = 0;\n    while (el !== element && el !== parentElement.lastElementChild && el) {\n        el = el.nextElementSibling;\n        index++;\n    }\n    return index;\n}\n/**\n * Find the grid location of a specific DOM element by traversing the parent\n * chain and finding each child index on the way.\n *\n * This will break as soon as DOM structures of the Splitview or Gridview change.\n */\nexport function getGridLocation(element) {\n    const parentElement = element.parentElement;\n    if (!parentElement) {\n        throw new Error('Invalid grid element');\n    }\n    if (/\\bdv-grid-view\\b/.test(parentElement.className)) {\n        return [];\n    }\n    const index = indexInParent(parentElement);\n    const ancestor = parentElement.parentElement.parentElement.parentElement;\n    return [...getGridLocation(ancestor), index];\n}\nexport function getRelativeLocation(rootOrientation, location, direction) {\n    const orientation = getLocationOrientation(rootOrientation, location);\n    const directionOrientation = getDirectionOrientation(direction);\n    if (orientation === directionOrientation) {\n        const [rest, _index] = tail(location);\n        let index = _index;\n        if (direction === 'right' || direction === 'bottom') {\n            index += 1;\n        }\n        return [...rest, index];\n    }\n    else {\n        const index = direction === 'right' || direction === 'bottom' ? 1 : 0;\n        return [...location, index];\n    }\n}\nexport function getDirectionOrientation(direction) {\n    return direction === 'top' || direction === 'bottom'\n        ? Orientation.VERTICAL\n        : Orientation.HORIZONTAL;\n}\nexport function getLocationOrientation(rootOrientation, location) {\n    return location.length % 2 === 0\n        ? orthogonal(rootOrientation)\n        : rootOrientation;\n}\nexport const orthogonal = (orientation) => orientation === Orientation.HORIZONTAL\n    ? Orientation.VERTICAL\n    : Orientation.HORIZONTAL;\nexport function isGridBranchNode(node) {\n    return !!node.children;\n}\nconst serializeBranchNode = (node, orientation) => {\n    const size = orientation === Orientation.VERTICAL ? node.box.width : node.box.height;\n    if (!isGridBranchNode(node)) {\n        if (typeof node.cachedVisibleSize === 'number') {\n            return {\n                type: 'leaf',\n                data: node.view.toJSON(),\n                size: node.cachedVisibleSize,\n                visible: false,\n            };\n        }\n        return { type: 'leaf', data: node.view.toJSON(), size };\n    }\n    return {\n        type: 'branch',\n        data: node.children.map((c) => serializeBranchNode(c, orthogonal(orientation))),\n        size,\n    };\n};\nexport class Gridview {\n    get length() {\n        return this._root ? this._root.children.length : 0;\n    }\n    get orientation() {\n        return this.root.orientation;\n    }\n    set orientation(orientation) {\n        if (this.root.orientation === orientation) {\n            return;\n        }\n        const { size, orthogonalSize } = this.root;\n        this.root = flipNode(this.root, orthogonalSize, size);\n        this.root.layout(size, orthogonalSize);\n    }\n    get width() {\n        return this.root.width;\n    }\n    get height() {\n        return this.root.height;\n    }\n    get minimumWidth() {\n        return this.root.minimumWidth;\n    }\n    get minimumHeight() {\n        return this.root.minimumHeight;\n    }\n    get maximumWidth() {\n        return this.root.maximumHeight;\n    }\n    get maximumHeight() {\n        return this.root.maximumHeight;\n    }\n    get locked() {\n        return this._locked;\n    }\n    set locked(value) {\n        this._locked = value;\n        const branch = [this.root];\n        /**\n         * simple depth-first-search to cover all nodes\n         *\n         * @see https://en.wikipedia.org/wiki/Depth-first_search\n         */\n        while (branch.length > 0) {\n            const node = branch.pop();\n            if (node instanceof BranchNode) {\n                node.disabled = value;\n                branch.push(...node.children);\n            }\n        }\n    }\n    get margin() {\n        return this._margin;\n    }\n    set margin(value) {\n        this._margin = value;\n        this.root.margin = value;\n    }\n    maximizedView() {\n        var _a;\n        return (_a = this._maximizedNode) === null || _a === void 0 ? void 0 : _a.leaf.view;\n    }\n    hasMaximizedView() {\n        return this._maximizedNode !== undefined;\n    }\n    maximizeView(view) {\n        var _a;\n        const location = getGridLocation(view.element);\n        const [_, node] = this.getNode(location);\n        if (!(node instanceof LeafNode)) {\n            return;\n        }\n        if (((_a = this._maximizedNode) === null || _a === void 0 ? void 0 : _a.leaf) === node) {\n            return;\n        }\n        if (this.hasMaximizedView()) {\n            this.exitMaximizedView();\n        }\n        serializeBranchNode(this.getView(), this.orientation);\n        const hiddenOnMaximize = [];\n        function hideAllViewsBut(parent, exclude) {\n            for (let i = 0; i < parent.children.length; i++) {\n                const child = parent.children[i];\n                if (child instanceof LeafNode) {\n                    if (child !== exclude) {\n                        if (parent.isChildVisible(i)) {\n                            parent.setChildVisible(i, false);\n                        }\n                        else {\n                            hiddenOnMaximize.push(child);\n                        }\n                    }\n                }\n                else {\n                    hideAllViewsBut(child, exclude);\n                }\n            }\n        }\n        hideAllViewsBut(this.root, node);\n        this._maximizedNode = { leaf: node, hiddenOnMaximize };\n        this._onDidMaximizedNodeChange.fire({\n            view: node.view,\n            isMaximized: true,\n        });\n    }\n    exitMaximizedView() {\n        if (!this._maximizedNode) {\n            return;\n        }\n        const hiddenOnMaximize = this._maximizedNode.hiddenOnMaximize;\n        function showViewsInReverseOrder(parent) {\n            for (let index = parent.children.length - 1; index >= 0; index--) {\n                const child = parent.children[index];\n                if (child instanceof LeafNode) {\n                    if (!hiddenOnMaximize.includes(child)) {\n                        parent.setChildVisible(index, true);\n                    }\n                }\n                else {\n                    showViewsInReverseOrder(child);\n                }\n            }\n        }\n        showViewsInReverseOrder(this.root);\n        const tmp = this._maximizedNode.leaf;\n        this._maximizedNode = undefined;\n        this._onDidMaximizedNodeChange.fire({\n            view: tmp.view,\n            isMaximized: false,\n        });\n    }\n    serialize() {\n        const maximizedView = this.maximizedView();\n        let maxmizedViewLocation;\n        if (maximizedView) {\n            /**\n             * The minimum information we can get away with in order to serialize a maxmized view is it's location within the grid\n             * which is represented as a branch of indices\n             */\n            maxmizedViewLocation = getGridLocation(maximizedView.element);\n        }\n        if (this.hasMaximizedView()) {\n            /**\n             * the saved layout cannot be in its maxmized state otherwise all of the underlying\n             * view dimensions will be wrong\n             *\n             * To counteract this we temporaily remove the maximized view to compute the serialized output\n             * of the grid before adding back the maxmized view as to not alter the layout from the users\n             * perspective when `.toJSON()` is called\n             */\n            this.exitMaximizedView();\n        }\n        const root = serializeBranchNode(this.getView(), this.orientation);\n        const resullt = {\n            root,\n            width: this.width,\n            height: this.height,\n            orientation: this.orientation,\n        };\n        if (maxmizedViewLocation) {\n            resullt.maximizedNode = {\n                location: maxmizedViewLocation,\n            };\n        }\n        if (maximizedView) {\n            // replace any maximzied view that was removed for serialization purposes\n            this.maximizeView(maximizedView);\n        }\n        return resullt;\n    }\n    dispose() {\n        this.disposable.dispose();\n        this._onDidChange.dispose();\n        this._onDidMaximizedNodeChange.dispose();\n        this._onDidViewVisibilityChange.dispose();\n        this.root.dispose();\n        this._maximizedNode = undefined;\n        this.element.remove();\n    }\n    clear() {\n        const orientation = this.root.orientation;\n        this.root = new BranchNode(orientation, this.proportionalLayout, this.styles, this.root.size, this.root.orthogonalSize, this.locked, this.margin);\n    }\n    deserialize(json, deserializer) {\n        const orientation = json.orientation;\n        const height = orientation === Orientation.VERTICAL ? json.height : json.width;\n        this._deserialize(json.root, orientation, deserializer, height);\n        /**\n         * The deserialied layout must be positioned through this.layout(...)\n         * before any maximizedNode can be positioned\n         */\n        this.layout(json.width, json.height);\n        if (json.maximizedNode) {\n            const location = json.maximizedNode.location;\n            const [_, node] = this.getNode(location);\n            if (!(node instanceof LeafNode)) {\n                return;\n            }\n            this.maximizeView(node.view);\n        }\n    }\n    _deserialize(root, orientation, deserializer, orthogonalSize) {\n        this.root = this._deserializeNode(root, orientation, deserializer, orthogonalSize);\n    }\n    _deserializeNode(node, orientation, deserializer, orthogonalSize) {\n        var _a;\n        let result;\n        if (node.type === 'branch') {\n            const serializedChildren = node.data;\n            const children = serializedChildren.map((serializedChild) => {\n                return {\n                    node: this._deserializeNode(serializedChild, orthogonal(orientation), deserializer, node.size),\n                    visible: serializedChild.visible,\n                };\n            });\n            result = new BranchNode(orientation, this.proportionalLayout, this.styles, node.size, // <- orthogonal size - flips at each depth\n            orthogonalSize, // <- size - flips at each depth,\n            this.locked, this.margin, children);\n        }\n        else {\n            const view = deserializer.fromJSON(node);\n            if (typeof node.visible === 'boolean') {\n                (_a = view.setVisible) === null || _a === void 0 ? void 0 : _a.call(view, node.visible);\n            }\n            result = new LeafNode(view, orientation, orthogonalSize, node.size);\n        }\n        return result;\n    }\n    get root() {\n        return this._root;\n    }\n    set root(root) {\n        const oldRoot = this._root;\n        if (oldRoot) {\n            oldRoot.dispose();\n            this._maximizedNode = undefined;\n            this.element.removeChild(oldRoot.element);\n        }\n        this._root = root;\n        this.element.appendChild(this._root.element);\n        this.disposable.value = this._root.onDidChange((e) => {\n            this._onDidChange.fire(e);\n        });\n    }\n    normalize() {\n        if (!this._root) {\n            return;\n        }\n        if (this._root.children.length !== 1) {\n            return;\n        }\n        const oldRoot = this.root;\n        // can remove one level of redundant branching if there is only a single child\n        const childReference = oldRoot.children[0];\n        if (childReference instanceof LeafNode) {\n            return;\n        }\n        oldRoot.element.remove();\n        const child = oldRoot.removeChild(0); // Remove child to prevent double disposal\n        oldRoot.dispose(); // Dispose old root (won't dispose removed child)\n        child.dispose(); // Dispose the removed child\n        this._root = cloneNode(childReference, childReference.size, childReference.orthogonalSize);\n        this.element.appendChild(this._root.element);\n        this.disposable.value = this._root.onDidChange((e) => {\n            this._onDidChange.fire(e);\n        });\n    }\n    /**\n     * If the root is orientated as a VERTICAL node then nest the existing root within a new HORIZIONTAL root node\n     * If the root is orientated as a HORIZONTAL node then nest the existing root within a new VERITCAL root node\n     */\n    insertOrthogonalSplitviewAtRoot() {\n        if (!this._root) {\n            return;\n        }\n        const oldRoot = this.root;\n        oldRoot.element.remove();\n        this._root = new BranchNode(orthogonal(oldRoot.orientation), this.proportionalLayout, this.styles, this.root.orthogonalSize, this.root.size, this.locked, this.margin);\n        if (oldRoot.children.length === 0) {\n            // no data so no need to add anything back in\n        }\n        else if (oldRoot.children.length === 1) {\n            // can remove one level of redundant branching if there is only a single child\n            const childReference = oldRoot.children[0];\n            const child = oldRoot.removeChild(0); // remove to prevent disposal when disposing of unwanted root\n            child.dispose();\n            oldRoot.dispose();\n            this._root.addChild(\n            /**\n             * the child node will have the same orientation as the new root since\n             * we are removing the inbetween node.\n             * the entire 'tree' must be flipped recursively to ensure that the orientation\n             * flips at each level\n             */\n            flipNode(childReference, childReference.orthogonalSize, childReference.size), Sizing.Distribute, 0);\n        }\n        else {\n            this._root.addChild(oldRoot, Sizing.Distribute, 0);\n        }\n        this.element.appendChild(this._root.element);\n        this.disposable.value = this._root.onDidChange((e) => {\n            this._onDidChange.fire(e);\n        });\n    }\n    next(location) {\n        return this.progmaticSelect(location);\n    }\n    previous(location) {\n        return this.progmaticSelect(location, true);\n    }\n    getView(location) {\n        const node = location ? this.getNode(location)[1] : this.root;\n        return this._getViews(node, this.orientation);\n    }\n    _getViews(node, orientation, cachedVisibleSize) {\n        const box = { height: node.height, width: node.width };\n        if (node instanceof LeafNode) {\n            return { box, view: node.view, cachedVisibleSize };\n        }\n        const children = [];\n        for (let i = 0; i < node.children.length; i++) {\n            const child = node.children[i];\n            const nodeCachedVisibleSize = node.getChildCachedVisibleSize(i);\n            children.push(this._getViews(child, orthogonal(orientation), nodeCachedVisibleSize));\n        }\n        return { box, children };\n    }\n    progmaticSelect(location, reverse = false) {\n        const [path, node] = this.getNode(location);\n        if (!(node instanceof LeafNode)) {\n            throw new Error('invalid location');\n        }\n        for (let i = path.length - 1; i > -1; i--) {\n            const n = path[i];\n            const l = location[i] || 0;\n            const canProgressInCurrentLevel = reverse\n                ? l - 1 > -1\n                : l + 1 < n.children.length;\n            if (canProgressInCurrentLevel) {\n                return findLeaf(n.children[reverse ? l - 1 : l + 1], reverse);\n            }\n        }\n        return findLeaf(this.root, reverse);\n    }\n    constructor(proportionalLayout, styles, orientation, locked, margin) {\n        this.proportionalLayout = proportionalLayout;\n        this.styles = styles;\n        this._locked = false;\n        this._margin = 0;\n        this._maximizedNode = undefined;\n        this.disposable = new MutableDisposable();\n        this._onDidChange = new Emitter();\n        this.onDidChange = this._onDidChange.event;\n        this._onDidViewVisibilityChange = new Emitter();\n        this.onDidViewVisibilityChange = this._onDidViewVisibilityChange.event;\n        this._onDidMaximizedNodeChange = new Emitter();\n        this.onDidMaximizedNodeChange = this._onDidMaximizedNodeChange.event;\n        this.element = document.createElement('div');\n        this.element.className = 'dv-grid-view';\n        this._locked = locked !== null && locked !== void 0 ? locked : false;\n        this._margin = margin !== null && margin !== void 0 ? margin : 0;\n        this.root = new BranchNode(orientation, proportionalLayout, styles, 0, 0, this.locked, this.margin);\n    }\n    isViewVisible(location) {\n        const [rest, index] = tail(location);\n        const [, parent] = this.getNode(rest);\n        if (!(parent instanceof BranchNode)) {\n            throw new Error('Invalid from location');\n        }\n        return parent.isChildVisible(index);\n    }\n    setViewVisible(location, visible) {\n        if (this.hasMaximizedView()) {\n            this.exitMaximizedView();\n        }\n        const [rest, index] = tail(location);\n        const [, parent] = this.getNode(rest);\n        if (!(parent instanceof BranchNode)) {\n            throw new Error('Invalid from location');\n        }\n        this._onDidViewVisibilityChange.fire();\n        parent.setChildVisible(index, visible);\n    }\n    moveView(parentLocation, from, to) {\n        if (this.hasMaximizedView()) {\n            this.exitMaximizedView();\n        }\n        const [, parent] = this.getNode(parentLocation);\n        if (!(parent instanceof BranchNode)) {\n            throw new Error('Invalid location');\n        }\n        parent.moveChild(from, to);\n    }\n    addView(view, size, location) {\n        if (this.hasMaximizedView()) {\n            this.exitMaximizedView();\n        }\n        const [rest, index] = tail(location);\n        const [pathToParent, parent] = this.getNode(rest);\n        if (parent instanceof BranchNode) {\n            const node = new LeafNode(view, orthogonal(parent.orientation), parent.orthogonalSize);\n            parent.addChild(node, size, index);\n        }\n        else {\n            const [grandParent, ..._] = [...pathToParent].reverse();\n            const [parentIndex, ...__] = [...rest].reverse();\n            let newSiblingSize = 0;\n            const newSiblingCachedVisibleSize = grandParent.getChildCachedVisibleSize(parentIndex);\n            if (typeof newSiblingCachedVisibleSize === 'number') {\n                newSiblingSize = Sizing.Invisible(newSiblingCachedVisibleSize);\n            }\n            const child = grandParent.removeChild(parentIndex);\n            child.dispose();\n            const newParent = new BranchNode(parent.orientation, this.proportionalLayout, this.styles, parent.size, parent.orthogonalSize, this.locked, this.margin);\n            grandParent.addChild(newParent, parent.size, parentIndex);\n            const newSibling = new LeafNode(parent.view, grandParent.orientation, parent.size);\n            newParent.addChild(newSibling, newSiblingSize, 0);\n            if (typeof size !== 'number' && size.type === 'split') {\n                size = { type: 'split', index: 0 };\n            }\n            const node = new LeafNode(view, grandParent.orientation, parent.size);\n            newParent.addChild(node, size, index);\n        }\n    }\n    remove(view, sizing) {\n        const location = getGridLocation(view.element);\n        return this.removeView(location, sizing);\n    }\n    removeView(location, sizing) {\n        if (this.hasMaximizedView()) {\n            this.exitMaximizedView();\n        }\n        const [rest, index] = tail(location);\n        const [pathToParent, parent] = this.getNode(rest);\n        if (!(parent instanceof BranchNode)) {\n            throw new Error('Invalid location');\n        }\n        const nodeToRemove = parent.children[index];\n        if (!(nodeToRemove instanceof LeafNode)) {\n            throw new Error('Invalid location');\n        }\n        parent.removeChild(index, sizing);\n        nodeToRemove.dispose();\n        if (parent.children.length !== 1) {\n            return nodeToRemove.view;\n        }\n        // if the parent has only one child and we know the parent is a BranchNode we can make the tree\n        // more efficiently spaced by replacing the parent BranchNode with the child.\n        // if that child is a LeafNode then we simply replace the BranchNode with the child otherwise if the child\n        // is a BranchNode too we should spread it's children into the grandparent.\n        // refer to the remaining child as the sibling\n        const sibling = parent.children[0];\n        if (pathToParent.length === 0) {\n            // if the parent is root\n            if (sibling instanceof LeafNode) {\n                // if the sibling is a leaf node no action is required\n                return nodeToRemove.view;\n            }\n            // otherwise the sibling is a branch node. since the parent is the root and the root has only one child\n            // which is a branch node we can just set this branch node to be the new root node\n            // for good housekeeping we'll removing the sibling from it's existing tree\n            parent.removeChild(0, sizing);\n            // and set that sibling node to be root\n            this.root = sibling;\n            return nodeToRemove.view;\n        }\n        // otherwise the parent is apart of a large sub-tree\n        const [grandParent, ..._] = [...pathToParent].reverse();\n        const [parentIndex, ...__] = [...rest].reverse();\n        const isSiblingVisible = parent.isChildVisible(0);\n        // either way we need to remove the sibling from it's existing tree\n        parent.removeChild(0, sizing);\n        // note the sizes of all of the grandparents children\n        const sizes = grandParent.children.map((_size, i) => grandParent.getChildSize(i));\n        // remove the parent from the grandparent since we are moving the sibling to take the parents place\n        // this parent is no longer used and can be disposed of\n        grandParent.removeChild(parentIndex, sizing).dispose();\n        if (sibling instanceof BranchNode) {\n            // replace the parent with the siblings children\n            sizes.splice(parentIndex, 1, ...sibling.children.map((c) => c.size));\n            // and add those siblings to the grandparent\n            for (let i = 0; i < sibling.children.length; i++) {\n                const child = sibling.children[i];\n                grandParent.addChild(child, child.size, parentIndex + i);\n            }\n            /**\n             * clean down the branch node since we need to dipose of it and\n             * when .dispose() it called on a branch it will dispose of any\n             * views it is holding onto.\n             */\n            while (sibling.children.length > 0) {\n                sibling.removeChild(0);\n            }\n        }\n        else {\n            // otherwise create a new leaf node and add that to the grandparent\n            const newSibling = new LeafNode(sibling.view, orthogonal(sibling.orientation), sibling.size);\n            const siblingSizing = isSiblingVisible\n                ? sibling.orthogonalSize\n                : Sizing.Invisible(sibling.orthogonalSize);\n            grandParent.addChild(newSibling, siblingSizing, parentIndex);\n        }\n        // the containing node of the sibling is no longer required and can be disposed of\n        sibling.dispose();\n        // resize everything\n        for (let i = 0; i < sizes.length; i++) {\n            grandParent.resizeChild(i, sizes[i]);\n        }\n        return nodeToRemove.view;\n    }\n    layout(width, height) {\n        const [size, orthogonalSize] = this.root.orientation === Orientation.HORIZONTAL\n            ? [height, width]\n            : [width, height];\n        this.root.layout(size, orthogonalSize);\n    }\n    getNode(location, node = this.root, path = []) {\n        if (location.length === 0) {\n            return [path, node];\n        }\n        if (!(node instanceof BranchNode)) {\n            throw new Error('Invalid location');\n        }\n        const [index, ...rest] = location;\n        if (index < 0 || index >= node.children.length) {\n            throw new Error('Invalid location');\n        }\n        const child = node.children[index];\n        path.push(node);\n        return this.getNode(rest, child, path);\n    }\n}\n","export const PROPERTY_KEYS_GRIDVIEW = (() => {\n    /**\n     * by readong the keys from an empty value object TypeScript will error\n     * when we add or remove new properties to `DockviewOptions`\n     */\n    const properties = {\n        disableAutoResizing: undefined,\n        proportionalLayout: undefined,\n        orientation: undefined,\n        hideBorders: undefined,\n        className: undefined,\n    };\n    return Object.keys(properties);\n})();\n","import { isInDocument, watchElementResize } from './dom';\nimport { CompositeDisposable } from './lifecycle';\nexport class Resizable extends CompositeDisposable {\n    get element() {\n        return this._element;\n    }\n    get disableResizing() {\n        return this._disableResizing;\n    }\n    set disableResizing(value) {\n        this._disableResizing = value;\n    }\n    constructor(parentElement, disableResizing = false) {\n        super();\n        this._disableResizing = disableResizing;\n        this._element = parentElement;\n        this.addDisposables(watchElementResize(this._element, (entry) => {\n            if (this.isDisposed) {\n                /**\n                 * resize is delayed through requestAnimationFrame so there is a small chance\n                 * the component has already been disposed of\n                 */\n                return;\n            }\n            if (this.disableResizing) {\n                return;\n            }\n            if (!this._element.offsetParent) {\n                /**\n                 * offsetParent === null is equivalent to display: none being set on the element or one\n                 * of it's parents. In the display: none case the size will become (0, 0) which we do\n                 * not want to propagate.\n                 *\n                 * @see https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetParent\n                 *\n                 * You could use checkVisibility() but at the time of writing it's not supported across\n                 * all Browsers\n                 *\n                 * @see https://developer.mozilla.org/en-US/docs/Web/API/Element/checkVisibility\n                 */\n                return;\n            }\n            if (!isInDocument(this._element)) {\n                /**\n                 * since the event is dispatched through requestAnimationFrame there is a small chance\n                 * the component is no longer attached to the DOM, if that is the case the dimensions\n                 * are mostly likely all zero and meaningless. we should skip this case.\n                 */\n                return;\n            }\n            const { width, height } = entry.contentRect;\n            this.layout(width, height);\n        }));\n    }\n}\n","import { Emitter, Event, AsapEvent } from '../events';\nimport { getGridLocation, Gridview } from './gridview';\nimport { Disposable } from '../lifecycle';\nimport { sequentialNumberGenerator } from '../math';\nimport { Sizing } from '../splitview/splitview';\nimport { Resizable } from '../resizable';\nimport { Classnames } from '../dom';\nconst nextLayoutId = sequentialNumberGenerator();\nexport function toTarget(direction) {\n    switch (direction) {\n        case 'left':\n            return 'left';\n        case 'right':\n            return 'right';\n        case 'above':\n            return 'top';\n        case 'below':\n            return 'bottom';\n        case 'within':\n        default:\n            return 'center';\n    }\n}\nexport class BaseGrid extends Resizable {\n    get id() {\n        return this._id;\n    }\n    get size() {\n        return this._groups.size;\n    }\n    get groups() {\n        return Array.from(this._groups.values()).map((_) => _.value);\n    }\n    get width() {\n        return this.gridview.width;\n    }\n    get height() {\n        return this.gridview.height;\n    }\n    get minimumHeight() {\n        return this.gridview.minimumHeight;\n    }\n    get maximumHeight() {\n        return this.gridview.maximumHeight;\n    }\n    get minimumWidth() {\n        return this.gridview.minimumWidth;\n    }\n    get maximumWidth() {\n        return this.gridview.maximumWidth;\n    }\n    get activeGroup() {\n        return this._activeGroup;\n    }\n    get locked() {\n        return this.gridview.locked;\n    }\n    set locked(value) {\n        this.gridview.locked = value;\n    }\n    constructor(container, options) {\n        var _a;\n        super(document.createElement('div'), options.disableAutoResizing);\n        this._id = nextLayoutId.next();\n        this._groups = new Map();\n        this._onDidRemove = new Emitter();\n        this.onDidRemove = this._onDidRemove.event;\n        this._onDidAdd = new Emitter();\n        this.onDidAdd = this._onDidAdd.event;\n        this._onDidMaximizedChange = new Emitter();\n        this.onDidMaximizedChange = this._onDidMaximizedChange.event;\n        this._onDidActiveChange = new Emitter();\n        this.onDidActiveChange = this._onDidActiveChange.event;\n        this._bufferOnDidLayoutChange = new AsapEvent();\n        this.onDidLayoutChange = this._bufferOnDidLayoutChange.onEvent;\n        this._onDidViewVisibilityChangeMicroTaskQueue = new AsapEvent();\n        this.onDidViewVisibilityChangeMicroTaskQueue = this._onDidViewVisibilityChangeMicroTaskQueue.onEvent;\n        this.element.style.height = '100%';\n        this.element.style.width = '100%';\n        this._classNames = new Classnames(this.element);\n        this._classNames.setClassNames((_a = options.className) !== null && _a !== void 0 ? _a : '');\n        // the container is owned by the third-party, do not modify/delete it\n        container.appendChild(this.element);\n        this.gridview = new Gridview(!!options.proportionalLayout, options.styles, options.orientation, options.locked, options.margin);\n        this.gridview.locked = !!options.locked;\n        this.element.appendChild(this.gridview.element);\n        this.layout(0, 0, true); // set some elements height/widths\n        this.addDisposables(this.gridview.onDidMaximizedNodeChange((event) => {\n            this._onDidMaximizedChange.fire({\n                panel: event.view,\n                isMaximized: event.isMaximized,\n            });\n        }), this.gridview.onDidViewVisibilityChange(() => this._onDidViewVisibilityChangeMicroTaskQueue.fire()), this.onDidViewVisibilityChangeMicroTaskQueue(() => {\n            this.layout(this.width, this.height, true);\n        }), Disposable.from(() => {\n            var _a;\n            (_a = this.element.parentElement) === null || _a === void 0 ? void 0 : _a.removeChild(this.element);\n        }), this.gridview.onDidChange(() => {\n            this._bufferOnDidLayoutChange.fire();\n        }), Event.any(this.onDidAdd, this.onDidRemove, this.onDidActiveChange)(() => {\n            this._bufferOnDidLayoutChange.fire();\n        }), this._onDidMaximizedChange, this._onDidViewVisibilityChangeMicroTaskQueue, this._bufferOnDidLayoutChange);\n    }\n    setVisible(panel, visible) {\n        this.gridview.setViewVisible(getGridLocation(panel.element), visible);\n        this._bufferOnDidLayoutChange.fire();\n    }\n    isVisible(panel) {\n        return this.gridview.isViewVisible(getGridLocation(panel.element));\n    }\n    updateOptions(options) {\n        var _a, _b, _c, _d;\n        if (typeof options.proportionalLayout === 'boolean') {\n            // this.gridview.proportionalLayout = options.proportionalLayout; // not supported\n        }\n        if (options.orientation) {\n            this.gridview.orientation = options.orientation;\n        }\n        if ('styles' in options) {\n            // this.gridview.styles = options.styles; // not supported\n        }\n        if ('disableResizing' in options) {\n            this.disableResizing = (_a = options.disableAutoResizing) !== null && _a !== void 0 ? _a : false;\n        }\n        if ('locked' in options) {\n            this.locked = (_b = options.locked) !== null && _b !== void 0 ? _b : false;\n        }\n        if ('margin' in options) {\n            this.gridview.margin = (_c = options.margin) !== null && _c !== void 0 ? _c : 0;\n        }\n        if ('className' in options) {\n            this._classNames.setClassNames((_d = options.className) !== null && _d !== void 0 ? _d : '');\n        }\n    }\n    maximizeGroup(panel) {\n        this.gridview.maximizeView(panel);\n        this.doSetGroupActive(panel);\n    }\n    isMaximizedGroup(panel) {\n        return this.gridview.maximizedView() === panel;\n    }\n    exitMaximizedGroup() {\n        this.gridview.exitMaximizedView();\n    }\n    hasMaximizedGroup() {\n        return this.gridview.hasMaximizedView();\n    }\n    doAddGroup(group, location = [0], size) {\n        this.gridview.addView(group, size !== null && size !== void 0 ? size : Sizing.Distribute, location);\n        this._onDidAdd.fire(group);\n    }\n    doRemoveGroup(group, options) {\n        if (!this._groups.has(group.id)) {\n            throw new Error('invalid operation');\n        }\n        const item = this._groups.get(group.id);\n        const view = this.gridview.remove(group, Sizing.Distribute);\n        if (item && !(options === null || options === void 0 ? void 0 : options.skipDispose)) {\n            item.disposable.dispose();\n            item.value.dispose();\n            this._groups.delete(group.id);\n            this._onDidRemove.fire(group);\n        }\n        if (!(options === null || options === void 0 ? void 0 : options.skipActive) && this._activeGroup === group) {\n            const groups = Array.from(this._groups.values());\n            this.doSetGroupActive(groups.length > 0 ? groups[0].value : undefined);\n        }\n        return view;\n    }\n    getPanel(id) {\n        var _a;\n        return (_a = this._groups.get(id)) === null || _a === void 0 ? void 0 : _a.value;\n    }\n    doSetGroupActive(group) {\n        if (this._activeGroup === group) {\n            return;\n        }\n        if (this._activeGroup) {\n            this._activeGroup.setActive(false);\n        }\n        if (group) {\n            group.setActive(true);\n        }\n        this._activeGroup = group;\n        this._onDidActiveChange.fire(group);\n    }\n    removeGroup(group) {\n        this.doRemoveGroup(group);\n    }\n    moveToNext(options) {\n        var _a;\n        if (!options) {\n            options = {};\n        }\n        if (!options.group) {\n            if (!this.activeGroup) {\n                return;\n            }\n            options.group = this.activeGroup;\n        }\n        const location = getGridLocation(options.group.element);\n        const next = (_a = this.gridview.next(location)) === null || _a === void 0 ? void 0 : _a.view;\n        this.doSetGroupActive(next);\n    }\n    moveToPrevious(options) {\n        var _a;\n        if (!options) {\n            options = {};\n        }\n        if (!options.group) {\n            if (!this.activeGroup) {\n                return;\n            }\n            options.group = this.activeGroup;\n        }\n        const location = getGridLocation(options.group.element);\n        const next = (_a = this.gridview.previous(location)) === null || _a === void 0 ? void 0 : _a.view;\n        this.doSetGroupActive(next);\n    }\n    layout(width, height, forceResize) {\n        const different = forceResize || width !== this.width || height !== this.height;\n        if (!different) {\n            return;\n        }\n        this.gridview.element.style.height = `${height}px`;\n        this.gridview.element.style.width = `${width}px`;\n        this.gridview.layout(width, height);\n    }\n    dispose() {\n        this._onDidActiveChange.dispose();\n        this._onDidAdd.dispose();\n        this._onDidRemove.dispose();\n        for (const group of this.groups) {\n            group.dispose();\n        }\n        this.gridview.dispose();\n        super.dispose();\n    }\n}\n","export class SplitviewApi {\n    /**\n     * The minimum size  the component can reach where size is measured in the direction of orientation provided.\n     */\n    get minimumSize() {\n        return this.component.minimumSize;\n    }\n    /**\n     * The maximum size the component can reach where size is measured in the direction of orientation provided.\n     */\n    get maximumSize() {\n        return this.component.maximumSize;\n    }\n    /**\n     * Width of the component.\n     */\n    get width() {\n        return this.component.width;\n    }\n    /**\n     * Height of the component.\n     */\n    get height() {\n        return this.component.height;\n    }\n    /**\n     * The current number of panels.\n     */\n    get length() {\n        return this.component.length;\n    }\n    /**\n     * The current orientation of the component.\n     */\n    get orientation() {\n        return this.component.orientation;\n    }\n    /**\n     * The list of current panels.\n     */\n    get panels() {\n        return this.component.panels;\n    }\n    /**\n     * Invoked after a layout is loaded through the `fromJSON` method.\n     */\n    get onDidLayoutFromJSON() {\n        return this.component.onDidLayoutFromJSON;\n    }\n    /**\n     * Invoked whenever any aspect of the layout changes.\n     * If listening to this event it may be worth debouncing ouputs.\n     */\n    get onDidLayoutChange() {\n        return this.component.onDidLayoutChange;\n    }\n    /**\n     * Invoked when a view is added.\n     */\n    get onDidAddView() {\n        return this.component.onDidAddView;\n    }\n    /**\n     * Invoked when a view is removed.\n     */\n    get onDidRemoveView() {\n        return this.component.onDidRemoveView;\n    }\n    constructor(component) {\n        this.component = component;\n    }\n    /**\n     * Removes an existing panel and optionally provide a `Sizing` method\n     * for the subsequent resize.\n     */\n    removePanel(panel, sizing) {\n        this.component.removePanel(panel, sizing);\n    }\n    /**\n     * Focus the component.\n     */\n    focus() {\n        this.component.focus();\n    }\n    /**\n     * Get the reference to a panel given it's `string` id.\n     */\n    getPanel(id) {\n        return this.component.getPanel(id);\n    }\n    /**\n     * Layout the panel with a width and height.\n     */\n    layout(width, height) {\n        return this.component.layout(width, height);\n    }\n    /**\n     * Add a new panel and return the created instance.\n     */\n    addPanel(options) {\n        return this.component.addPanel(options);\n    }\n    /**\n     * Move a panel given it's current and desired index.\n     */\n    movePanel(from, to) {\n        this.component.movePanel(from, to);\n    }\n    /**\n     * Deserialize a layout to built a splitivew.\n     */\n    fromJSON(data) {\n        this.component.fromJSON(data);\n    }\n    /** Serialize a layout */\n    toJSON() {\n        return this.component.toJSON();\n    }\n    /**\n     * Remove all panels and clear the component.\n     */\n    clear() {\n        this.component.clear();\n    }\n    /**\n     * Update configuratable options.\n     */\n    updateOptions(options) {\n        this.component.updateOptions(options);\n    }\n    /**\n     * Release resources and teardown component. Do not call when using framework versions of dockview.\n     */\n    dispose() {\n        this.component.dispose();\n    }\n}\nexport class PaneviewApi {\n    /**\n     * The minimum size  the component can reach where size is measured in the direction of orientation provided.\n     */\n    get minimumSize() {\n        return this.component.minimumSize;\n    }\n    /**\n     * The maximum size the component can reach where size is measured in the direction of orientation provided.\n     */\n    get maximumSize() {\n        return this.component.maximumSize;\n    }\n    /**\n     * Width of the component.\n     */\n    get width() {\n        return this.component.width;\n    }\n    /**\n     * Height of the component.\n     */\n    get height() {\n        return this.component.height;\n    }\n    /**\n     * All panel objects.\n     */\n    get panels() {\n        return this.component.panels;\n    }\n    /**\n     * Invoked when any layout change occures, an aggregation of many events.\n     */\n    get onDidLayoutChange() {\n        return this.component.onDidLayoutChange;\n    }\n    /**\n     * Invoked after a layout is deserialzied using the `fromJSON` method.\n     */\n    get onDidLayoutFromJSON() {\n        return this.component.onDidLayoutFromJSON;\n    }\n    /**\n     * Invoked when a panel is added. May be called multiple times when moving panels.\n     */\n    get onDidAddView() {\n        return this.component.onDidAddView;\n    }\n    /**\n     * Invoked when a panel is removed. May be called multiple times when moving panels.\n     */\n    get onDidRemoveView() {\n        return this.component.onDidRemoveView;\n    }\n    /**\n     * Invoked when a Drag'n'Drop event occurs that the component was unable to handle. Exposed for custom Drag'n'Drop functionality.\n     */\n    get onDidDrop() {\n        return this.component.onDidDrop;\n    }\n    get onUnhandledDragOverEvent() {\n        return this.component.onUnhandledDragOverEvent;\n    }\n    constructor(component) {\n        this.component = component;\n    }\n    /**\n     * Remove a panel given the panel object.\n     */\n    removePanel(panel) {\n        this.component.removePanel(panel);\n    }\n    /**\n     * Get a panel object given a `string` id. May return `undefined`.\n     */\n    getPanel(id) {\n        return this.component.getPanel(id);\n    }\n    /**\n     * Move a panel given it's current and desired index.\n     */\n    movePanel(from, to) {\n        this.component.movePanel(from, to);\n    }\n    /**\n     *  Focus the component. Will try to focus an active panel if one exists.\n     */\n    focus() {\n        this.component.focus();\n    }\n    /**\n     * Force resize the component to an exact width and height. Read about auto-resizing before using.\n     */\n    layout(width, height) {\n        this.component.layout(width, height);\n    }\n    /**\n     * Add a panel and return the created object.\n     */\n    addPanel(options) {\n        return this.component.addPanel(options);\n    }\n    /**\n     * Create a component from a serialized object.\n     */\n    fromJSON(data) {\n        this.component.fromJSON(data);\n    }\n    /**\n     * Create a serialized object of the current component.\n     */\n    toJSON() {\n        return this.component.toJSON();\n    }\n    /**\n     * Reset the component back to an empty and default state.\n     */\n    clear() {\n        this.component.clear();\n    }\n    /**\n     * Update configuratable options.\n     */\n    updateOptions(options) {\n        this.component.updateOptions(options);\n    }\n    /**\n     * Release resources and teardown component. Do not call when using framework versions of dockview.\n     */\n    dispose() {\n        this.component.dispose();\n    }\n}\nexport class GridviewApi {\n    /**\n     * Width of the component.\n     */\n    get width() {\n        return this.component.width;\n    }\n    /**\n     * Height of the component.\n     */\n    get height() {\n        return this.component.height;\n    }\n    /**\n     * Minimum height of the component.\n     */\n    get minimumHeight() {\n        return this.component.minimumHeight;\n    }\n    /**\n     * Maximum height of the component.\n     */\n    get maximumHeight() {\n        return this.component.maximumHeight;\n    }\n    /**\n     * Minimum width of the component.\n     */\n    get minimumWidth() {\n        return this.component.minimumWidth;\n    }\n    /**\n     * Maximum width of the component.\n     */\n    get maximumWidth() {\n        return this.component.maximumWidth;\n    }\n    /**\n     * Invoked when any layout change occures, an aggregation of many events.\n     */\n    get onDidLayoutChange() {\n        return this.component.onDidLayoutChange;\n    }\n    /**\n     * Invoked when a panel is added. May be called multiple times when moving panels.\n     */\n    get onDidAddPanel() {\n        return this.component.onDidAddGroup;\n    }\n    /**\n     * Invoked when a panel is removed. May be called multiple times when moving panels.\n     */\n    get onDidRemovePanel() {\n        return this.component.onDidRemoveGroup;\n    }\n    /**\n     * Invoked when the active panel changes. May be undefined if no panel is active.\n     */\n    get onDidActivePanelChange() {\n        return this.component.onDidActiveGroupChange;\n    }\n    /**\n     * Invoked after a layout is deserialzied using the `fromJSON` method.\n     */\n    get onDidLayoutFromJSON() {\n        return this.component.onDidLayoutFromJSON;\n    }\n    /**\n     * All panel objects.\n     */\n    get panels() {\n        return this.component.groups;\n    }\n    /**\n     * Current orientation. Can be changed after initialization.\n     */\n    get orientation() {\n        return this.component.orientation;\n    }\n    set orientation(value) {\n        this.component.updateOptions({ orientation: value });\n    }\n    constructor(component) {\n        this.component = component;\n    }\n    /**\n     *  Focus the component. Will try to focus an active panel if one exists.\n     */\n    focus() {\n        this.component.focus();\n    }\n    /**\n     * Force resize the component to an exact width and height. Read about auto-resizing before using.\n     */\n    layout(width, height, force = false) {\n        this.component.layout(width, height, force);\n    }\n    /**\n     * Add a panel and return the created object.\n     */\n    addPanel(options) {\n        return this.component.addPanel(options);\n    }\n    /**\n     * Remove a panel given the panel object.\n     */\n    removePanel(panel, sizing) {\n        this.component.removePanel(panel, sizing);\n    }\n    /**\n     * Move a panel in a particular direction relative to another panel.\n     */\n    movePanel(panel, options) {\n        this.component.movePanel(panel, options);\n    }\n    /**\n     * Get a panel object given a `string` id. May return `undefined`.\n     */\n    getPanel(id) {\n        return this.component.getPanel(id);\n    }\n    /**\n     * Create a component from a serialized object.\n     */\n    fromJSON(data) {\n        return this.component.fromJSON(data);\n    }\n    /**\n     * Create a serialized object of the current component.\n     */\n    toJSON() {\n        return this.component.toJSON();\n    }\n    /**\n     * Reset the component back to an empty and default state.\n     */\n    clear() {\n        this.component.clear();\n    }\n    updateOptions(options) {\n        this.component.updateOptions(options);\n    }\n    /**\n     * Release resources and teardown component. Do not call when using framework versions of dockview.\n     */\n    dispose() {\n        this.component.dispose();\n    }\n}\nexport class DockviewApi {\n    /**\n     * The unique identifier for this instance. Used to manage scope of Drag'n'Drop events.\n     */\n    get id() {\n        return this.component.id;\n    }\n    /**\n     * Width of the component.\n     */\n    get width() {\n        return this.component.width;\n    }\n    /**\n     * Height of the component.\n     */\n    get height() {\n        return this.component.height;\n    }\n    /**\n     * Minimum height of the component.\n     */\n    get minimumHeight() {\n        return this.component.minimumHeight;\n    }\n    /**\n     * Maximum height of the component.\n     */\n    get maximumHeight() {\n        return this.component.maximumHeight;\n    }\n    /**\n     * Minimum width of the component.\n     */\n    get minimumWidth() {\n        return this.component.minimumWidth;\n    }\n    /**\n     * Maximum width of the component.\n     */\n    get maximumWidth() {\n        return this.component.maximumWidth;\n    }\n    /**\n     * Total number of groups.\n     */\n    get size() {\n        return this.component.size;\n    }\n    /**\n     * Total number of panels.\n     */\n    get totalPanels() {\n        return this.component.totalPanels;\n    }\n    /**\n     * Invoked when the active group changes. May be undefined if no group is active.\n     */\n    get onDidActiveGroupChange() {\n        return this.component.onDidActiveGroupChange;\n    }\n    /**\n     * Invoked when a group is added. May be called multiple times when moving groups.\n     */\n    get onDidAddGroup() {\n        return this.component.onDidAddGroup;\n    }\n    /**\n     * Invoked when a group is removed. May be called multiple times when moving groups.\n     */\n    get onDidRemoveGroup() {\n        return this.component.onDidRemoveGroup;\n    }\n    /**\n     * Invoked when the active panel changes. May be undefined if no panel is active.\n     */\n    get onDidActivePanelChange() {\n        return this.component.onDidActivePanelChange;\n    }\n    /**\n     * Invoked when a panel is added. May be called multiple times when moving panels.\n     */\n    get onDidAddPanel() {\n        return this.component.onDidAddPanel;\n    }\n    /**\n     * Invoked when a panel is removed. May be called multiple times when moving panels.\n     */\n    get onDidRemovePanel() {\n        return this.component.onDidRemovePanel;\n    }\n    get onDidMovePanel() {\n        return this.component.onDidMovePanel;\n    }\n    /**\n     * Invoked after a layout is deserialzied using the `fromJSON` method.\n     */\n    get onDidLayoutFromJSON() {\n        return this.component.onDidLayoutFromJSON;\n    }\n    /**\n     * Invoked when any layout change occures, an aggregation of many events.\n     */\n    get onDidLayoutChange() {\n        return this.component.onDidLayoutChange;\n    }\n    /**\n     * Invoked when a Drag'n'Drop event occurs that the component was unable to handle. Exposed for custom Drag'n'Drop functionality.\n     */\n    get onDidDrop() {\n        return this.component.onDidDrop;\n    }\n    /**\n     * Invoked when a Drag'n'Drop event occurs but before dockview handles it giving the user an opportunity to intecept and\n     * prevent the event from occuring using the standard `preventDefault()` syntax.\n     *\n     * Preventing certain events may causes unexpected behaviours, use carefully.\n     */\n    get onWillDrop() {\n        return this.component.onWillDrop;\n    }\n    /**\n     * Invoked before an overlay is shown indicating a drop target.\n     *\n     * Calling `event.preventDefault()` will prevent the overlay being shown and prevent\n     * the any subsequent drop event.\n     */\n    get onWillShowOverlay() {\n        return this.component.onWillShowOverlay;\n    }\n    /**\n     * Invoked before a group is dragged.\n     *\n     * Calling `event.nativeEvent.preventDefault()` will prevent the group drag starting.\n     *\n     */\n    get onWillDragGroup() {\n        return this.component.onWillDragGroup;\n    }\n    /**\n     * Invoked before a panel is dragged.\n     *\n     * Calling `event.nativeEvent.preventDefault()` will prevent the panel drag starting.\n     */\n    get onWillDragPanel() {\n        return this.component.onWillDragPanel;\n    }\n    get onUnhandledDragOverEvent() {\n        return this.component.onUnhandledDragOverEvent;\n    }\n    get onDidPopoutGroupSizeChange() {\n        return this.component.onDidPopoutGroupSizeChange;\n    }\n    get onDidPopoutGroupPositionChange() {\n        return this.component.onDidPopoutGroupPositionChange;\n    }\n    get onDidOpenPopoutWindowFail() {\n        return this.component.onDidOpenPopoutWindowFail;\n    }\n    /**\n     * All panel objects.\n     */\n    get panels() {\n        return this.component.panels;\n    }\n    /**\n     * All group objects.\n     */\n    get groups() {\n        return this.component.groups;\n    }\n    /**\n     *  Active panel object.\n     */\n    get activePanel() {\n        return this.component.activePanel;\n    }\n    /**\n     * Active group object.\n     */\n    get activeGroup() {\n        return this.component.activeGroup;\n    }\n    constructor(component) {\n        this.component = component;\n    }\n    /**\n     *  Focus the component. Will try to focus an active panel if one exists.\n     */\n    focus() {\n        this.component.focus();\n    }\n    /**\n     * Get a panel object given a `string` id. May return `undefined`.\n     */\n    getPanel(id) {\n        return this.component.getGroupPanel(id);\n    }\n    /**\n     * Force resize the component to an exact width and height. Read about auto-resizing before using.\n     */\n    layout(width, height, force = false) {\n        this.component.layout(width, height, force);\n    }\n    /**\n     * Add a panel and return the created object.\n     */\n    addPanel(options) {\n        return this.component.addPanel(options);\n    }\n    /**\n     * Remove a panel given the panel object.\n     */\n    removePanel(panel) {\n        this.component.removePanel(panel);\n    }\n    /**\n     * Add a group and return the created object.\n     */\n    addGroup(options) {\n        return this.component.addGroup(options);\n    }\n    /**\n     * Close all groups and panels.\n     */\n    closeAllGroups() {\n        return this.component.closeAllGroups();\n    }\n    /**\n     * Remove a group and any panels within the group.\n     */\n    removeGroup(group) {\n        this.component.removeGroup(group);\n    }\n    /**\n     * Get a group object given a `string` id. May return undefined.\n     */\n    getGroup(id) {\n        return this.component.getPanel(id);\n    }\n    /**\n     * Add a floating group\n     */\n    addFloatingGroup(item, options) {\n        return this.component.addFloatingGroup(item, options);\n    }\n    /**\n     * Create a component from a serialized object.\n     */\n    fromJSON(data) {\n        this.component.fromJSON(data);\n    }\n    /**\n     * Create a serialized object of the current component.\n     */\n    toJSON() {\n        return this.component.toJSON();\n    }\n    /**\n     * Reset the component back to an empty and default state.\n     */\n    clear() {\n        this.component.clear();\n    }\n    /**\n     * Move the focus progmatically to the next panel or group.\n     */\n    moveToNext(options) {\n        this.component.moveToNext(options);\n    }\n    /**\n     * Move the focus progmatically to the previous panel or group.\n     */\n    moveToPrevious(options) {\n        this.component.moveToPrevious(options);\n    }\n    maximizeGroup(panel) {\n        this.component.maximizeGroup(panel.group);\n    }\n    hasMaximizedGroup() {\n        return this.component.hasMaximizedGroup();\n    }\n    exitMaximizedGroup() {\n        this.component.exitMaximizedGroup();\n    }\n    get onDidMaximizedGroupChange() {\n        return this.component.onDidMaximizedGroupChange;\n    }\n    /**\n     * Add a popout group in a new Window\n     */\n    addPopoutGroup(item, options) {\n        return this.component.addPopoutGroup(item, options);\n    }\n    updateOptions(options) {\n        this.component.updateOptions(options);\n    }\n    /**\n     * Release resources and teardown component. Do not call when using framework versions of dockview.\n     */\n    dispose() {\n        this.component.dispose();\n    }\n}\n","import { disableIframePointEvents } from '../dom';\nimport { addDisposableListener, Emitter } from '../events';\nimport { CompositeDisposable, MutableDisposable, } from '../lifecycle';\nexport class DragHandler extends CompositeDisposable {\n    constructor(el, disabled) {\n        super();\n        this.el = el;\n        this.disabled = disabled;\n        this.dataDisposable = new MutableDisposable();\n        this.pointerEventsDisposable = new MutableDisposable();\n        this._onDragStart = new Emitter();\n        this.onDragStart = this._onDragStart.event;\n        this.addDisposables(this._onDragStart, this.dataDisposable, this.pointerEventsDisposable);\n        this.configure();\n    }\n    setDisabled(disabled) {\n        this.disabled = disabled;\n    }\n    isCancelled(_event) {\n        return false;\n    }\n    configure() {\n        this.addDisposables(this._onDragStart, addDisposableListener(this.el, 'dragstart', (event) => {\n            if (event.defaultPrevented || this.isCancelled(event) || this.disabled) {\n                event.preventDefault();\n                return;\n            }\n            const iframes = disableIframePointEvents();\n            this.pointerEventsDisposable.value = {\n                dispose: () => {\n                    iframes.release();\n                },\n            };\n            this.el.classList.add('dv-dragged');\n            setTimeout(() => this.el.classList.remove('dv-dragged'), 0);\n            this.dataDisposable.value = this.getData(event);\n            this._onDragStart.fire(event);\n            if (event.dataTransfer) {\n                event.dataTransfer.effectAllowed = 'move';\n                const hasData = event.dataTransfer.items.length > 0;\n                if (!hasData) {\n                    /**\n                     * Although this is not used by dockview many third party dnd libraries will check\n                     * dataTransfer.types to determine valid drag events.\n                     *\n                     * For example: in react-dnd if dataTransfer.types is not set then the dragStart event will be cancelled\n                     * through .preventDefault(). Since this is applied globally to all drag events this would break dockviews\n                     * dnd logic. You can see the code at\n                 P    * https://github.com/react-dnd/react-dnd/blob/main/packages/backend-html5/src/HTML5BackendImpl.ts#L542\n                     */\n                    event.dataTransfer.setData('text/plain', '');\n                }\n            }\n        }), addDisposableListener(this.el, 'dragend', () => {\n            this.pointerEventsDisposable.dispose();\n            setTimeout(() => {\n                this.dataDisposable.dispose(); // allow the data to be read by other handlers before disposing\n            }, 0);\n        }));\n    }\n}\n","import { addDisposableListener } from '../events';\nimport { CompositeDisposable } from '../lifecycle';\nexport class DragAndDropObserver extends CompositeDisposable {\n    constructor(element, callbacks) {\n        super();\n        this.element = element;\n        this.callbacks = callbacks;\n        this.target = null;\n        this.registerListeners();\n    }\n    onDragEnter(e) {\n        this.target = e.target;\n        this.callbacks.onDragEnter(e);\n    }\n    onDragOver(e) {\n        e.preventDefault(); // needed so that the drop event fires (https://stackoverflow.com/questions/21339924/drop-event-not-firing-in-chrome)\n        if (this.callbacks.onDragOver) {\n            this.callbacks.onDragOver(e);\n        }\n    }\n    onDragLeave(e) {\n        if (this.target === e.target) {\n            this.target = null;\n            this.callbacks.onDragLeave(e);\n        }\n    }\n    onDragEnd(e) {\n        this.target = null;\n        this.callbacks.onDragEnd(e);\n    }\n    onDrop(e) {\n        this.callbacks.onDrop(e);\n    }\n    registerListeners() {\n        this.addDisposables(addDisposableListener(this.element, 'dragenter', (e) => {\n            this.onDragEnter(e);\n        }, true));\n        this.addDisposables(addDisposableListener(this.element, 'dragover', (e) => {\n            this.onDragOver(e);\n        }, true));\n        this.addDisposables(addDisposableListener(this.element, 'dragleave', (e) => {\n            this.onDragLeave(e);\n        }));\n        this.addDisposables(addDisposableListener(this.element, 'dragend', (e) => {\n            this.onDragEnd(e);\n        }));\n        this.addDisposables(addDisposableListener(this.element, 'drop', (e) => {\n            this.onDrop(e);\n        }));\n    }\n}\n","import { toggleClass } from '../dom';\nimport { DockviewEvent, Emitter } from '../events';\nimport { CompositeDisposable } from '../lifecycle';\nimport { DragAndDropObserver } from './dnd';\nimport { clamp } from '../math';\nfunction setGPUOptimizedBounds(element, bounds) {\n    const { top, left, width, height } = bounds;\n    const topPx = `${Math.round(top)}px`;\n    const leftPx = `${Math.round(left)}px`;\n    const widthPx = `${Math.round(width)}px`;\n    const heightPx = `${Math.round(height)}px`;\n    // Use traditional positioning but maintain GPU layer\n    element.style.top = topPx;\n    element.style.left = leftPx;\n    element.style.width = widthPx;\n    element.style.height = heightPx;\n    element.style.visibility = 'visible';\n    // Ensure GPU layer is maintained\n    if (!element.style.transform || element.style.transform === '') {\n        element.style.transform = 'translate3d(0, 0, 0)';\n    }\n}\nfunction setGPUOptimizedBoundsFromStrings(element, bounds) {\n    const { top, left, width, height } = bounds;\n    // Use traditional positioning but maintain GPU layer\n    element.style.top = top;\n    element.style.left = left;\n    element.style.width = width;\n    element.style.height = height;\n    element.style.visibility = 'visible';\n    // Ensure GPU layer is maintained\n    if (!element.style.transform || element.style.transform === '') {\n        element.style.transform = 'translate3d(0, 0, 0)';\n    }\n}\nfunction checkBoundsChanged(element, bounds) {\n    const { top, left, width, height } = bounds;\n    const topPx = `${Math.round(top)}px`;\n    const leftPx = `${Math.round(left)}px`;\n    const widthPx = `${Math.round(width)}px`;\n    const heightPx = `${Math.round(height)}px`;\n    // Check if position or size changed (back to traditional method)\n    return element.style.top !== topPx ||\n        element.style.left !== leftPx ||\n        element.style.width !== widthPx ||\n        element.style.height !== heightPx;\n}\nexport class WillShowOverlayEvent extends DockviewEvent {\n    get nativeEvent() {\n        return this.options.nativeEvent;\n    }\n    get position() {\n        return this.options.position;\n    }\n    constructor(options) {\n        super();\n        this.options = options;\n    }\n}\nexport function directionToPosition(direction) {\n    switch (direction) {\n        case 'above':\n            return 'top';\n        case 'below':\n            return 'bottom';\n        case 'left':\n            return 'left';\n        case 'right':\n            return 'right';\n        case 'within':\n            return 'center';\n        default:\n            throw new Error(`invalid direction '${direction}'`);\n    }\n}\nexport function positionToDirection(position) {\n    switch (position) {\n        case 'top':\n            return 'above';\n        case 'bottom':\n            return 'below';\n        case 'left':\n            return 'left';\n        case 'right':\n            return 'right';\n        case 'center':\n            return 'within';\n        default:\n            throw new Error(`invalid position '${position}'`);\n    }\n}\nconst DEFAULT_ACTIVATION_SIZE = {\n    value: 20,\n    type: 'percentage',\n};\nconst DEFAULT_SIZE = {\n    value: 50,\n    type: 'percentage',\n};\nconst SMALL_WIDTH_BOUNDARY = 100;\nconst SMALL_HEIGHT_BOUNDARY = 100;\nexport class Droptarget extends CompositeDisposable {\n    get disabled() {\n        return this._disabled;\n    }\n    set disabled(value) {\n        this._disabled = value;\n    }\n    get state() {\n        return this._state;\n    }\n    constructor(element, options) {\n        super();\n        this.element = element;\n        this.options = options;\n        this._onDrop = new Emitter();\n        this.onDrop = this._onDrop.event;\n        this._onWillShowOverlay = new Emitter();\n        this.onWillShowOverlay = this._onWillShowOverlay.event;\n        this._disabled = false;\n        // use a set to take advantage of #<set>.has\n        this._acceptedTargetZonesSet = new Set(this.options.acceptedTargetZones);\n        this.dnd = new DragAndDropObserver(this.element, {\n            onDragEnter: () => {\n                var _a, _b, _c;\n                (_c = (_b = (_a = this.options).getOverrideTarget) === null || _b === void 0 ? void 0 : _b.call(_a)) === null || _c === void 0 ? void 0 : _c.getElements();\n            },\n            onDragOver: (e) => {\n                var _a, _b, _c, _d, _e, _f, _g;\n                Droptarget.ACTUAL_TARGET = this;\n                const overrideTarget = (_b = (_a = this.options).getOverrideTarget) === null || _b === void 0 ? void 0 : _b.call(_a);\n                if (this._acceptedTargetZonesSet.size === 0) {\n                    if (overrideTarget) {\n                        return;\n                    }\n                    this.removeDropTarget();\n                    return;\n                }\n                const target = (_e = (_d = (_c = this.options).getOverlayOutline) === null || _d === void 0 ? void 0 : _d.call(_c)) !== null && _e !== void 0 ? _e : this.element;\n                const width = target.offsetWidth;\n                const height = target.offsetHeight;\n                if (width === 0 || height === 0) {\n                    return; // avoid div!0\n                }\n                const rect = e.currentTarget.getBoundingClientRect();\n                const x = ((_f = e.clientX) !== null && _f !== void 0 ? _f : 0) - rect.left;\n                const y = ((_g = e.clientY) !== null && _g !== void 0 ? _g : 0) - rect.top;\n                const quadrant = this.calculateQuadrant(this._acceptedTargetZonesSet, x, y, width, height);\n                /**\n                 * If the event has already been used by another DropTarget instance\n                 * then don't show a second drop target, only one target should be\n                 * active at any one time\n                 */\n                if (this.isAlreadyUsed(e) || quadrant === null) {\n                    // no drop target should be displayed\n                    this.removeDropTarget();\n                    return;\n                }\n                if (!this.options.canDisplayOverlay(e, quadrant)) {\n                    if (overrideTarget) {\n                        return;\n                    }\n                    this.removeDropTarget();\n                    return;\n                }\n                const willShowOverlayEvent = new WillShowOverlayEvent({\n                    nativeEvent: e,\n                    position: quadrant,\n                });\n                /**\n                 * Provide an opportunity to prevent the overlay appearing and in turn\n                 * any dnd behaviours\n                 */\n                this._onWillShowOverlay.fire(willShowOverlayEvent);\n                if (willShowOverlayEvent.defaultPrevented) {\n                    this.removeDropTarget();\n                    return;\n                }\n                this.markAsUsed(e);\n                if (overrideTarget) {\n                    //\n                }\n                else if (!this.targetElement) {\n                    this.targetElement = document.createElement('div');\n                    this.targetElement.className = 'dv-drop-target-dropzone';\n                    this.overlayElement = document.createElement('div');\n                    this.overlayElement.className = 'dv-drop-target-selection';\n                    this._state = 'center';\n                    this.targetElement.appendChild(this.overlayElement);\n                    target.classList.add('dv-drop-target');\n                    target.append(this.targetElement);\n                    // this.overlayElement.style.opacity = '0';\n                    // requestAnimationFrame(() => {\n                    //     if (this.overlayElement) {\n                    //         this.overlayElement.style.opacity = '';\n                    //     }\n                    // });\n                }\n                this.toggleClasses(quadrant, width, height);\n                this._state = quadrant;\n            },\n            onDragLeave: () => {\n                var _a, _b;\n                const target = (_b = (_a = this.options).getOverrideTarget) === null || _b === void 0 ? void 0 : _b.call(_a);\n                if (target) {\n                    return;\n                }\n                this.removeDropTarget();\n            },\n            onDragEnd: (e) => {\n                var _a, _b;\n                const target = (_b = (_a = this.options).getOverrideTarget) === null || _b === void 0 ? void 0 : _b.call(_a);\n                if (target && Droptarget.ACTUAL_TARGET === this) {\n                    if (this._state) {\n                        // only stop the propagation of the event if we are dealing with it\n                        // which is only when the target has state\n                        e.stopPropagation();\n                        this._onDrop.fire({\n                            position: this._state,\n                            nativeEvent: e,\n                        });\n                    }\n                }\n                this.removeDropTarget();\n                target === null || target === void 0 ? void 0 : target.clear();\n            },\n            onDrop: (e) => {\n                var _a, _b, _c;\n                e.preventDefault();\n                const state = this._state;\n                this.removeDropTarget();\n                (_c = (_b = (_a = this.options).getOverrideTarget) === null || _b === void 0 ? void 0 : _b.call(_a)) === null || _c === void 0 ? void 0 : _c.clear();\n                if (state) {\n                    // only stop the propagation of the event if we are dealing with it\n                    // which is only when the target has state\n                    e.stopPropagation();\n                    this._onDrop.fire({ position: state, nativeEvent: e });\n                }\n            },\n        });\n        this.addDisposables(this._onDrop, this._onWillShowOverlay, this.dnd);\n    }\n    setTargetZones(acceptedTargetZones) {\n        this._acceptedTargetZonesSet = new Set(acceptedTargetZones);\n    }\n    setOverlayModel(model) {\n        this.options.overlayModel = model;\n    }\n    dispose() {\n        this.removeDropTarget();\n        super.dispose();\n    }\n    /**\n     * Add a property to the event object for other potential listeners to check\n     */\n    markAsUsed(event) {\n        event[Droptarget.USED_EVENT_ID] = true;\n    }\n    /**\n     * Check is the event has already been used by another instance of DropTarget\n     */\n    isAlreadyUsed(event) {\n        const value = event[Droptarget.USED_EVENT_ID];\n        return typeof value === 'boolean' && value;\n    }\n    toggleClasses(quadrant, width, height) {\n        var _a, _b, _c, _d, _e, _f, _g;\n        const target = (_b = (_a = this.options).getOverrideTarget) === null || _b === void 0 ? void 0 : _b.call(_a);\n        if (!target && !this.overlayElement) {\n            return;\n        }\n        const isSmallX = width < SMALL_WIDTH_BOUNDARY;\n        const isSmallY = height < SMALL_HEIGHT_BOUNDARY;\n        const isLeft = quadrant === 'left';\n        const isRight = quadrant === 'right';\n        const isTop = quadrant === 'top';\n        const isBottom = quadrant === 'bottom';\n        const rightClass = !isSmallX && isRight;\n        const leftClass = !isSmallX && isLeft;\n        const topClass = !isSmallY && isTop;\n        const bottomClass = !isSmallY && isBottom;\n        let size = 1;\n        const sizeOptions = (_d = (_c = this.options.overlayModel) === null || _c === void 0 ? void 0 : _c.size) !== null && _d !== void 0 ? _d : DEFAULT_SIZE;\n        if (sizeOptions.type === 'percentage') {\n            size = clamp(sizeOptions.value, 0, 100) / 100;\n        }\n        else {\n            if (rightClass || leftClass) {\n                size = clamp(0, sizeOptions.value, width) / width;\n            }\n            if (topClass || bottomClass) {\n                size = clamp(0, sizeOptions.value, height) / height;\n            }\n        }\n        if (target) {\n            const outlineEl = (_g = (_f = (_e = this.options).getOverlayOutline) === null || _f === void 0 ? void 0 : _f.call(_e)) !== null && _g !== void 0 ? _g : this.element;\n            const elBox = outlineEl.getBoundingClientRect();\n            const ta = target.getElements(undefined, outlineEl);\n            const el = ta.root;\n            const overlay = ta.overlay;\n            const bigbox = el.getBoundingClientRect();\n            const rootTop = elBox.top - bigbox.top;\n            const rootLeft = elBox.left - bigbox.left;\n            const box = {\n                top: rootTop,\n                left: rootLeft,\n                width: width,\n                height: height,\n            };\n            if (rightClass) {\n                box.left = rootLeft + width * (1 - size);\n                box.width = width * size;\n            }\n            else if (leftClass) {\n                box.width = width * size;\n            }\n            else if (topClass) {\n                box.height = height * size;\n            }\n            else if (bottomClass) {\n                box.top = rootTop + height * (1 - size);\n                box.height = height * size;\n            }\n            if (isSmallX && isLeft) {\n                box.width = 4;\n            }\n            if (isSmallX && isRight) {\n                box.left = rootLeft + width - 4;\n                box.width = 4;\n            }\n            // Use GPU-optimized bounds checking and setting\n            if (!checkBoundsChanged(overlay, box)) {\n                return;\n            }\n            setGPUOptimizedBounds(overlay, box);\n            overlay.className = `dv-drop-target-anchor${this.options.className ? ` ${this.options.className}` : ''}`;\n            toggleClass(overlay, 'dv-drop-target-left', isLeft);\n            toggleClass(overlay, 'dv-drop-target-right', isRight);\n            toggleClass(overlay, 'dv-drop-target-top', isTop);\n            toggleClass(overlay, 'dv-drop-target-bottom', isBottom);\n            toggleClass(overlay, 'dv-drop-target-center', quadrant === 'center');\n            if (ta.changed) {\n                toggleClass(overlay, 'dv-drop-target-anchor-container-changed', true);\n                setTimeout(() => {\n                    toggleClass(overlay, 'dv-drop-target-anchor-container-changed', false);\n                }, 10);\n            }\n            return;\n        }\n        if (!this.overlayElement) {\n            return;\n        }\n        const box = { top: '0px', left: '0px', width: '100%', height: '100%' };\n        /**\n         * You can also achieve the overlay placement using the transform CSS property\n         * to translate and scale the element however this has the undesired effect of\n         * 'skewing' the element. Comment left here for anybody that ever revisits this.\n         *\n         * @see https://developer.mozilla.org/en-US/docs/Web/CSS/transform\n         *\n         * right\n         * translateX(${100 * (1 - size) / 2}%) scaleX(${scale})\n         *\n         * left\n         * translateX(-${100 * (1 - size) / 2}%) scaleX(${scale})\n         *\n         * top\n         * translateY(-${100 * (1 - size) / 2}%) scaleY(${scale})\n         *\n         * bottom\n         * translateY(${100 * (1 - size) / 2}%) scaleY(${scale})\n         */\n        if (rightClass) {\n            box.left = `${100 * (1 - size)}%`;\n            box.width = `${100 * size}%`;\n        }\n        else if (leftClass) {\n            box.width = `${100 * size}%`;\n        }\n        else if (topClass) {\n            box.height = `${100 * size}%`;\n        }\n        else if (bottomClass) {\n            box.top = `${100 * (1 - size)}%`;\n            box.height = `${100 * size}%`;\n        }\n        setGPUOptimizedBoundsFromStrings(this.overlayElement, box);\n        toggleClass(this.overlayElement, 'dv-drop-target-small-vertical', isSmallY);\n        toggleClass(this.overlayElement, 'dv-drop-target-small-horizontal', isSmallX);\n        toggleClass(this.overlayElement, 'dv-drop-target-left', isLeft);\n        toggleClass(this.overlayElement, 'dv-drop-target-right', isRight);\n        toggleClass(this.overlayElement, 'dv-drop-target-top', isTop);\n        toggleClass(this.overlayElement, 'dv-drop-target-bottom', isBottom);\n        toggleClass(this.overlayElement, 'dv-drop-target-center', quadrant === 'center');\n    }\n    calculateQuadrant(overlayType, x, y, width, height) {\n        var _a, _b;\n        const activationSizeOptions = (_b = (_a = this.options.overlayModel) === null || _a === void 0 ? void 0 : _a.activationSize) !== null && _b !== void 0 ? _b : DEFAULT_ACTIVATION_SIZE;\n        const isPercentage = activationSizeOptions.type === 'percentage';\n        if (isPercentage) {\n            return calculateQuadrantAsPercentage(overlayType, x, y, width, height, activationSizeOptions.value);\n        }\n        return calculateQuadrantAsPixels(overlayType, x, y, width, height, activationSizeOptions.value);\n    }\n    removeDropTarget() {\n        var _a;\n        if (this.targetElement) {\n            this._state = undefined;\n            (_a = this.targetElement.parentElement) === null || _a === void 0 ? void 0 : _a.classList.remove('dv-drop-target');\n            this.targetElement.remove();\n            this.targetElement = undefined;\n            this.overlayElement = undefined;\n        }\n    }\n}\nDroptarget.USED_EVENT_ID = '__dockview_droptarget_event_is_used__';\nexport function calculateQuadrantAsPercentage(overlayType, x, y, width, height, threshold) {\n    const xp = (100 * x) / width;\n    const yp = (100 * y) / height;\n    if (overlayType.has('left') && xp < threshold) {\n        return 'left';\n    }\n    if (overlayType.has('right') && xp > 100 - threshold) {\n        return 'right';\n    }\n    if (overlayType.has('top') && yp < threshold) {\n        return 'top';\n    }\n    if (overlayType.has('bottom') && yp > 100 - threshold) {\n        return 'bottom';\n    }\n    if (!overlayType.has('center')) {\n        return null;\n    }\n    return 'center';\n}\nexport function calculateQuadrantAsPixels(overlayType, x, y, width, height, threshold) {\n    if (overlayType.has('left') && x < threshold) {\n        return 'left';\n    }\n    if (overlayType.has('right') && x > width - threshold) {\n        return 'right';\n    }\n    if (overlayType.has('top') && y < threshold) {\n        return 'top';\n    }\n    if (overlayType.has('bottom') && y > height - threshold) {\n        return 'bottom';\n    }\n    if (!overlayType.has('center')) {\n        return null;\n    }\n    return 'center';\n}\n","import { AcceptableEvent } from '../events';\nexport const PROPERTY_KEYS_PANEVIEW = (() => {\n    /**\n     * by readong the keys from an empty value object TypeScript will error\n     * when we add or remove new properties to `DockviewOptions`\n     */\n    const properties = {\n        disableAutoResizing: undefined,\n        disableDnd: undefined,\n        className: undefined,\n    };\n    return Object.keys(properties);\n})();\nexport class PaneviewUnhandledDragOverEvent extends AcceptableEvent {\n    constructor(nativeEvent, position, getData, panel) {\n        super();\n        this.nativeEvent = nativeEvent;\n        this.position = position;\n        this.getData = getData;\n        this.panel = panel;\n    }\n}\n","import { DockviewEvent, Emitter } from '../events';\nimport { CompositeDisposable, MutableDisposable } from '../lifecycle';\nexport class WillFocusEvent extends DockviewEvent {\n    constructor() {\n        super();\n    }\n}\n/**\n * A core api implementation that should be used across all panel-like objects\n */\nexport class PanelApiImpl extends CompositeDisposable {\n    get isFocused() {\n        return this._isFocused;\n    }\n    get isActive() {\n        return this._isActive;\n    }\n    get isVisible() {\n        return this._isVisible;\n    }\n    get width() {\n        return this._width;\n    }\n    get height() {\n        return this._height;\n    }\n    constructor(id, component) {\n        super();\n        this.id = id;\n        this.component = component;\n        this._isFocused = false;\n        this._isActive = false;\n        this._isVisible = true;\n        this._width = 0;\n        this._height = 0;\n        this._parameters = {};\n        this.panelUpdatesDisposable = new MutableDisposable();\n        this._onDidDimensionChange = new Emitter();\n        this.onDidDimensionsChange = this._onDidDimensionChange.event;\n        this._onDidChangeFocus = new Emitter();\n        this.onDidFocusChange = this._onDidChangeFocus.event;\n        //\n        this._onWillFocus = new Emitter();\n        this.onWillFocus = this._onWillFocus.event;\n        //\n        this._onDidVisibilityChange = new Emitter();\n        this.onDidVisibilityChange = this._onDidVisibilityChange.event;\n        this._onWillVisibilityChange = new Emitter();\n        this.onWillVisibilityChange = this._onWillVisibilityChange.event;\n        this._onDidActiveChange = new Emitter();\n        this.onDidActiveChange = this._onDidActiveChange.event;\n        this._onActiveChange = new Emitter();\n        this.onActiveChange = this._onActiveChange.event;\n        this._onDidParametersChange = new Emitter();\n        this.onDidParametersChange = this._onDidParametersChange.event;\n        this.addDisposables(this.onDidFocusChange((event) => {\n            this._isFocused = event.isFocused;\n        }), this.onDidActiveChange((event) => {\n            this._isActive = event.isActive;\n        }), this.onDidVisibilityChange((event) => {\n            this._isVisible = event.isVisible;\n        }), this.onDidDimensionsChange((event) => {\n            this._width = event.width;\n            this._height = event.height;\n        }), this.panelUpdatesDisposable, this._onDidDimensionChange, this._onDidChangeFocus, this._onDidVisibilityChange, this._onDidActiveChange, this._onWillFocus, this._onActiveChange, this._onWillFocus, this._onWillVisibilityChange, this._onDidParametersChange);\n    }\n    getParameters() {\n        return this._parameters;\n    }\n    initialize(panel) {\n        this.panelUpdatesDisposable.value = this._onDidParametersChange.event((parameters) => {\n            this._parameters = parameters;\n            panel.update({\n                params: parameters,\n            });\n        });\n    }\n    setVisible(isVisible) {\n        this._onWillVisibilityChange.fire({ isVisible });\n    }\n    setActive() {\n        this._onActiveChange.fire();\n    }\n    updateParameters(parameters) {\n        this._onDidParametersChange.fire(parameters);\n    }\n}\n","import { Emitter } from '../events';\nimport { PanelApiImpl } from './panelApi';\nexport class SplitviewPanelApiImpl extends PanelApiImpl {\n    //\n    constructor(id, component) {\n        super(id, component);\n        this._onDidConstraintsChangeInternal = new Emitter();\n        this.onDidConstraintsChangeInternal = this._onDidConstraintsChangeInternal.event;\n        //\n        this._onDidConstraintsChange = new Emitter({\n            replay: true,\n        });\n        this.onDidConstraintsChange = this._onDidConstraintsChange.event;\n        //\n        this._onDidSizeChange = new Emitter();\n        this.onDidSizeChange = this._onDidSizeChange.event;\n        this.addDisposables(this._onDidConstraintsChangeInternal, this._onDidConstraintsChange, this._onDidSizeChange);\n    }\n    setConstraints(value) {\n        this._onDidConstraintsChangeInternal.fire(value);\n    }\n    setSize(event) {\n        this._onDidSizeChange.fire(event);\n    }\n}\n","import { Emitter } from '../events';\nimport { SplitviewPanelApiImpl } from './splitviewPanelApi';\nexport class PaneviewPanelApiImpl extends SplitviewPanelApiImpl {\n    set pane(pane) {\n        this._pane = pane;\n    }\n    constructor(id, component) {\n        super(id, component);\n        this._onDidExpansionChange = new Emitter({\n            replay: true,\n        });\n        this.onDidExpansionChange = this._onDidExpansionChange.event;\n        this._onMouseEnter = new Emitter({});\n        this.onMouseEnter = this._onMouseEnter.event;\n        this._onMouseLeave = new Emitter({});\n        this.onMouseLeave = this._onMouseLeave.event;\n        this.addDisposables(this._onDidExpansionChange, this._onMouseEnter, this._onMouseLeave);\n    }\n    setExpanded(isExpanded) {\n        var _a;\n        (_a = this._pane) === null || _a === void 0 ? void 0 : _a.setExpanded(isExpanded);\n    }\n    get isExpanded() {\n        var _a;\n        return !!((_a = this._pane) === null || _a === void 0 ? void 0 : _a.isExpanded());\n    }\n}\n","import { trackFocus } from '../dom';\nimport { CompositeDisposable } from '../lifecycle';\nimport { WillFocusEvent } from '../api/panelApi';\nexport class BasePanelView extends CompositeDisposable {\n    get element() {\n        return this._element;\n    }\n    get width() {\n        return this._width;\n    }\n    get height() {\n        return this._height;\n    }\n    get params() {\n        var _a;\n        return (_a = this._params) === null || _a === void 0 ? void 0 : _a.params;\n    }\n    constructor(id, component, api) {\n        super();\n        this.id = id;\n        this.component = component;\n        this.api = api;\n        this._height = 0;\n        this._width = 0;\n        this._element = document.createElement('div');\n        this._element.tabIndex = -1;\n        this._element.style.outline = 'none';\n        this._element.style.height = '100%';\n        this._element.style.width = '100%';\n        this._element.style.overflow = 'hidden';\n        const focusTracker = trackFocus(this._element);\n        this.addDisposables(this.api, focusTracker.onDidFocus(() => {\n            this.api._onDidChangeFocus.fire({ isFocused: true });\n        }), focusTracker.onDidBlur(() => {\n            this.api._onDidChangeFocus.fire({ isFocused: false });\n        }), focusTracker);\n    }\n    focus() {\n        const event = new WillFocusEvent();\n        this.api._onWillFocus.fire(event);\n        if (event.defaultPrevented) {\n            return;\n        }\n        this._element.focus();\n    }\n    layout(width, height) {\n        this._width = width;\n        this._height = height;\n        this.api._onDidDimensionChange.fire({ width, height });\n        if (this.part) {\n            if (this._params) {\n                this.part.update(this._params.params);\n            }\n        }\n    }\n    init(parameters) {\n        this._params = parameters;\n        this.part = this.getComponent();\n    }\n    update(event) {\n        var _a, _b;\n        // merge the new parameters with the existing parameters\n        this._params = Object.assign(Object.assign({}, this._params), { params: Object.assign(Object.assign({}, (_a = this._params) === null || _a === void 0 ? void 0 : _a.params), event.params) });\n        /**\n         * delete new keys that have a value of undefined,\n         * allow values of null\n         */\n        for (const key of Object.keys(event.params)) {\n            if (event.params[key] === undefined) {\n                delete this._params.params[key];\n            }\n        }\n        // update the view with the updated props\n        (_b = this.part) === null || _b === void 0 ? void 0 : _b.update({ params: this._params.params });\n    }\n    toJSON() {\n        var _a, _b;\n        const params = (_b = (_a = this._params) === null || _a === void 0 ? void 0 : _a.params) !== null && _b !== void 0 ? _b : {};\n        return {\n            id: this.id,\n            component: this.component,\n            params: Object.keys(params).length > 0 ? params : undefined,\n        };\n    }\n    dispose() {\n        var _a;\n        this.api.dispose();\n        (_a = this.part) === null || _a === void 0 ? void 0 : _a.dispose();\n        super.dispose();\n    }\n}\n","import { PaneviewPanelApiImpl } from '../api/paneviewPanelApi';\nimport { addClasses, removeClasses } from '../dom';\nimport { addDisposableListener, Emitter } from '../events';\nimport { BasePanelView, } from '../gridview/basePanelView';\nimport { Orientation } from '../splitview/splitview';\nexport class PaneviewPanel extends BasePanelView {\n    set orientation(value) {\n        this._orientation = value;\n    }\n    get orientation() {\n        return this._orientation;\n    }\n    get minimumSize() {\n        const headerSize = this.headerSize;\n        const expanded = this.isExpanded();\n        const minimumBodySize = expanded ? this._minimumBodySize : 0;\n        return headerSize + minimumBodySize;\n    }\n    get maximumSize() {\n        const headerSize = this.headerSize;\n        const expanded = this.isExpanded();\n        const maximumBodySize = expanded ? this._maximumBodySize : 0;\n        return headerSize + maximumBodySize;\n    }\n    get size() {\n        return this._size;\n    }\n    get orthogonalSize() {\n        return this._orthogonalSize;\n    }\n    set orthogonalSize(size) {\n        this._orthogonalSize = size;\n    }\n    get minimumBodySize() {\n        return this._minimumBodySize;\n    }\n    set minimumBodySize(value) {\n        this._minimumBodySize = typeof value === 'number' ? value : 0;\n    }\n    get maximumBodySize() {\n        return this._maximumBodySize;\n    }\n    set maximumBodySize(value) {\n        this._maximumBodySize =\n            typeof value === 'number' ? value : Number.POSITIVE_INFINITY;\n    }\n    get headerVisible() {\n        return this._headerVisible;\n    }\n    set headerVisible(value) {\n        this._headerVisible = value;\n        this.header.style.display = value ? '' : 'none';\n    }\n    constructor(options) {\n        super(options.id, options.component, new PaneviewPanelApiImpl(options.id, options.component));\n        this._onDidChangeExpansionState = new Emitter({ replay: true });\n        this.onDidChangeExpansionState = this._onDidChangeExpansionState.event;\n        this._onDidChange = new Emitter();\n        this.onDidChange = this._onDidChange.event;\n        this._orthogonalSize = 0;\n        this._size = 0;\n        this._isExpanded = false;\n        this.api.pane = this; // TODO cannot use 'this' before 'super'\n        this.api.initialize(this);\n        this.headerSize = options.headerSize;\n        this.headerComponent = options.headerComponent;\n        this._minimumBodySize = options.minimumBodySize;\n        this._maximumBodySize = options.maximumBodySize;\n        this._isExpanded = options.isExpanded;\n        this._headerVisible = options.isHeaderVisible;\n        this._onDidChangeExpansionState.fire(this.isExpanded()); // initialize value\n        this._orientation = options.orientation;\n        this.element.classList.add('dv-pane');\n        this.addDisposables(this.api.onWillVisibilityChange((event) => {\n            const { isVisible } = event;\n            const { accessor } = this._params;\n            accessor.setVisible(this, isVisible);\n        }), this.api.onDidSizeChange((event) => {\n            this._onDidChange.fire({ size: event.size });\n        }), addDisposableListener(this.element, 'mouseenter', (ev) => {\n            this.api._onMouseEnter.fire(ev);\n        }), addDisposableListener(this.element, 'mouseleave', (ev) => {\n            this.api._onMouseLeave.fire(ev);\n        }));\n        this.addDisposables(this._onDidChangeExpansionState, this.onDidChangeExpansionState((isPanelExpanded) => {\n            this.api._onDidExpansionChange.fire({\n                isExpanded: isPanelExpanded,\n            });\n        }), this.api.onDidFocusChange((e) => {\n            if (!this.header) {\n                return;\n            }\n            if (e.isFocused) {\n                addClasses(this.header, 'focused');\n            }\n            else {\n                removeClasses(this.header, 'focused');\n            }\n        }));\n        this.renderOnce();\n    }\n    setVisible(isVisible) {\n        this.api._onDidVisibilityChange.fire({ isVisible });\n    }\n    setActive(isActive) {\n        this.api._onDidActiveChange.fire({ isActive });\n    }\n    isExpanded() {\n        return this._isExpanded;\n    }\n    setExpanded(expanded) {\n        if (this._isExpanded === expanded) {\n            return;\n        }\n        this._isExpanded = expanded;\n        if (expanded) {\n            if (this.animationTimer) {\n                clearTimeout(this.animationTimer);\n            }\n            if (this.body) {\n                this.element.appendChild(this.body);\n            }\n        }\n        else {\n            this.animationTimer = setTimeout(() => {\n                var _a;\n                (_a = this.body) === null || _a === void 0 ? void 0 : _a.remove();\n            }, 200);\n        }\n        this._onDidChange.fire(expanded ? { size: this.width } : {});\n        this._onDidChangeExpansionState.fire(expanded);\n    }\n    layout(size, orthogonalSize) {\n        this._size = size;\n        this._orthogonalSize = orthogonalSize;\n        const [width, height] = this.orientation === Orientation.HORIZONTAL\n            ? [size, orthogonalSize]\n            : [orthogonalSize, size];\n        super.layout(width, height);\n    }\n    init(parameters) {\n        var _a, _b;\n        super.init(parameters);\n        if (typeof parameters.minimumBodySize === 'number') {\n            this.minimumBodySize = parameters.minimumBodySize;\n        }\n        if (typeof parameters.maximumBodySize === 'number') {\n            this.maximumBodySize = parameters.maximumBodySize;\n        }\n        this.bodyPart = this.getBodyComponent();\n        this.headerPart = this.getHeaderComponent();\n        this.bodyPart.init(Object.assign(Object.assign({}, parameters), { api: this.api }));\n        this.headerPart.init(Object.assign(Object.assign({}, parameters), { api: this.api }));\n        (_a = this.body) === null || _a === void 0 ? void 0 : _a.append(this.bodyPart.element);\n        (_b = this.header) === null || _b === void 0 ? void 0 : _b.append(this.headerPart.element);\n        if (typeof parameters.isExpanded === 'boolean') {\n            this.setExpanded(parameters.isExpanded);\n        }\n    }\n    toJSON() {\n        const params = this._params;\n        return Object.assign(Object.assign({}, super.toJSON()), { headerComponent: this.headerComponent, title: params.title });\n    }\n    renderOnce() {\n        this.header = document.createElement('div');\n        this.header.tabIndex = 0;\n        this.header.className = 'dv-pane-header';\n        this.header.style.height = `${this.headerSize}px`;\n        this.header.style.lineHeight = `${this.headerSize}px`;\n        this.header.style.minHeight = `${this.headerSize}px`;\n        this.header.style.maxHeight = `${this.headerSize}px`;\n        this.element.appendChild(this.header);\n        this.body = document.createElement('div');\n        this.body.className = 'dv-pane-body';\n        this.element.appendChild(this.body);\n    }\n    // TODO slightly hacky by-pass of the component to create a body and header component\n    getComponent() {\n        return {\n            update: (params) => {\n                var _a, _b;\n                (_a = this.bodyPart) === null || _a === void 0 ? void 0 : _a.update({ params });\n                (_b = this.headerPart) === null || _b === void 0 ? void 0 : _b.update({ params });\n            },\n            dispose: () => {\n                var _a, _b;\n                (_a = this.bodyPart) === null || _a === void 0 ? void 0 : _a.dispose();\n                (_b = this.headerPart) === null || _b === void 0 ? void 0 : _b.dispose();\n            },\n        };\n    }\n}\n","import { PaneviewApi } from '../api/component.api';\nimport { DragHandler } from '../dnd/abstractDragHandler';\nimport { getPaneData, LocalSelectionTransfer, PaneTransfer, } from '../dnd/dataTransfer';\nimport { Droptarget } from '../dnd/droptarget';\nimport { Emitter } from '../events';\nimport { PaneviewUnhandledDragOverEvent, } from './options';\nimport { PaneviewPanel, } from './paneviewPanel';\nexport class DraggablePaneviewPanel extends PaneviewPanel {\n    constructor(options) {\n        super({\n            id: options.id,\n            component: options.component,\n            headerComponent: options.headerComponent,\n            orientation: options.orientation,\n            isExpanded: options.isExpanded,\n            isHeaderVisible: true,\n            headerSize: options.headerSize,\n            minimumBodySize: options.minimumBodySize,\n            maximumBodySize: options.maximumBodySize,\n        });\n        this._onDidDrop = new Emitter();\n        this.onDidDrop = this._onDidDrop.event;\n        this._onUnhandledDragOverEvent = new Emitter();\n        this.onUnhandledDragOverEvent = this._onUnhandledDragOverEvent.event;\n        this.accessor = options.accessor;\n        this.addDisposables(this._onDidDrop, this._onUnhandledDragOverEvent);\n        if (!options.disableDnd) {\n            this.initDragFeatures();\n        }\n    }\n    initDragFeatures() {\n        if (!this.header) {\n            return;\n        }\n        const id = this.id;\n        const accessorId = this.accessor.id;\n        this.header.draggable = true;\n        this.handler = new (class PaneDragHandler extends DragHandler {\n            getData() {\n                LocalSelectionTransfer.getInstance().setData([new PaneTransfer(accessorId, id)], PaneTransfer.prototype);\n                return {\n                    dispose: () => {\n                        LocalSelectionTransfer.getInstance().clearData(PaneTransfer.prototype);\n                    },\n                };\n            }\n        })(this.header);\n        this.target = new Droptarget(this.element, {\n            acceptedTargetZones: ['top', 'bottom'],\n            overlayModel: {\n                activationSize: { type: 'percentage', value: 50 },\n            },\n            canDisplayOverlay: (event, position) => {\n                const data = getPaneData();\n                if (data) {\n                    if (data.paneId !== this.id &&\n                        data.viewId === this.accessor.id) {\n                        return true;\n                    }\n                }\n                const firedEvent = new PaneviewUnhandledDragOverEvent(event, position, getPaneData, this);\n                this._onUnhandledDragOverEvent.fire(firedEvent);\n                return firedEvent.isAccepted;\n            },\n        });\n        this.addDisposables(this._onDidDrop, this.handler, this.target, this.target.onDrop((event) => {\n            this.onDrop(event);\n        }));\n    }\n    onDrop(event) {\n        const data = getPaneData();\n        if (!data || data.viewId !== this.accessor.id) {\n            // if there is no local drag event for this panel\n            // or if the drag event was creating by another Paneview instance\n            this._onDidDrop.fire(Object.assign(Object.assign({}, event), { panel: this, api: new PaneviewApi(this.accessor), getData: getPaneData }));\n            return;\n        }\n        const containerApi = this._params\n            .containerApi;\n        const panelId = data.paneId;\n        const existingPanel = containerApi.getPanel(panelId);\n        if (!existingPanel) {\n            // if the panel doesn't exist\n            this._onDidDrop.fire(Object.assign(Object.assign({}, event), { panel: this, getData: getPaneData, api: new PaneviewApi(this.accessor) }));\n            return;\n        }\n        const allPanels = containerApi.panels;\n        const fromIndex = allPanels.indexOf(existingPanel);\n        let toIndex = containerApi.panels.indexOf(this);\n        if (event.position === 'left' || event.position === 'top') {\n            toIndex = Math.max(0, toIndex - 1);\n        }\n        if (event.position === 'right' || event.position === 'bottom') {\n            if (fromIndex > toIndex) {\n                toIndex++;\n            }\n            toIndex = Math.min(allPanels.length - 1, toIndex);\n        }\n        containerApi.movePanel(fromIndex, toIndex);\n    }\n}\n","import { CompositeDisposable, MutableDisposable, } from '../../../lifecycle';\nimport { Emitter } from '../../../events';\nimport { trackFocus } from '../../../dom';\nimport { Droptarget } from '../../../dnd/droptarget';\nimport { getPanelData } from '../../../dnd/dataTransfer';\nexport class ContentContainer extends CompositeDisposable {\n    get element() {\n        return this._element;\n    }\n    constructor(accessor, group) {\n        super();\n        this.accessor = accessor;\n        this.group = group;\n        this.disposable = new MutableDisposable();\n        this._onDidFocus = new Emitter();\n        this.onDidFocus = this._onDidFocus.event;\n        this._onDidBlur = new Emitter();\n        this.onDidBlur = this._onDidBlur.event;\n        this._element = document.createElement('div');\n        this._element.className = 'dv-content-container';\n        this._element.tabIndex = -1;\n        this.addDisposables(this._onDidFocus, this._onDidBlur);\n        const target = group.dropTargetContainer;\n        this.dropTarget = new Droptarget(this.element, {\n            getOverlayOutline: () => {\n                var _a;\n                return ((_a = accessor.options.theme) === null || _a === void 0 ? void 0 : _a.dndPanelOverlay) === 'group'\n                    ? this.element.parentElement\n                    : null;\n            },\n            className: 'dv-drop-target-content',\n            acceptedTargetZones: ['top', 'bottom', 'left', 'right', 'center'],\n            canDisplayOverlay: (event, position) => {\n                if (this.group.locked === 'no-drop-target' ||\n                    (this.group.locked && position === 'center')) {\n                    return false;\n                }\n                const data = getPanelData();\n                if (!data &&\n                    event.shiftKey &&\n                    this.group.location.type !== 'floating') {\n                    return false;\n                }\n                if (data && data.viewId === this.accessor.id) {\n                    return true;\n                }\n                return this.group.canDisplayOverlay(event, position, 'content');\n            },\n            getOverrideTarget: target ? () => target.model : undefined,\n        });\n        this.addDisposables(this.dropTarget);\n    }\n    show() {\n        this.element.style.display = '';\n    }\n    hide() {\n        this.element.style.display = 'none';\n    }\n    renderPanel(panel, options = { asActive: true }) {\n        const doRender = options.asActive ||\n            (this.panel && this.group.isPanelActive(this.panel));\n        if (this.panel &&\n            this.panel.view.content.element.parentElement === this._element) {\n            /**\n             * If the currently attached panel is mounted directly to the content then remove it\n             */\n            this._element.removeChild(this.panel.view.content.element);\n        }\n        this.panel = panel;\n        let container;\n        switch (panel.api.renderer) {\n            case 'onlyWhenVisible':\n                this.group.renderContainer.detatch(panel);\n                if (this.panel) {\n                    if (doRender) {\n                        this._element.appendChild(this.panel.view.content.element);\n                    }\n                }\n                container = this._element;\n                break;\n            case 'always':\n                if (panel.view.content.element.parentElement === this._element) {\n                    this._element.removeChild(panel.view.content.element);\n                }\n                container = this.group.renderContainer.attach({\n                    panel,\n                    referenceContainer: this,\n                });\n                break;\n            default:\n                throw new Error(`dockview: invalid renderer type '${panel.api.renderer}'`);\n        }\n        if (doRender) {\n            const focusTracker = trackFocus(container);\n            const disposable = new CompositeDisposable();\n            disposable.addDisposables(focusTracker, focusTracker.onDidFocus(() => this._onDidFocus.fire()), focusTracker.onDidBlur(() => this._onDidBlur.fire()));\n            this.disposable.value = disposable;\n        }\n    }\n    openPanel(panel) {\n        if (this.panel === panel) {\n            return;\n        }\n        this.renderPanel(panel);\n    }\n    layout(_width, _height) {\n        // noop\n    }\n    closePanel() {\n        var _a;\n        if (this.panel) {\n            if (this.panel.api.renderer === 'onlyWhenVisible') {\n                (_a = this.panel.view.content.element.parentElement) === null || _a === void 0 ? void 0 : _a.removeChild(this.panel.view.content.element);\n            }\n        }\n        this.panel = undefined;\n    }\n    dispose() {\n        this.disposable.dispose();\n        super.dispose();\n    }\n}\n","import { addClasses, removeClasses } from '../dom';\nexport function addGhostImage(dataTransfer, ghostElement, options) {\n    var _a, _b;\n    // class dockview provides to force ghost image to be drawn on a different layer and prevent weird rendering issues\n    addClasses(ghostElement, 'dv-dragged');\n    // move the element off-screen initially otherwise it may in some cases be rendered at (0,0) momentarily\n    ghostElement.style.top = '-9999px';\n    document.body.appendChild(ghostElement);\n    dataTransfer.setDragImage(ghostElement, (_a = options === null || options === void 0 ? void 0 : options.x) !== null && _a !== void 0 ? _a : 0, (_b = options === null || options === void 0 ? void 0 : options.y) !== null && _b !== void 0 ? _b : 0);\n    setTimeout(() => {\n        removeClasses(ghostElement, 'dv-dragged');\n        ghostElement.remove();\n    }, 0);\n}\n","import { addDisposableListener, Emitter } from '../../../events';\nimport { CompositeDisposable } from '../../../lifecycle';\nimport { getPanelData, LocalSelectionTransfer, PanelTransfer, } from '../../../dnd/dataTransfer';\nimport { toggleClass } from '../../../dom';\nimport { Droptarget, } from '../../../dnd/droptarget';\nimport { DragHandler } from '../../../dnd/abstractDragHandler';\nimport { addGhostImage } from '../../../dnd/ghost';\nclass TabDragHandler extends DragHandler {\n    constructor(element, accessor, group, panel, disabled) {\n        super(element, disabled);\n        this.accessor = accessor;\n        this.group = group;\n        this.panel = panel;\n        this.panelTransfer = LocalSelectionTransfer.getInstance();\n    }\n    getData(event) {\n        this.panelTransfer.setData([new PanelTransfer(this.accessor.id, this.group.id, this.panel.id)], PanelTransfer.prototype);\n        return {\n            dispose: () => {\n                this.panelTransfer.clearData(PanelTransfer.prototype);\n            },\n        };\n    }\n}\nexport class Tab extends CompositeDisposable {\n    get element() {\n        return this._element;\n    }\n    constructor(panel, accessor, group) {\n        super();\n        this.panel = panel;\n        this.accessor = accessor;\n        this.group = group;\n        this.content = undefined;\n        this._onPointDown = new Emitter();\n        this.onPointerDown = this._onPointDown.event;\n        this._onDropped = new Emitter();\n        this.onDrop = this._onDropped.event;\n        this._onDragStart = new Emitter();\n        this.onDragStart = this._onDragStart.event;\n        this._element = document.createElement('div');\n        this._element.className = 'dv-tab';\n        this._element.tabIndex = 0;\n        this._element.draggable = !this.accessor.options.disableDnd;\n        toggleClass(this.element, 'dv-inactive-tab', true);\n        this.dragHandler = new TabDragHandler(this._element, this.accessor, this.group, this.panel, !!this.accessor.options.disableDnd);\n        this.dropTarget = new Droptarget(this._element, {\n            acceptedTargetZones: ['left', 'right'],\n            overlayModel: { activationSize: { value: 50, type: 'percentage' } },\n            canDisplayOverlay: (event, position) => {\n                if (this.group.locked) {\n                    return false;\n                }\n                const data = getPanelData();\n                if (data && this.accessor.id === data.viewId) {\n                    return true;\n                }\n                return this.group.model.canDisplayOverlay(event, position, 'tab');\n            },\n            getOverrideTarget: () => { var _a; return (_a = group.model.dropTargetContainer) === null || _a === void 0 ? void 0 : _a.model; },\n        });\n        this.onWillShowOverlay = this.dropTarget.onWillShowOverlay;\n        this.addDisposables(this._onPointDown, this._onDropped, this._onDragStart, this.dragHandler.onDragStart((event) => {\n            if (event.dataTransfer) {\n                const style = getComputedStyle(this.element);\n                const newNode = this.element.cloneNode(true);\n                Array.from(style).forEach((key) => newNode.style.setProperty(key, style.getPropertyValue(key), style.getPropertyPriority(key)));\n                newNode.style.position = 'absolute';\n                addGhostImage(event.dataTransfer, newNode, {\n                    y: -10,\n                    x: 30,\n                });\n            }\n            this._onDragStart.fire(event);\n        }), this.dragHandler, addDisposableListener(this._element, 'pointerdown', (event) => {\n            this._onPointDown.fire(event);\n        }), this.dropTarget.onDrop((event) => {\n            this._onDropped.fire(event);\n        }), this.dropTarget);\n    }\n    setActive(isActive) {\n        toggleClass(this.element, 'dv-active-tab', isActive);\n        toggleClass(this.element, 'dv-inactive-tab', !isActive);\n    }\n    setContent(part) {\n        if (this.content) {\n            this._element.removeChild(this.content.element);\n        }\n        this.content = part;\n        this._element.appendChild(this.content.element);\n    }\n    updateDragAndDropState() {\n        this._element.draggable = !this.accessor.options.disableDnd;\n        this.dragHandler.setDisabled(!!this.accessor.options.disableDnd);\n    }\n    dispose() {\n        super.dispose();\n    }\n}\n","export class WillShowOverlayLocationEvent {\n    get kind() {\n        return this.options.kind;\n    }\n    get nativeEvent() {\n        return this.event.nativeEvent;\n    }\n    get position() {\n        return this.event.position;\n    }\n    get defaultPrevented() {\n        return this.event.defaultPrevented;\n    }\n    get panel() {\n        return this.options.panel;\n    }\n    get api() {\n        return this.options.api;\n    }\n    get group() {\n        return this.options.group;\n    }\n    preventDefault() {\n        this.event.preventDefault();\n    }\n    getData() {\n        return this.options.getData();\n    }\n    constructor(event, options) {\n        this.event = event;\n        this.options = options;\n    }\n}\n","import { quasiPreventDefault } from '../dom';\nimport { addDisposableListener } from '../events';\nimport { DragHandler } from './abstractDragHandler';\nimport { LocalSelectionTransfer, PanelTransfer } from './dataTransfer';\nimport { addGhostImage } from './ghost';\nexport class GroupDragHandler extends DragHandler {\n    constructor(element, accessor, group, disabled) {\n        super(element, disabled);\n        this.accessor = accessor;\n        this.group = group;\n        this.panelTransfer = LocalSelectionTransfer.getInstance();\n        this.addDisposables(addDisposableListener(element, 'pointerdown', (e) => {\n            if (e.shiftKey) {\n                /**\n                 * You cannot call e.preventDefault() because that will prevent drag events from firing\n                 * but we also need to stop any group overlay drag events from occuring\n                 * Use a custom event marker that can be checked by the overlay drag events\n                 */\n                quasiPreventDefault(e);\n            }\n        }, true));\n    }\n    isCancelled(_event) {\n        if (this.group.api.location.type === 'floating' && !_event.shiftKey) {\n            return true;\n        }\n        return false;\n    }\n    getData(dragEvent) {\n        const dataTransfer = dragEvent.dataTransfer;\n        this.panelTransfer.setData([new PanelTransfer(this.accessor.id, this.group.id, null)], PanelTransfer.prototype);\n        const style = window.getComputedStyle(this.el);\n        const bgColor = style.getPropertyValue('--dv-activegroup-visiblepanel-tab-background-color');\n        const color = style.getPropertyValue('--dv-activegroup-visiblepanel-tab-color');\n        if (dataTransfer) {\n            const ghostElement = document.createElement('div');\n            ghostElement.style.backgroundColor = bgColor;\n            ghostElement.style.color = color;\n            ghostElement.style.padding = '2px 8px';\n            ghostElement.style.height = '24px';\n            ghostElement.style.fontSize = '11px';\n            ghostElement.style.lineHeight = '20px';\n            ghostElement.style.borderRadius = '12px';\n            ghostElement.style.position = 'absolute';\n            ghostElement.style.pointerEvents = 'none';\n            ghostElement.style.top = '-9999px';\n            ghostElement.textContent = `Multiple Panels (${this.group.size})`;\n            addGhostImage(dataTransfer, ghostElement, { y: -10, x: 30 });\n        }\n        return {\n            dispose: () => {\n                this.panelTransfer.clearData(PanelTransfer.prototype);\n            },\n        };\n    }\n}\n","import { getPanelData } from '../../../dnd/dataTransfer';\nimport { Droptarget, } from '../../../dnd/droptarget';\nimport { GroupDragHandler } from '../../../dnd/groupDragHandler';\nimport { addDisposableListener, Emitter } from '../../../events';\nimport { CompositeDisposable } from '../../../lifecycle';\nimport { toggleClass } from '../../../dom';\nexport class VoidContainer extends CompositeDisposable {\n    get element() {\n        return this._element;\n    }\n    constructor(accessor, group) {\n        super();\n        this.accessor = accessor;\n        this.group = group;\n        this._onDrop = new Emitter();\n        this.onDrop = this._onDrop.event;\n        this._onDragStart = new Emitter();\n        this.onDragStart = this._onDragStart.event;\n        this._element = document.createElement('div');\n        this._element.className = 'dv-void-container';\n        this._element.draggable = !this.accessor.options.disableDnd;\n        toggleClass(this._element, 'dv-draggable', !this.accessor.options.disableDnd);\n        this.addDisposables(this._onDrop, this._onDragStart, addDisposableListener(this._element, 'pointerdown', () => {\n            this.accessor.doSetGroupActive(this.group);\n        }));\n        this.handler = new GroupDragHandler(this._element, accessor, group, !!this.accessor.options.disableDnd);\n        this.dropTarget = new Droptarget(this._element, {\n            acceptedTargetZones: ['center'],\n            canDisplayOverlay: (event, position) => {\n                const data = getPanelData();\n                if (data && this.accessor.id === data.viewId) {\n                    return true;\n                }\n                return group.model.canDisplayOverlay(event, position, 'header_space');\n            },\n            getOverrideTarget: () => { var _a; return (_a = group.model.dropTargetContainer) === null || _a === void 0 ? void 0 : _a.model; },\n        });\n        this.onWillShowOverlay = this.dropTarget.onWillShowOverlay;\n        this.addDisposables(this.handler, this.handler.onDragStart((event) => {\n            this._onDragStart.fire(event);\n        }), this.dropTarget.onDrop((event) => {\n            this._onDrop.fire(event);\n        }), this.dropTarget);\n    }\n    updateDragAndDropState() {\n        this._element.draggable = !this.accessor.options.disableDnd;\n        toggleClass(this._element, 'dv-draggable', !this.accessor.options.disableDnd);\n        this.handler.setDisabled(!!this.accessor.options.disableDnd);\n    }\n}\n","import { toggleClass, watchElementResize } from './dom';\nimport { addDisposableListener } from './events';\nimport { CompositeDisposable } from './lifecycle';\nimport { clamp } from './math';\nexport class Scrollbar extends CompositeDisposable {\n    get element() {\n        return this._element;\n    }\n    constructor(scrollableElement) {\n        super();\n        this.scrollableElement = scrollableElement;\n        this._scrollLeft = 0;\n        this._element = document.createElement('div');\n        this._element.className = 'dv-scrollable';\n        this._horizontalScrollbar = document.createElement('div');\n        this._horizontalScrollbar.className = 'dv-scrollbar-horizontal';\n        this.element.appendChild(scrollableElement);\n        this.element.appendChild(this._horizontalScrollbar);\n        this.addDisposables(addDisposableListener(this.element, 'wheel', (event) => {\n            this._scrollLeft += event.deltaY * Scrollbar.MouseWheelSpeed;\n            this.calculateScrollbarStyles();\n        }), addDisposableListener(this._horizontalScrollbar, 'pointerdown', (event) => {\n            event.preventDefault();\n            toggleClass(this.element, 'dv-scrollable-scrolling', true);\n            const originalClientX = event.clientX;\n            const originalScrollLeft = this._scrollLeft;\n            const onPointerMove = (event) => {\n                const deltaX = event.clientX - originalClientX;\n                const { clientWidth } = this.element;\n                const { scrollWidth } = this.scrollableElement;\n                const p = clientWidth / scrollWidth;\n                this._scrollLeft = originalScrollLeft + deltaX / p;\n                this.calculateScrollbarStyles();\n            };\n            const onEnd = () => {\n                toggleClass(this.element, 'dv-scrollable-scrolling', false);\n                document.removeEventListener('pointermove', onPointerMove);\n                document.removeEventListener('pointerup', onEnd);\n                document.removeEventListener('pointercancel', onEnd);\n            };\n            document.addEventListener('pointermove', onPointerMove);\n            document.addEventListener('pointerup', onEnd);\n            document.addEventListener('pointercancel', onEnd);\n        }), addDisposableListener(this.element, 'scroll', () => {\n            this.calculateScrollbarStyles();\n        }), addDisposableListener(this.scrollableElement, 'scroll', () => {\n            this._scrollLeft = this.scrollableElement.scrollLeft;\n            this.calculateScrollbarStyles();\n        }), watchElementResize(this.element, () => {\n            toggleClass(this.element, 'dv-scrollable-resizing', true);\n            if (this._animationTimer) {\n                clearTimeout(this._animationTimer);\n            }\n            this._animationTimer = setTimeout(() => {\n                clearTimeout(this._animationTimer);\n                toggleClass(this.element, 'dv-scrollable-resizing', false);\n            }, 500);\n            this.calculateScrollbarStyles();\n        }));\n    }\n    calculateScrollbarStyles() {\n        const { clientWidth } = this.element;\n        const { scrollWidth } = this.scrollableElement;\n        const hasScrollbar = scrollWidth > clientWidth;\n        if (hasScrollbar) {\n            const px = clientWidth * (clientWidth / scrollWidth);\n            this._horizontalScrollbar.style.width = `${px}px`;\n            this._scrollLeft = clamp(this._scrollLeft, 0, this.scrollableElement.scrollWidth - clientWidth);\n            this.scrollableElement.scrollLeft = this._scrollLeft;\n            const percentageComplete = this._scrollLeft / (scrollWidth - clientWidth);\n            this._horizontalScrollbar.style.left = `${(clientWidth - px) * percentageComplete}px`;\n        }\n        else {\n            this._horizontalScrollbar.style.width = `0px`;\n            this._horizontalScrollbar.style.left = `0px`;\n            this._scrollLeft = 0;\n        }\n    }\n}\nScrollbar.MouseWheelSpeed = 1;\n","import { getPanelData } from '../../../dnd/dataTransfer';\nimport { isChildEntirelyVisibleWithinParent, OverflowObserver, } from '../../../dom';\nimport { addDisposableListener, Emitter } from '../../../events';\nimport { CompositeDisposable, Disposable, MutableDisposable, } from '../../../lifecycle';\nimport { Scrollbar } from '../../../scrollbar';\nimport { WillShowOverlayLocationEvent } from '../../events';\nimport { Tab } from '../tab/tab';\nexport class Tabs extends CompositeDisposable {\n    get showTabsOverflowControl() {\n        return this._showTabsOverflowControl;\n    }\n    set showTabsOverflowControl(value) {\n        if (this._showTabsOverflowControl == value) {\n            return;\n        }\n        this._showTabsOverflowControl = value;\n        if (value) {\n            const observer = new OverflowObserver(this._tabsList);\n            this._observerDisposable.value = new CompositeDisposable(observer, observer.onDidChange((event) => {\n                const hasOverflow = event.hasScrollX || event.hasScrollY;\n                this.toggleDropdown({ reset: !hasOverflow });\n            }), addDisposableListener(this._tabsList, 'scroll', () => {\n                this.toggleDropdown({ reset: false });\n            }));\n        }\n    }\n    get element() {\n        return this._element;\n    }\n    get panels() {\n        return this._tabs.map((_) => _.value.panel.id);\n    }\n    get size() {\n        return this._tabs.length;\n    }\n    get tabs() {\n        return this._tabs.map((_) => _.value);\n    }\n    constructor(group, accessor, options) {\n        super();\n        this.group = group;\n        this.accessor = accessor;\n        this._observerDisposable = new MutableDisposable();\n        this._tabs = [];\n        this.selectedIndex = -1;\n        this._showTabsOverflowControl = false;\n        this._onTabDragStart = new Emitter();\n        this.onTabDragStart = this._onTabDragStart.event;\n        this._onDrop = new Emitter();\n        this.onDrop = this._onDrop.event;\n        this._onWillShowOverlay = new Emitter();\n        this.onWillShowOverlay = this._onWillShowOverlay.event;\n        this._onOverflowTabsChange = new Emitter();\n        this.onOverflowTabsChange = this._onOverflowTabsChange.event;\n        this._tabsList = document.createElement('div');\n        this._tabsList.className = 'dv-tabs-container dv-horizontal';\n        this.showTabsOverflowControl = options.showTabsOverflowControl;\n        if (accessor.options.scrollbars === 'native') {\n            this._element = this._tabsList;\n        }\n        else {\n            const scrollbar = new Scrollbar(this._tabsList);\n            this._element = scrollbar.element;\n            this.addDisposables(scrollbar);\n        }\n        this.addDisposables(this._onOverflowTabsChange, this._observerDisposable, this._onWillShowOverlay, this._onDrop, this._onTabDragStart, addDisposableListener(this.element, 'pointerdown', (event) => {\n            if (event.defaultPrevented) {\n                return;\n            }\n            const isLeftClick = event.button === 0;\n            if (isLeftClick) {\n                this.accessor.doSetGroupActive(this.group);\n            }\n        }), Disposable.from(() => {\n            for (const { value, disposable } of this._tabs) {\n                disposable.dispose();\n                value.dispose();\n            }\n            this._tabs = [];\n        }));\n    }\n    indexOf(id) {\n        return this._tabs.findIndex((tab) => tab.value.panel.id === id);\n    }\n    isActive(tab) {\n        return (this.selectedIndex > -1 &&\n            this._tabs[this.selectedIndex].value === tab);\n    }\n    setActivePanel(panel) {\n        let runningWidth = 0;\n        for (const tab of this._tabs) {\n            const isActivePanel = panel.id === tab.value.panel.id;\n            tab.value.setActive(isActivePanel);\n            if (isActivePanel) {\n                const element = tab.value.element;\n                const parentElement = element.parentElement;\n                if (runningWidth < parentElement.scrollLeft ||\n                    runningWidth + element.clientWidth >\n                        parentElement.scrollLeft + parentElement.clientWidth) {\n                    parentElement.scrollLeft = runningWidth;\n                }\n            }\n            runningWidth += tab.value.element.clientWidth;\n        }\n    }\n    openPanel(panel, index = this._tabs.length) {\n        if (this._tabs.find((tab) => tab.value.panel.id === panel.id)) {\n            return;\n        }\n        const tab = new Tab(panel, this.accessor, this.group);\n        tab.setContent(panel.view.tab);\n        const disposable = new CompositeDisposable(tab.onDragStart((event) => {\n            this._onTabDragStart.fire({ nativeEvent: event, panel });\n        }), tab.onPointerDown((event) => {\n            if (event.defaultPrevented) {\n                return;\n            }\n            const isFloatingGroupsEnabled = !this.accessor.options.disableFloatingGroups;\n            const isFloatingWithOnePanel = this.group.api.location.type === 'floating' &&\n                this.size === 1;\n            if (isFloatingGroupsEnabled &&\n                !isFloatingWithOnePanel &&\n                event.shiftKey) {\n                event.preventDefault();\n                const panel = this.accessor.getGroupPanel(tab.panel.id);\n                const { top, left } = tab.element.getBoundingClientRect();\n                const { top: rootTop, left: rootLeft } = this.accessor.element.getBoundingClientRect();\n                this.accessor.addFloatingGroup(panel, {\n                    x: left - rootLeft,\n                    y: top - rootTop,\n                    inDragMode: true,\n                });\n                return;\n            }\n            switch (event.button) {\n                case 0: // left click or touch\n                    if (this.group.activePanel !== panel) {\n                        this.group.model.openPanel(panel);\n                    }\n                    break;\n            }\n        }), tab.onDrop((event) => {\n            this._onDrop.fire({\n                event: event.nativeEvent,\n                index: this._tabs.findIndex((x) => x.value === tab),\n            });\n        }), tab.onWillShowOverlay((event) => {\n            this._onWillShowOverlay.fire(new WillShowOverlayLocationEvent(event, {\n                kind: 'tab',\n                panel: this.group.activePanel,\n                api: this.accessor.api,\n                group: this.group,\n                getData: getPanelData,\n            }));\n        }));\n        const value = { value: tab, disposable };\n        this.addTab(value, index);\n    }\n    delete(id) {\n        const index = this.indexOf(id);\n        const tabToRemove = this._tabs.splice(index, 1)[0];\n        const { value, disposable } = tabToRemove;\n        disposable.dispose();\n        value.dispose();\n        value.element.remove();\n    }\n    addTab(tab, index = this._tabs.length) {\n        if (index < 0 || index > this._tabs.length) {\n            throw new Error('invalid location');\n        }\n        this._tabsList.insertBefore(tab.value.element, this._tabsList.children[index]);\n        this._tabs = [\n            ...this._tabs.slice(0, index),\n            tab,\n            ...this._tabs.slice(index),\n        ];\n        if (this.selectedIndex < 0) {\n            this.selectedIndex = index;\n        }\n    }\n    toggleDropdown(options) {\n        const tabs = options.reset\n            ? []\n            : this._tabs\n                .filter((tab) => !isChildEntirelyVisibleWithinParent(tab.value.element, this._tabsList))\n                .map((x) => x.value.panel.id);\n        this._onOverflowTabsChange.fire({ tabs, reset: options.reset });\n    }\n    updateDragAndDropState() {\n        for (const tab of this._tabs) {\n            tab.value.updateDragAndDropState();\n        }\n    }\n}\n","const createSvgElementFromPath = (params) => {\n    const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n    svg.setAttributeNS(null, 'height', params.height);\n    svg.setAttributeNS(null, 'width', params.width);\n    svg.setAttributeNS(null, 'viewBox', params.viewbox);\n    svg.setAttributeNS(null, 'aria-hidden', 'false');\n    svg.setAttributeNS(null, 'focusable', 'false');\n    svg.classList.add('dv-svg');\n    const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');\n    path.setAttributeNS(null, 'd', params.path);\n    svg.appendChild(path);\n    return svg;\n};\nexport const createCloseButton = () => createSvgElementFromPath({\n    width: '11',\n    height: '11',\n    viewbox: '0 0 28 28',\n    path: 'M2.1 27.3L0 25.2L11.55 13.65L0 2.1L2.1 0L13.65 11.55L25.2 0L27.3 2.1L15.75 13.65L27.3 25.2L25.2 27.3L13.65 15.75L2.1 27.3Z',\n});\nexport const createExpandMoreButton = () => createSvgElementFromPath({\n    width: '11',\n    height: '11',\n    viewbox: '0 0 24 15',\n    path: 'M12 14.15L0 2.15L2.15 0L12 9.9L21.85 0.0499992L24 2.2L12 14.15Z',\n});\nexport const createChevronRightButton = () => createSvgElementFromPath({\n    width: '11',\n    height: '11',\n    viewbox: '0 0 15 25',\n    path: 'M2.15 24.1L0 21.95L9.9 12.05L0 2.15L2.15 0L14.2 12.05L2.15 24.1Z',\n});\n","import { CompositeDisposable, Disposable, MutableDisposable, } from '../../../lifecycle';\nimport { addDisposableListener, Emitter } from '../../../events';\nimport { VoidContainer } from './voidContainer';\nimport { findRelativeZIndexParent, toggleClass } from '../../../dom';\nimport { WillShowOverlayLocationEvent } from '../../events';\nimport { getPanelData } from '../../../dnd/dataTransfer';\nimport { Tabs } from './tabs';\nimport { createDropdownElementHandle, } from './tabOverflowControl';\nexport class TabsContainer extends CompositeDisposable {\n    get onTabDragStart() {\n        return this.tabs.onTabDragStart;\n    }\n    get panels() {\n        return this.tabs.panels;\n    }\n    get size() {\n        return this.tabs.size;\n    }\n    get hidden() {\n        return this._hidden;\n    }\n    set hidden(value) {\n        this._hidden = value;\n        this.element.style.display = value ? 'none' : '';\n    }\n    get element() {\n        return this._element;\n    }\n    constructor(accessor, group) {\n        super();\n        this.accessor = accessor;\n        this.group = group;\n        this._hidden = false;\n        this.dropdownPart = null;\n        this._overflowTabs = [];\n        this._dropdownDisposable = new MutableDisposable();\n        this._onDrop = new Emitter();\n        this.onDrop = this._onDrop.event;\n        this._onGroupDragStart = new Emitter();\n        this.onGroupDragStart = this._onGroupDragStart.event;\n        this._onWillShowOverlay = new Emitter();\n        this.onWillShowOverlay = this._onWillShowOverlay.event;\n        this._element = document.createElement('div');\n        this._element.className = 'dv-tabs-and-actions-container';\n        toggleClass(this._element, 'dv-full-width-single-tab', this.accessor.options.singleTabMode === 'fullwidth');\n        this.rightActionsContainer = document.createElement('div');\n        this.rightActionsContainer.className = 'dv-right-actions-container';\n        this.leftActionsContainer = document.createElement('div');\n        this.leftActionsContainer.className = 'dv-left-actions-container';\n        this.preActionsContainer = document.createElement('div');\n        this.preActionsContainer.className = 'dv-pre-actions-container';\n        this.tabs = new Tabs(group, accessor, {\n            showTabsOverflowControl: !accessor.options.disableTabsOverflowList,\n        });\n        this.voidContainer = new VoidContainer(this.accessor, this.group);\n        this._element.appendChild(this.preActionsContainer);\n        this._element.appendChild(this.tabs.element);\n        this._element.appendChild(this.leftActionsContainer);\n        this._element.appendChild(this.voidContainer.element);\n        this._element.appendChild(this.rightActionsContainer);\n        this.addDisposables(this.tabs.onDrop((e) => this._onDrop.fire(e)), this.tabs.onWillShowOverlay((e) => this._onWillShowOverlay.fire(e)), accessor.onDidOptionsChange(() => {\n            this.tabs.showTabsOverflowControl =\n                !accessor.options.disableTabsOverflowList;\n        }), this.tabs.onOverflowTabsChange((event) => {\n            this.toggleDropdown(event);\n        }), this.tabs, this._onWillShowOverlay, this._onDrop, this._onGroupDragStart, this.voidContainer, this.voidContainer.onDragStart((event) => {\n            this._onGroupDragStart.fire({\n                nativeEvent: event,\n                group: this.group,\n            });\n        }), this.voidContainer.onDrop((event) => {\n            this._onDrop.fire({\n                event: event.nativeEvent,\n                index: this.tabs.size,\n            });\n        }), this.voidContainer.onWillShowOverlay((event) => {\n            this._onWillShowOverlay.fire(new WillShowOverlayLocationEvent(event, {\n                kind: 'header_space',\n                panel: this.group.activePanel,\n                api: this.accessor.api,\n                group: this.group,\n                getData: getPanelData,\n            }));\n        }), addDisposableListener(this.voidContainer.element, 'pointerdown', (event) => {\n            if (event.defaultPrevented) {\n                return;\n            }\n            const isFloatingGroupsEnabled = !this.accessor.options.disableFloatingGroups;\n            if (isFloatingGroupsEnabled &&\n                event.shiftKey &&\n                this.group.api.location.type !== 'floating') {\n                event.preventDefault();\n                const { top, left } = this.element.getBoundingClientRect();\n                const { top: rootTop, left: rootLeft } = this.accessor.element.getBoundingClientRect();\n                this.accessor.addFloatingGroup(this.group, {\n                    x: left - rootLeft + 20,\n                    y: top - rootTop + 20,\n                    inDragMode: true,\n                });\n            }\n        }));\n    }\n    show() {\n        if (!this.hidden) {\n            this.element.style.display = '';\n        }\n    }\n    hide() {\n        this._element.style.display = 'none';\n    }\n    setRightActionsElement(element) {\n        if (this.rightActions === element) {\n            return;\n        }\n        if (this.rightActions) {\n            this.rightActions.remove();\n            this.rightActions = undefined;\n        }\n        if (element) {\n            this.rightActionsContainer.appendChild(element);\n            this.rightActions = element;\n        }\n    }\n    setLeftActionsElement(element) {\n        if (this.leftActions === element) {\n            return;\n        }\n        if (this.leftActions) {\n            this.leftActions.remove();\n            this.leftActions = undefined;\n        }\n        if (element) {\n            this.leftActionsContainer.appendChild(element);\n            this.leftActions = element;\n        }\n    }\n    setPrefixActionsElement(element) {\n        if (this.preActions === element) {\n            return;\n        }\n        if (this.preActions) {\n            this.preActions.remove();\n            this.preActions = undefined;\n        }\n        if (element) {\n            this.preActionsContainer.appendChild(element);\n            this.preActions = element;\n        }\n    }\n    isActive(tab) {\n        return this.tabs.isActive(tab);\n    }\n    indexOf(id) {\n        return this.tabs.indexOf(id);\n    }\n    setActive(_isGroupActive) {\n        // noop\n    }\n    delete(id) {\n        this.tabs.delete(id);\n        this.updateClassnames();\n    }\n    setActivePanel(panel) {\n        this.tabs.setActivePanel(panel);\n    }\n    openPanel(panel, index = this.tabs.size) {\n        this.tabs.openPanel(panel, index);\n        this.updateClassnames();\n    }\n    closePanel(panel) {\n        this.delete(panel.id);\n    }\n    updateClassnames() {\n        toggleClass(this._element, 'dv-single-tab', this.size === 1);\n    }\n    toggleDropdown(options) {\n        const tabs = options.reset ? [] : options.tabs;\n        this._overflowTabs = tabs;\n        if (this._overflowTabs.length > 0 && this.dropdownPart) {\n            this.dropdownPart.update({ tabs: tabs.length });\n            return;\n        }\n        if (this._overflowTabs.length === 0) {\n            this._dropdownDisposable.dispose();\n            return;\n        }\n        const root = document.createElement('div');\n        root.className = 'dv-tabs-overflow-dropdown-root';\n        const part = createDropdownElementHandle();\n        part.update({ tabs: tabs.length });\n        this.dropdownPart = part;\n        root.appendChild(part.element);\n        this.rightActionsContainer.prepend(root);\n        this._dropdownDisposable.value = new CompositeDisposable(Disposable.from(() => {\n            var _a, _b;\n            root.remove();\n            (_b = (_a = this.dropdownPart) === null || _a === void 0 ? void 0 : _a.dispose) === null || _b === void 0 ? void 0 : _b.call(_a);\n            this.dropdownPart = null;\n        }), addDisposableListener(root, 'pointerdown', (event) => {\n            event.preventDefault();\n        }, { capture: true }), addDisposableListener(root, 'click', (event) => {\n            const el = document.createElement('div');\n            el.style.overflow = 'auto';\n            el.className = 'dv-tabs-overflow-container';\n            for (const tab of this.tabs.tabs.filter((tab) => this._overflowTabs.includes(tab.panel.id))) {\n                const panelObject = this.group.panels.find((panel) => panel === tab.panel);\n                const tabComponent = panelObject.view.createTabRenderer('headerOverflow');\n                const child = tabComponent.element;\n                const wrapper = document.createElement('div');\n                toggleClass(wrapper, 'dv-tab', true);\n                toggleClass(wrapper, 'dv-active-tab', panelObject.api.isActive);\n                toggleClass(wrapper, 'dv-inactive-tab', !panelObject.api.isActive);\n                wrapper.addEventListener('click', (event) => {\n                    this.accessor.popupService.close();\n                    if (event.defaultPrevented) {\n                        return;\n                    }\n                    tab.element.scrollIntoView();\n                    tab.panel.api.setActive();\n                });\n                wrapper.appendChild(child);\n                el.appendChild(wrapper);\n            }\n            const relativeParent = findRelativeZIndexParent(root);\n            this.accessor.popupService.openPopover(el, {\n                x: event.clientX,\n                y: event.clientY,\n                zIndex: (relativeParent === null || relativeParent === void 0 ? void 0 : relativeParent.style.zIndex)\n                    ? `calc(${relativeParent.style.zIndex} * 2)`\n                    : undefined,\n            });\n        }));\n    }\n    updateDragAndDropState() {\n        this.tabs.updateDragAndDropState();\n        this.voidContainer.updateDragAndDropState();\n    }\n}\n","import { createChevronRightButton } from '../../../svg';\nexport function createDropdownElementHandle() {\n    const el = document.createElement('div');\n    el.className = 'dv-tabs-overflow-dropdown-default';\n    const text = document.createElement('span');\n    text.textContent = ``;\n    const icon = createChevronRightButton();\n    el.appendChild(icon);\n    el.appendChild(text);\n    return {\n        element: el,\n        update: (params) => {\n            text.textContent = `${params.tabs}`;\n        },\n    };\n}\n","import { AcceptableEvent } from '../events';\nexport class DockviewUnhandledDragOverEvent extends AcceptableEvent {\n    constructor(nativeEvent, target, position, getData, group) {\n        super();\n        this.nativeEvent = nativeEvent;\n        this.target = target;\n        this.position = position;\n        this.getData = getData;\n        this.group = group;\n    }\n}\nexport const PROPERTY_KEYS_DOCKVIEW = (() => {\n    /**\n     * by readong the keys from an empty value object TypeScript will error\n     * when we add or remove new properties to `DockviewOptions`\n     */\n    const properties = {\n        disableAutoResizing: undefined,\n        hideBorders: undefined,\n        singleTabMode: undefined,\n        disableFloatingGroups: undefined,\n        floatingGroupBounds: undefined,\n        popoutUrl: undefined,\n        defaultRenderer: undefined,\n        debug: undefined,\n        rootOverlayModel: undefined,\n        locked: undefined,\n        disableDnd: undefined,\n        className: undefined,\n        noPanelsOverlay: undefined,\n        dndEdges: undefined,\n        theme: undefined,\n        disableTabsOverflowList: undefined,\n        scrollbars: undefined,\n    };\n    return Object.keys(properties);\n})();\nexport function isPanelOptionsWithPanel(data) {\n    if (data.referencePanel) {\n        return true;\n    }\n    return false;\n}\nexport function isPanelOptionsWithGroup(data) {\n    if (data.referenceGroup) {\n        return true;\n    }\n    return false;\n}\nexport function isGroupOptionsWithPanel(data) {\n    if (data.referencePanel) {\n        return true;\n    }\n    return false;\n}\nexport function isGroupOptionsWithGroup(data) {\n    if (data.referenceGroup) {\n        return true;\n    }\n    return false;\n}\n","import { DockviewApi } from '../api/component.api';\nimport { getPanelData } from '../dnd/dataTransfer';\nimport { isAncestor, toggleClass } from '../dom';\nimport { addDisposableListener, DockviewEvent, Emitter, } from '../events';\nimport { WillShowOverlayLocationEvent } from './events';\nimport { CompositeDisposable } from '../lifecycle';\nimport { ContentContainer, } from './components/panel/content';\nimport { TabsContainer, } from './components/titlebar/tabsContainer';\nimport { DockviewUnhandledDragOverEvent, } from './options';\nexport class DockviewDidDropEvent extends DockviewEvent {\n    get nativeEvent() {\n        return this.options.nativeEvent;\n    }\n    get position() {\n        return this.options.position;\n    }\n    get panel() {\n        return this.options.panel;\n    }\n    get group() {\n        return this.options.group;\n    }\n    get api() {\n        return this.options.api;\n    }\n    constructor(options) {\n        super();\n        this.options = options;\n    }\n    getData() {\n        return this.options.getData();\n    }\n}\nexport class DockviewWillDropEvent extends DockviewDidDropEvent {\n    get kind() {\n        return this._kind;\n    }\n    constructor(options) {\n        super(options);\n        this._kind = options.kind;\n    }\n}\nexport class DockviewGroupPanelModel extends CompositeDisposable {\n    get element() {\n        throw new Error('dockview: not supported');\n    }\n    get activePanel() {\n        return this._activePanel;\n    }\n    get locked() {\n        return this._locked;\n    }\n    set locked(value) {\n        this._locked = value;\n        toggleClass(this.container, 'dv-locked-groupview', value === 'no-drop-target' || value);\n    }\n    get isActive() {\n        return this._isGroupActive;\n    }\n    get panels() {\n        return this._panels;\n    }\n    get size() {\n        return this._panels.length;\n    }\n    get isEmpty() {\n        return this._panels.length === 0;\n    }\n    get hasWatermark() {\n        return !!(this.watermark && this.container.contains(this.watermark.element));\n    }\n    get header() {\n        return this.tabsContainer;\n    }\n    get isContentFocused() {\n        if (!document.activeElement) {\n            return false;\n        }\n        return isAncestor(document.activeElement, this.contentContainer.element);\n    }\n    get location() {\n        return this._location;\n    }\n    set location(value) {\n        this._location = value;\n        toggleClass(this.container, 'dv-groupview-floating', false);\n        toggleClass(this.container, 'dv-groupview-popout', false);\n        switch (value.type) {\n            case 'grid':\n                this.contentContainer.dropTarget.setTargetZones([\n                    'top',\n                    'bottom',\n                    'left',\n                    'right',\n                    'center',\n                ]);\n                break;\n            case 'floating':\n                this.contentContainer.dropTarget.setTargetZones(['center']);\n                this.contentContainer.dropTarget.setTargetZones(value\n                    ? ['center']\n                    : ['top', 'bottom', 'left', 'right', 'center']);\n                toggleClass(this.container, 'dv-groupview-floating', true);\n                break;\n            case 'popout':\n                this.contentContainer.dropTarget.setTargetZones(['center']);\n                toggleClass(this.container, 'dv-groupview-popout', true);\n                break;\n        }\n        this.groupPanel.api._onDidLocationChange.fire({\n            location: this.location,\n        });\n    }\n    constructor(container, accessor, id, options, groupPanel) {\n        var _a;\n        super();\n        this.container = container;\n        this.accessor = accessor;\n        this.id = id;\n        this.options = options;\n        this.groupPanel = groupPanel;\n        this._isGroupActive = false;\n        this._locked = false;\n        this._location = { type: 'grid' };\n        this.mostRecentlyUsed = [];\n        this._overwriteRenderContainer = null;\n        this._overwriteDropTargetContainer = null;\n        this._onDidChange = new Emitter();\n        this.onDidChange = this._onDidChange.event;\n        this._width = 0;\n        this._height = 0;\n        this._panels = [];\n        this._panelDisposables = new Map();\n        this._onMove = new Emitter();\n        this.onMove = this._onMove.event;\n        this._onDidDrop = new Emitter();\n        this.onDidDrop = this._onDidDrop.event;\n        this._onWillDrop = new Emitter();\n        this.onWillDrop = this._onWillDrop.event;\n        this._onWillShowOverlay = new Emitter();\n        this.onWillShowOverlay = this._onWillShowOverlay.event;\n        this._onTabDragStart = new Emitter();\n        this.onTabDragStart = this._onTabDragStart.event;\n        this._onGroupDragStart = new Emitter();\n        this.onGroupDragStart = this._onGroupDragStart.event;\n        this._onDidAddPanel = new Emitter();\n        this.onDidAddPanel = this._onDidAddPanel.event;\n        this._onDidPanelTitleChange = new Emitter();\n        this.onDidPanelTitleChange = this._onDidPanelTitleChange.event;\n        this._onDidPanelParametersChange = new Emitter();\n        this.onDidPanelParametersChange = this._onDidPanelParametersChange.event;\n        this._onDidRemovePanel = new Emitter();\n        this.onDidRemovePanel = this._onDidRemovePanel.event;\n        this._onDidActivePanelChange = new Emitter();\n        this.onDidActivePanelChange = this._onDidActivePanelChange.event;\n        this._onUnhandledDragOverEvent = new Emitter();\n        this.onUnhandledDragOverEvent = this._onUnhandledDragOverEvent.event;\n        toggleClass(this.container, 'dv-groupview', true);\n        this._api = new DockviewApi(this.accessor);\n        this.tabsContainer = new TabsContainer(this.accessor, this.groupPanel);\n        this.contentContainer = new ContentContainer(this.accessor, this);\n        container.append(this.tabsContainer.element, this.contentContainer.element);\n        this.header.hidden = !!options.hideHeader;\n        this.locked = (_a = options.locked) !== null && _a !== void 0 ? _a : false;\n        this.addDisposables(this._onTabDragStart, this._onGroupDragStart, this._onWillShowOverlay, this.tabsContainer.onTabDragStart((event) => {\n            this._onTabDragStart.fire(event);\n        }), this.tabsContainer.onGroupDragStart((event) => {\n            this._onGroupDragStart.fire(event);\n        }), this.tabsContainer.onDrop((event) => {\n            this.handleDropEvent('header', event.event, 'center', event.index);\n        }), this.contentContainer.onDidFocus(() => {\n            this.accessor.doSetGroupActive(this.groupPanel);\n        }), this.contentContainer.onDidBlur(() => {\n            // noop\n        }), this.contentContainer.dropTarget.onDrop((event) => {\n            this.handleDropEvent('content', event.nativeEvent, event.position);\n        }), this.tabsContainer.onWillShowOverlay((event) => {\n            this._onWillShowOverlay.fire(event);\n        }), this.contentContainer.dropTarget.onWillShowOverlay((event) => {\n            this._onWillShowOverlay.fire(new WillShowOverlayLocationEvent(event, {\n                kind: 'content',\n                panel: this.activePanel,\n                api: this._api,\n                group: this.groupPanel,\n                getData: getPanelData,\n            }));\n        }), this._onMove, this._onDidChange, this._onDidDrop, this._onWillDrop, this._onDidAddPanel, this._onDidRemovePanel, this._onDidActivePanelChange, this._onUnhandledDragOverEvent, this._onDidPanelTitleChange, this._onDidPanelParametersChange);\n    }\n    focusContent() {\n        this.contentContainer.element.focus();\n    }\n    set renderContainer(value) {\n        this.panels.forEach((panel) => {\n            this.renderContainer.detatch(panel);\n        });\n        this._overwriteRenderContainer = value;\n        this.panels.forEach((panel) => {\n            this.rerender(panel);\n        });\n    }\n    get renderContainer() {\n        var _a;\n        return ((_a = this._overwriteRenderContainer) !== null && _a !== void 0 ? _a : this.accessor.overlayRenderContainer);\n    }\n    set dropTargetContainer(value) {\n        this._overwriteDropTargetContainer = value;\n    }\n    get dropTargetContainer() {\n        var _a;\n        return ((_a = this._overwriteDropTargetContainer) !== null && _a !== void 0 ? _a : this.accessor.rootDropTargetContainer);\n    }\n    initialize() {\n        if (this.options.panels) {\n            this.options.panels.forEach((panel) => {\n                this.doAddPanel(panel);\n            });\n        }\n        if (this.options.activePanel) {\n            this.openPanel(this.options.activePanel);\n        }\n        // must be run after the constructor otherwise this.parent may not be\n        // correctly initialized\n        this.setActive(this.isActive, true);\n        this.updateContainer();\n        if (this.accessor.options.createRightHeaderActionComponent) {\n            this._rightHeaderActions =\n                this.accessor.options.createRightHeaderActionComponent(this.groupPanel);\n            this.addDisposables(this._rightHeaderActions);\n            this._rightHeaderActions.init({\n                containerApi: this._api,\n                api: this.groupPanel.api,\n                group: this.groupPanel,\n            });\n            this.tabsContainer.setRightActionsElement(this._rightHeaderActions.element);\n        }\n        if (this.accessor.options.createLeftHeaderActionComponent) {\n            this._leftHeaderActions =\n                this.accessor.options.createLeftHeaderActionComponent(this.groupPanel);\n            this.addDisposables(this._leftHeaderActions);\n            this._leftHeaderActions.init({\n                containerApi: this._api,\n                api: this.groupPanel.api,\n                group: this.groupPanel,\n            });\n            this.tabsContainer.setLeftActionsElement(this._leftHeaderActions.element);\n        }\n        if (this.accessor.options.createPrefixHeaderActionComponent) {\n            this._prefixHeaderActions =\n                this.accessor.options.createPrefixHeaderActionComponent(this.groupPanel);\n            this.addDisposables(this._prefixHeaderActions);\n            this._prefixHeaderActions.init({\n                containerApi: this._api,\n                api: this.groupPanel.api,\n                group: this.groupPanel,\n            });\n            this.tabsContainer.setPrefixActionsElement(this._prefixHeaderActions.element);\n        }\n    }\n    rerender(panel) {\n        this.contentContainer.renderPanel(panel, { asActive: false });\n    }\n    indexOf(panel) {\n        return this.tabsContainer.indexOf(panel.id);\n    }\n    toJSON() {\n        var _a;\n        const result = {\n            views: this.tabsContainer.panels,\n            activeView: (_a = this._activePanel) === null || _a === void 0 ? void 0 : _a.id,\n            id: this.id,\n        };\n        if (this.locked !== false) {\n            result.locked = this.locked;\n        }\n        if (this.header.hidden) {\n            result.hideHeader = true;\n        }\n        return result;\n    }\n    moveToNext(options) {\n        if (!options) {\n            options = {};\n        }\n        if (!options.panel) {\n            options.panel = this.activePanel;\n        }\n        const index = options.panel ? this.panels.indexOf(options.panel) : -1;\n        let normalizedIndex;\n        if (index < this.panels.length - 1) {\n            normalizedIndex = index + 1;\n        }\n        else if (!options.suppressRoll) {\n            normalizedIndex = 0;\n        }\n        else {\n            return;\n        }\n        this.openPanel(this.panels[normalizedIndex]);\n    }\n    moveToPrevious(options) {\n        if (!options) {\n            options = {};\n        }\n        if (!options.panel) {\n            options.panel = this.activePanel;\n        }\n        if (!options.panel) {\n            return;\n        }\n        const index = this.panels.indexOf(options.panel);\n        let normalizedIndex;\n        if (index > 0) {\n            normalizedIndex = index - 1;\n        }\n        else if (!options.suppressRoll) {\n            normalizedIndex = this.panels.length - 1;\n        }\n        else {\n            return;\n        }\n        this.openPanel(this.panels[normalizedIndex]);\n    }\n    containsPanel(panel) {\n        return this.panels.includes(panel);\n    }\n    init(_params) {\n        //noop\n    }\n    update(_params) {\n        //noop\n    }\n    focus() {\n        var _a;\n        (_a = this._activePanel) === null || _a === void 0 ? void 0 : _a.focus();\n    }\n    openPanel(panel, options = {}) {\n        /**\n         * set the panel group\n         * add the panel\n         * check if group active\n         * check if panel active\n         */\n        if (typeof options.index !== 'number' ||\n            options.index > this.panels.length) {\n            options.index = this.panels.length;\n        }\n        const skipSetActive = !!options.skipSetActive;\n        // ensure the group is updated before we fire any events\n        panel.updateParentGroup(this.groupPanel, {\n            skipSetActive: options.skipSetActive,\n        });\n        this.doAddPanel(panel, options.index, {\n            skipSetActive: skipSetActive,\n        });\n        if (this._activePanel === panel) {\n            this.contentContainer.renderPanel(panel, { asActive: true });\n            return;\n        }\n        if (!skipSetActive) {\n            this.doSetActivePanel(panel);\n        }\n        if (!options.skipSetGroupActive) {\n            this.accessor.doSetGroupActive(this.groupPanel);\n        }\n        if (!options.skipSetActive) {\n            this.updateContainer();\n        }\n    }\n    removePanel(groupItemOrId, options = {\n        skipSetActive: false,\n    }) {\n        const id = typeof groupItemOrId === 'string'\n            ? groupItemOrId\n            : groupItemOrId.id;\n        const panelToRemove = this._panels.find((panel) => panel.id === id);\n        if (!panelToRemove) {\n            throw new Error('invalid operation');\n        }\n        return this._removePanel(panelToRemove, options);\n    }\n    closeAllPanels() {\n        if (this.panels.length > 0) {\n            // take a copy since we will be edting the array as we iterate through\n            const arrPanelCpy = [...this.panels];\n            for (const panel of arrPanelCpy) {\n                this.doClose(panel);\n            }\n        }\n        else {\n            this.accessor.removeGroup(this.groupPanel);\n        }\n    }\n    closePanel(panel) {\n        this.doClose(panel);\n    }\n    doClose(panel) {\n        const isLast = this.panels.length === 1 && this.accessor.groups.length === 1;\n        this.accessor.removePanel(panel, isLast && this.accessor.options.noPanelsOverlay === 'emptyGroup'\n            ? { removeEmptyGroup: false }\n            : undefined);\n    }\n    isPanelActive(panel) {\n        return this._activePanel === panel;\n    }\n    updateActions(element) {\n        this.tabsContainer.setRightActionsElement(element);\n    }\n    setActive(isGroupActive, force = false) {\n        if (!force && this.isActive === isGroupActive) {\n            return;\n        }\n        this._isGroupActive = isGroupActive;\n        toggleClass(this.container, 'dv-active-group', isGroupActive);\n        toggleClass(this.container, 'dv-inactive-group', !isGroupActive);\n        this.tabsContainer.setActive(this.isActive);\n        if (!this._activePanel && this.panels.length > 0) {\n            this.doSetActivePanel(this.panels[0]);\n        }\n        this.updateContainer();\n    }\n    layout(width, height) {\n        var _a;\n        this._width = width;\n        this._height = height;\n        this.contentContainer.layout(this._width, this._height);\n        if ((_a = this._activePanel) === null || _a === void 0 ? void 0 : _a.layout) {\n            this._activePanel.layout(this._width, this._height);\n        }\n    }\n    _removePanel(panel, options) {\n        const isActivePanel = this._activePanel === panel;\n        this.doRemovePanel(panel);\n        if (isActivePanel && this.panels.length > 0) {\n            const nextPanel = this.mostRecentlyUsed[0];\n            this.openPanel(nextPanel, {\n                skipSetActive: options.skipSetActive,\n                skipSetGroupActive: options.skipSetActiveGroup,\n            });\n        }\n        if (this._activePanel && this.panels.length === 0) {\n            this.doSetActivePanel(undefined);\n        }\n        if (!options.skipSetActive) {\n            this.updateContainer();\n        }\n        return panel;\n    }\n    doRemovePanel(panel) {\n        const index = this.panels.indexOf(panel);\n        if (this._activePanel === panel) {\n            this.contentContainer.closePanel();\n        }\n        this.tabsContainer.delete(panel.id);\n        this._panels.splice(index, 1);\n        if (this.mostRecentlyUsed.includes(panel)) {\n            const index = this.mostRecentlyUsed.indexOf(panel);\n            this.mostRecentlyUsed.splice(index, 1);\n        }\n        const disposable = this._panelDisposables.get(panel.id);\n        if (disposable) {\n            disposable.dispose();\n            this._panelDisposables.delete(panel.id);\n        }\n        this._onDidRemovePanel.fire({ panel });\n    }\n    doAddPanel(panel, index = this.panels.length, options = { skipSetActive: false }) {\n        const existingPanel = this._panels.indexOf(panel);\n        const hasExistingPanel = existingPanel > -1;\n        this.tabsContainer.show();\n        this.contentContainer.show();\n        this.tabsContainer.openPanel(panel, index);\n        if (!options.skipSetActive) {\n            this.contentContainer.openPanel(panel);\n        }\n        if (hasExistingPanel) {\n            // TODO - need to ensure ordering hasn't changed and if it has need to re-order this.panels\n            return;\n        }\n        this.updateMru(panel);\n        this.panels.splice(index, 0, panel);\n        this._panelDisposables.set(panel.id, new CompositeDisposable(panel.api.onDidTitleChange((event) => this._onDidPanelTitleChange.fire(event)), panel.api.onDidParametersChange((event) => this._onDidPanelParametersChange.fire(event))));\n        this._onDidAddPanel.fire({ panel });\n    }\n    doSetActivePanel(panel) {\n        if (this._activePanel === panel) {\n            return;\n        }\n        this._activePanel = panel;\n        if (panel) {\n            this.tabsContainer.setActivePanel(panel);\n            panel.layout(this._width, this._height);\n            this.updateMru(panel);\n            this._onDidActivePanelChange.fire({\n                panel,\n            });\n        }\n    }\n    updateMru(panel) {\n        if (this.mostRecentlyUsed.includes(panel)) {\n            this.mostRecentlyUsed.splice(this.mostRecentlyUsed.indexOf(panel), 1);\n        }\n        this.mostRecentlyUsed = [panel, ...this.mostRecentlyUsed];\n    }\n    updateContainer() {\n        var _a, _b;\n        this.panels.forEach((panel) => panel.runEvents());\n        if (this.isEmpty && !this.watermark) {\n            const watermark = this.accessor.createWatermarkComponent();\n            watermark.init({\n                containerApi: this._api,\n                group: this.groupPanel,\n            });\n            this.watermark = watermark;\n            addDisposableListener(this.watermark.element, 'pointerdown', () => {\n                if (!this.isActive) {\n                    this.accessor.doSetGroupActive(this.groupPanel);\n                }\n            });\n            this.contentContainer.element.appendChild(this.watermark.element);\n        }\n        if (!this.isEmpty && this.watermark) {\n            this.watermark.element.remove();\n            (_b = (_a = this.watermark).dispose) === null || _b === void 0 ? void 0 : _b.call(_a);\n            this.watermark = undefined;\n        }\n    }\n    canDisplayOverlay(event, position, target) {\n        const firedEvent = new DockviewUnhandledDragOverEvent(event, target, position, getPanelData, this.accessor.getPanel(this.id));\n        this._onUnhandledDragOverEvent.fire(firedEvent);\n        return firedEvent.isAccepted;\n    }\n    handleDropEvent(type, event, position, index) {\n        if (this.locked === 'no-drop-target') {\n            return;\n        }\n        function getKind() {\n            switch (type) {\n                case 'header':\n                    return typeof index === 'number' ? 'tab' : 'header_space';\n                case 'content':\n                    return 'content';\n            }\n        }\n        const panel = typeof index === 'number' ? this.panels[index] : undefined;\n        const willDropEvent = new DockviewWillDropEvent({\n            nativeEvent: event,\n            position,\n            panel,\n            getData: () => getPanelData(),\n            kind: getKind(),\n            group: this.groupPanel,\n            api: this._api,\n        });\n        this._onWillDrop.fire(willDropEvent);\n        if (willDropEvent.defaultPrevented) {\n            return;\n        }\n        const data = getPanelData();\n        if (data && data.viewId === this.accessor.id) {\n            if (type === 'content') {\n                if (data.groupId === this.id) {\n                    // don't allow to drop on self for center position\n                    if (position === 'center') {\n                        return;\n                    }\n                    if (data.panelId === null) {\n                        // don't allow group move to drop anywhere on self\n                        return;\n                    }\n                }\n            }\n            if (type === 'header') {\n                if (data.groupId === this.id) {\n                    if (data.panelId === null) {\n                        return;\n                    }\n                }\n            }\n            if (data.panelId === null) {\n                // this is a group move dnd event\n                const { groupId } = data;\n                this._onMove.fire({\n                    target: position,\n                    groupId: groupId,\n                    index,\n                });\n                return;\n            }\n            const fromSameGroup = this.tabsContainer.indexOf(data.panelId) !== -1;\n            if (fromSameGroup && this.tabsContainer.size === 1) {\n                return;\n            }\n            const { groupId, panelId } = data;\n            const isSameGroup = this.id === groupId;\n            if (isSameGroup && !position) {\n                const oldIndex = this.tabsContainer.indexOf(panelId);\n                if (oldIndex === index) {\n                    return;\n                }\n            }\n            this._onMove.fire({\n                target: position,\n                groupId: data.groupId,\n                itemId: data.panelId,\n                index,\n            });\n        }\n        else {\n            this._onDidDrop.fire(new DockviewDidDropEvent({\n                nativeEvent: event,\n                position,\n                panel,\n                getData: () => getPanelData(),\n                group: this.groupPanel,\n                api: this._api,\n            }));\n        }\n    }\n    updateDragAndDropState() {\n        this.tabsContainer.updateDragAndDropState();\n    }\n    dispose() {\n        var _a, _b, _c;\n        super.dispose();\n        (_a = this.watermark) === null || _a === void 0 ? void 0 : _a.element.remove();\n        (_c = (_b = this.watermark) === null || _b === void 0 ? void 0 : _b.dispose) === null || _c === void 0 ? void 0 : _c.call(_b);\n        this.watermark = undefined;\n        for (const panel of this.panels) {\n            panel.dispose();\n        }\n        this.tabsContainer.dispose();\n        this.contentContainer.dispose();\n    }\n}\n","import { Emitter } from '../events';\nimport { PanelApiImpl } from './panelApi';\nexport class GridviewPanelApiImpl extends PanelApiImpl {\n    constructor(id, component, panel) {\n        super(id, component);\n        this._onDidConstraintsChangeInternal = new Emitter();\n        this.onDidConstraintsChangeInternal = this._onDidConstraintsChangeInternal.event;\n        this._onDidConstraintsChange = new Emitter();\n        this.onDidConstraintsChange = this._onDidConstraintsChange.event;\n        this._onDidSizeChange = new Emitter();\n        this.onDidSizeChange = this._onDidSizeChange.event;\n        this.addDisposables(this._onDidConstraintsChangeInternal, this._onDidConstraintsChange, this._onDidSizeChange);\n        if (panel) {\n            this.initialize(panel);\n        }\n    }\n    setConstraints(value) {\n        this._onDidConstraintsChangeInternal.fire(value);\n    }\n    setSize(event) {\n        this._onDidSizeChange.fire(event);\n    }\n}\n","import { BasePanelView, } from './basePanelView';\nimport { GridviewPanelApiImpl, } from '../api/gridviewPanelApi';\nimport { Emitter } from '../events';\nexport class GridviewPanel extends BasePanelView {\n    get priority() {\n        return this._priority;\n    }\n    get snap() {\n        return this._snap;\n    }\n    get minimumWidth() {\n        /**\n         * defer to protected function to allow subclasses to override easily.\n         * see https://github.com/microsoft/TypeScript/issues/338\n         */\n        return this.__minimumWidth();\n    }\n    get minimumHeight() {\n        /**\n         * defer to protected function to allow subclasses to override easily.\n         * see https://github.com/microsoft/TypeScript/issues/338\n         */\n        return this.__minimumHeight();\n    }\n    get maximumHeight() {\n        /**\n         * defer to protected function to allow subclasses to override easily.\n         * see https://github.com/microsoft/TypeScript/issues/338\n         */\n        return this.__maximumHeight();\n    }\n    get maximumWidth() {\n        /**\n         * defer to protected function to allow subclasses to override easily.\n         * see https://github.com/microsoft/TypeScript/issues/338\n         */\n        return this.__maximumWidth();\n    }\n    __minimumWidth() {\n        const width = typeof this._minimumWidth === 'function'\n            ? this._minimumWidth()\n            : this._minimumWidth;\n        if (width !== this._evaluatedMinimumWidth) {\n            this._evaluatedMinimumWidth = width;\n            this.updateConstraints();\n        }\n        return width;\n    }\n    __maximumWidth() {\n        const width = typeof this._maximumWidth === 'function'\n            ? this._maximumWidth()\n            : this._maximumWidth;\n        if (width !== this._evaluatedMaximumWidth) {\n            this._evaluatedMaximumWidth = width;\n            this.updateConstraints();\n        }\n        return width;\n    }\n    __minimumHeight() {\n        const height = typeof this._minimumHeight === 'function'\n            ? this._minimumHeight()\n            : this._minimumHeight;\n        if (height !== this._evaluatedMinimumHeight) {\n            this._evaluatedMinimumHeight = height;\n            this.updateConstraints();\n        }\n        return height;\n    }\n    __maximumHeight() {\n        const height = typeof this._maximumHeight === 'function'\n            ? this._maximumHeight()\n            : this._maximumHeight;\n        if (height !== this._evaluatedMaximumHeight) {\n            this._evaluatedMaximumHeight = height;\n            this.updateConstraints();\n        }\n        return height;\n    }\n    get isActive() {\n        return this.api.isActive;\n    }\n    get isVisible() {\n        return this.api.isVisible;\n    }\n    constructor(id, component, options, api) {\n        super(id, component, api !== null && api !== void 0 ? api : new GridviewPanelApiImpl(id, component));\n        this._evaluatedMinimumWidth = 0;\n        this._evaluatedMaximumWidth = Number.MAX_SAFE_INTEGER;\n        this._evaluatedMinimumHeight = 0;\n        this._evaluatedMaximumHeight = Number.MAX_SAFE_INTEGER;\n        this._minimumWidth = 0;\n        this._minimumHeight = 0;\n        this._maximumWidth = Number.MAX_SAFE_INTEGER;\n        this._maximumHeight = Number.MAX_SAFE_INTEGER;\n        this._snap = false;\n        this._onDidChange = new Emitter();\n        this.onDidChange = this._onDidChange.event;\n        if (typeof (options === null || options === void 0 ? void 0 : options.minimumWidth) === 'number') {\n            this._minimumWidth = options.minimumWidth;\n        }\n        if (typeof (options === null || options === void 0 ? void 0 : options.maximumWidth) === 'number') {\n            this._maximumWidth = options.maximumWidth;\n        }\n        if (typeof (options === null || options === void 0 ? void 0 : options.minimumHeight) === 'number') {\n            this._minimumHeight = options.minimumHeight;\n        }\n        if (typeof (options === null || options === void 0 ? void 0 : options.maximumHeight) === 'number') {\n            this._maximumHeight = options.maximumHeight;\n        }\n        this.api.initialize(this); // TODO: required to by-pass 'super before this' requirement\n        this.addDisposables(this.api.onWillVisibilityChange((event) => {\n            const { isVisible } = event;\n            const { accessor } = this._params;\n            accessor.setVisible(this, isVisible);\n        }), this.api.onActiveChange(() => {\n            const { accessor } = this._params;\n            accessor.doSetGroupActive(this);\n        }), this.api.onDidConstraintsChangeInternal((event) => {\n            if (typeof event.minimumWidth === 'number' ||\n                typeof event.minimumWidth === 'function') {\n                this._minimumWidth = event.minimumWidth;\n            }\n            if (typeof event.minimumHeight === 'number' ||\n                typeof event.minimumHeight === 'function') {\n                this._minimumHeight = event.minimumHeight;\n            }\n            if (typeof event.maximumWidth === 'number' ||\n                typeof event.maximumWidth === 'function') {\n                this._maximumWidth = event.maximumWidth;\n            }\n            if (typeof event.maximumHeight === 'number' ||\n                typeof event.maximumHeight === 'function') {\n                this._maximumHeight = event.maximumHeight;\n            }\n        }), this.api.onDidSizeChange((event) => {\n            this._onDidChange.fire({\n                height: event.height,\n                width: event.width,\n            });\n        }), this._onDidChange);\n    }\n    setVisible(isVisible) {\n        this.api._onDidVisibilityChange.fire({ isVisible });\n    }\n    setActive(isActive) {\n        this.api._onDidActiveChange.fire({ isActive });\n    }\n    init(parameters) {\n        if (parameters.maximumHeight) {\n            this._maximumHeight = parameters.maximumHeight;\n        }\n        if (parameters.minimumHeight) {\n            this._minimumHeight = parameters.minimumHeight;\n        }\n        if (parameters.maximumWidth) {\n            this._maximumWidth = parameters.maximumWidth;\n        }\n        if (parameters.minimumWidth) {\n            this._minimumWidth = parameters.minimumWidth;\n        }\n        this._priority = parameters.priority;\n        this._snap = !!parameters.snap;\n        super.init(parameters);\n        if (typeof parameters.isVisible === 'boolean') {\n            this.setVisible(parameters.isVisible);\n        }\n    }\n    updateConstraints() {\n        this.api._onDidConstraintsChange.fire({\n            minimumWidth: this._evaluatedMinimumWidth,\n            maximumWidth: this._evaluatedMaximumWidth,\n            minimumHeight: this._evaluatedMinimumHeight,\n            maximumHeight: this._evaluatedMaximumHeight,\n        });\n    }\n    toJSON() {\n        const state = super.toJSON();\n        const maximum = (value) => value === Number.MAX_SAFE_INTEGER ? undefined : value;\n        const minimum = (value) => (value <= 0 ? undefined : value);\n        return Object.assign(Object.assign({}, state), { minimumHeight: minimum(this.minimumHeight), maximumHeight: maximum(this.maximumHeight), minimumWidth: minimum(this.minimumWidth), maximumWidth: maximum(this.maximumWidth), snap: this.snap, priority: this.priority });\n    }\n}\n","import { positionToDirection } from '../dnd/droptarget';\nimport { Emitter } from '../events';\nimport { GridviewPanelApiImpl } from './gridviewPanelApi';\nconst NOT_INITIALIZED_MESSAGE = 'dockview: DockviewGroupPanelApiImpl not initialized';\nexport class DockviewGroupPanelApiImpl extends GridviewPanelApiImpl {\n    get location() {\n        if (!this._group) {\n            throw new Error(NOT_INITIALIZED_MESSAGE);\n        }\n        return this._group.model.location;\n    }\n    constructor(id, accessor) {\n        super(id, '__dockviewgroup__');\n        this.accessor = accessor;\n        this._onDidLocationChange = new Emitter();\n        this.onDidLocationChange = this._onDidLocationChange.event;\n        this._onDidActivePanelChange = new Emitter();\n        this.onDidActivePanelChange = this._onDidActivePanelChange.event;\n        this.addDisposables(this._onDidLocationChange, this._onDidActivePanelChange);\n    }\n    close() {\n        if (!this._group) {\n            return;\n        }\n        return this.accessor.removeGroup(this._group);\n    }\n    getWindow() {\n        return this.location.type === 'popout'\n            ? this.location.getWindow()\n            : window;\n    }\n    moveTo(options) {\n        var _a, _b, _c, _d;\n        if (!this._group) {\n            throw new Error(NOT_INITIALIZED_MESSAGE);\n        }\n        const group = (_a = options.group) !== null && _a !== void 0 ? _a : this.accessor.addGroup({\n            direction: positionToDirection((_b = options.position) !== null && _b !== void 0 ? _b : 'right'),\n            skipSetActive: (_c = options.skipSetActive) !== null && _c !== void 0 ? _c : false,\n        });\n        this.accessor.moveGroupOrPanel({\n            from: { groupId: this._group.id },\n            to: {\n                group,\n                position: options.group\n                    ? (_d = options.position) !== null && _d !== void 0 ? _d : 'center'\n                    : 'center',\n                index: options.index,\n            },\n            skipSetActive: options.skipSetActive,\n        });\n    }\n    maximize() {\n        if (!this._group) {\n            throw new Error(NOT_INITIALIZED_MESSAGE);\n        }\n        if (this.location.type !== 'grid') {\n            // only grid groups can be maximized\n            return;\n        }\n        this.accessor.maximizeGroup(this._group);\n    }\n    isMaximized() {\n        if (!this._group) {\n            throw new Error(NOT_INITIALIZED_MESSAGE);\n        }\n        return this.accessor.isMaximizedGroup(this._group);\n    }\n    exitMaximized() {\n        if (!this._group) {\n            throw new Error(NOT_INITIALIZED_MESSAGE);\n        }\n        if (this.isMaximized()) {\n            this.accessor.exitMaximizedGroup();\n        }\n    }\n    initialize(group) {\n        this._group = group;\n    }\n}\n","import { DockviewGroupPanelModel, } from './dockviewGroupPanelModel';\nimport { GridviewPanel } from '../gridview/gridviewPanel';\nimport { DockviewGroupPanelApiImpl, } from '../api/dockviewGroupPanelApi';\nconst MINIMUM_DOCKVIEW_GROUP_PANEL_WIDTH = 100;\nconst MINIMUM_DOCKVIEW_GROUP_PANEL_HEIGHT = 100;\nexport class DockviewGroupPanel extends GridviewPanel {\n    get minimumWidth() {\n        var _a;\n        const activePanelMinimumWidth = (_a = this.activePanel) === null || _a === void 0 ? void 0 : _a.minimumWidth;\n        if (typeof activePanelMinimumWidth === 'number') {\n            return activePanelMinimumWidth;\n        }\n        return super.__minimumWidth();\n    }\n    get minimumHeight() {\n        var _a;\n        const activePanelMinimumHeight = (_a = this.activePanel) === null || _a === void 0 ? void 0 : _a.minimumHeight;\n        if (typeof activePanelMinimumHeight === 'number') {\n            return activePanelMinimumHeight;\n        }\n        return super.__minimumHeight();\n    }\n    get maximumWidth() {\n        var _a;\n        const activePanelMaximumWidth = (_a = this.activePanel) === null || _a === void 0 ? void 0 : _a.maximumWidth;\n        if (typeof activePanelMaximumWidth === 'number') {\n            return activePanelMaximumWidth;\n        }\n        return super.__maximumWidth();\n    }\n    get maximumHeight() {\n        var _a;\n        const activePanelMaximumHeight = (_a = this.activePanel) === null || _a === void 0 ? void 0 : _a.maximumHeight;\n        if (typeof activePanelMaximumHeight === 'number') {\n            return activePanelMaximumHeight;\n        }\n        return super.__maximumHeight();\n    }\n    get panels() {\n        return this._model.panels;\n    }\n    get activePanel() {\n        return this._model.activePanel;\n    }\n    get size() {\n        return this._model.size;\n    }\n    get model() {\n        return this._model;\n    }\n    get locked() {\n        return this._model.locked;\n    }\n    set locked(value) {\n        this._model.locked = value;\n    }\n    get header() {\n        return this._model.header;\n    }\n    constructor(accessor, id, options) {\n        var _a, _b, _c, _d, _e, _f;\n        super(id, 'groupview_default', {\n            minimumHeight: (_b = (_a = options.constraints) === null || _a === void 0 ? void 0 : _a.minimumHeight) !== null && _b !== void 0 ? _b : MINIMUM_DOCKVIEW_GROUP_PANEL_HEIGHT,\n            minimumWidth: (_d = (_c = options.constraints) === null || _c === void 0 ? void 0 : _c.maximumHeight) !== null && _d !== void 0 ? _d : MINIMUM_DOCKVIEW_GROUP_PANEL_WIDTH,\n            maximumHeight: (_e = options.constraints) === null || _e === void 0 ? void 0 : _e.maximumHeight,\n            maximumWidth: (_f = options.constraints) === null || _f === void 0 ? void 0 : _f.maximumWidth,\n        }, new DockviewGroupPanelApiImpl(id, accessor));\n        this.api.initialize(this); // cannot use 'this' after after 'super' call\n        this._model = new DockviewGroupPanelModel(this.element, accessor, id, options, this);\n        this.addDisposables(this.model.onDidActivePanelChange((event) => {\n            this.api._onDidActivePanelChange.fire(event);\n        }));\n    }\n    focus() {\n        if (!this.api.isActive) {\n            this.api.setActive();\n        }\n        super.focus();\n    }\n    initialize() {\n        this._model.initialize();\n    }\n    setActive(isActive) {\n        super.setActive(isActive);\n        this.model.setActive(isActive);\n    }\n    layout(width, height) {\n        super.layout(width, height);\n        this.model.layout(width, height);\n    }\n    getComponent() {\n        return this._model;\n    }\n    toJSON() {\n        return this.model.toJSON();\n    }\n}\n","export const themeDark = {\n    name: 'dark',\n    className: 'dockview-theme-dark',\n};\nexport const themeLight = {\n    name: 'light',\n    className: 'dockview-theme-light',\n};\nexport const themeVisualStudio = {\n    name: 'visualStudio',\n    className: 'dockview-theme-vs',\n};\nexport const themeAbyss = {\n    name: 'abyss',\n    className: 'dockview-theme-abyss',\n};\nexport const themeDracula = {\n    name: 'dracula',\n    className: 'dockview-theme-dracula',\n};\nexport const themeReplit = {\n    name: 'replit',\n    className: 'dockview-theme-replit',\n    gap: 10,\n};\nexport const themeAbyssSpaced = {\n    name: 'abyssSpaced',\n    className: 'dockview-theme-abyss-spaced',\n    gap: 10,\n    dndOverlayMounting: 'absolute',\n    dndPanelOverlay: 'group',\n};\nexport const themeLightSpaced = {\n    name: 'lightSpaced',\n    className: 'dockview-theme-light-spaced',\n    gap: 10,\n    dndOverlayMounting: 'absolute',\n    dndPanelOverlay: 'group',\n};\n","import { Emitter } from '../events';\nimport { GridviewPanelApiImpl } from './gridviewPanelApi';\nimport { CompositeDisposable, MutableDisposable } from '../lifecycle';\nexport class DockviewPanelApiImpl extends GridviewPanelApiImpl {\n    get location() {\n        return this.group.api.location;\n    }\n    get title() {\n        return this.panel.title;\n    }\n    get isGroupActive() {\n        return this.group.isActive;\n    }\n    get renderer() {\n        return this.panel.renderer;\n    }\n    set group(value) {\n        const oldGroup = this._group;\n        if (this._group !== value) {\n            this._group = value;\n            this._onDidGroupChange.fire({});\n            this.setupGroupEventListeners(oldGroup);\n            this._onDidLocationChange.fire({\n                location: this.group.api.location,\n            });\n        }\n    }\n    get group() {\n        return this._group;\n    }\n    get tabComponent() {\n        return this._tabComponent;\n    }\n    constructor(panel, group, accessor, component, tabComponent) {\n        super(panel.id, component);\n        this.panel = panel;\n        this.accessor = accessor;\n        this._onDidTitleChange = new Emitter();\n        this.onDidTitleChange = this._onDidTitleChange.event;\n        this._onDidActiveGroupChange = new Emitter();\n        this.onDidActiveGroupChange = this._onDidActiveGroupChange.event;\n        this._onDidGroupChange = new Emitter();\n        this.onDidGroupChange = this._onDidGroupChange.event;\n        this._onDidRendererChange = new Emitter();\n        this.onDidRendererChange = this._onDidRendererChange.event;\n        this._onDidLocationChange = new Emitter();\n        this.onDidLocationChange = this._onDidLocationChange.event;\n        this.groupEventsDisposable = new MutableDisposable();\n        this._tabComponent = tabComponent;\n        this.initialize(panel);\n        this._group = group;\n        this.setupGroupEventListeners();\n        this.addDisposables(this.groupEventsDisposable, this._onDidRendererChange, this._onDidTitleChange, this._onDidGroupChange, this._onDidActiveGroupChange, this._onDidLocationChange);\n    }\n    getWindow() {\n        return this.group.api.getWindow();\n    }\n    moveTo(options) {\n        var _a, _b;\n        this.accessor.moveGroupOrPanel({\n            from: { groupId: this._group.id, panelId: this.panel.id },\n            to: {\n                group: (_a = options.group) !== null && _a !== void 0 ? _a : this._group,\n                position: options.group\n                    ? (_b = options.position) !== null && _b !== void 0 ? _b : 'center'\n                    : 'center',\n                index: options.index,\n            },\n            skipSetActive: options.skipSetActive,\n        });\n    }\n    setTitle(title) {\n        this.panel.setTitle(title);\n    }\n    setRenderer(renderer) {\n        this.panel.setRenderer(renderer);\n    }\n    close() {\n        this.group.model.closePanel(this.panel);\n    }\n    maximize() {\n        this.group.api.maximize();\n    }\n    isMaximized() {\n        return this.group.api.isMaximized();\n    }\n    exitMaximized() {\n        this.group.api.exitMaximized();\n    }\n    setupGroupEventListeners(previousGroup) {\n        var _a;\n        let _trackGroupActive = (_a = previousGroup === null || previousGroup === void 0 ? void 0 : previousGroup.isActive) !== null && _a !== void 0 ? _a : false; // prevent duplicate events with same state\n        this.groupEventsDisposable.value = new CompositeDisposable(this.group.api.onDidVisibilityChange((event) => {\n            const hasBecomeHidden = !event.isVisible && this.isVisible;\n            const hasBecomeVisible = event.isVisible && !this.isVisible;\n            const isActivePanel = this.group.model.isPanelActive(this.panel);\n            if (hasBecomeHidden || (hasBecomeVisible && isActivePanel)) {\n                this._onDidVisibilityChange.fire(event);\n            }\n        }), this.group.api.onDidLocationChange((event) => {\n            if (this.group !== this.panel.group) {\n                return;\n            }\n            this._onDidLocationChange.fire(event);\n        }), this.group.api.onDidActiveChange(() => {\n            if (this.group !== this.panel.group) {\n                return;\n            }\n            if (_trackGroupActive !== this.isGroupActive) {\n                _trackGroupActive = this.isGroupActive;\n                this._onDidActiveGroupChange.fire({\n                    isActive: this.isGroupActive,\n                });\n            }\n        }));\n    }\n}\n","import { DockviewPanelApiImpl, } from '../api/dockviewPanelApi';\nimport { CompositeDisposable } from '../lifecycle';\nimport { WillFocusEvent } from '../api/panelApi';\nexport class DockviewPanel extends CompositeDisposable {\n    get params() {\n        return this._params;\n    }\n    get title() {\n        return this._title;\n    }\n    get group() {\n        return this._group;\n    }\n    get renderer() {\n        var _a;\n        return (_a = this._renderer) !== null && _a !== void 0 ? _a : this.accessor.renderer;\n    }\n    get minimumWidth() {\n        return this._minimumWidth;\n    }\n    get minimumHeight() {\n        return this._minimumHeight;\n    }\n    get maximumWidth() {\n        return this._maximumWidth;\n    }\n    get maximumHeight() {\n        return this._maximumHeight;\n    }\n    constructor(id, component, tabComponent, accessor, containerApi, group, view, options) {\n        super();\n        this.id = id;\n        this.accessor = accessor;\n        this.containerApi = containerApi;\n        this.view = view;\n        this._renderer = options.renderer;\n        this._group = group;\n        this._minimumWidth = options.minimumWidth;\n        this._minimumHeight = options.minimumHeight;\n        this._maximumWidth = options.maximumWidth;\n        this._maximumHeight = options.maximumHeight;\n        this.api = new DockviewPanelApiImpl(this, this._group, accessor, component, tabComponent);\n        this.addDisposables(this.api.onActiveChange(() => {\n            accessor.setActivePanel(this);\n        }), this.api.onDidSizeChange((event) => {\n            // forward the resize event to the group since if you want to resize a panel\n            // you are actually just resizing the panels parent which is the group\n            this.group.api.setSize(event);\n        }), this.api.onDidRendererChange(() => {\n            this.group.model.rerender(this);\n        }));\n    }\n    init(params) {\n        this._params = params.params;\n        this.view.init(Object.assign(Object.assign({}, params), { api: this.api, containerApi: this.containerApi }));\n        this.setTitle(params.title);\n    }\n    focus() {\n        const event = new WillFocusEvent();\n        this.api._onWillFocus.fire(event);\n        if (event.defaultPrevented) {\n            return;\n        }\n        if (!this.api.isActive) {\n            this.api.setActive();\n        }\n    }\n    toJSON() {\n        return {\n            id: this.id,\n            contentComponent: this.view.contentComponent,\n            tabComponent: this.view.tabComponent,\n            params: Object.keys(this._params || {}).length > 0\n                ? this._params\n                : undefined,\n            title: this.title,\n            renderer: this._renderer,\n            minimumHeight: this._minimumHeight,\n            maximumHeight: this._maximumHeight,\n            minimumWidth: this._minimumWidth,\n            maximumWidth: this._maximumWidth,\n        };\n    }\n    setTitle(title) {\n        const didTitleChange = title !== this.title;\n        if (didTitleChange) {\n            this._title = title;\n            this.api._onDidTitleChange.fire({ title });\n        }\n    }\n    setRenderer(renderer) {\n        const didChange = renderer !== this.renderer;\n        if (didChange) {\n            this._renderer = renderer;\n            this.api._onDidRendererChange.fire({\n                renderer: renderer,\n            });\n        }\n    }\n    update(event) {\n        var _a;\n        // merge the new parameters with the existing parameters\n        this._params = Object.assign(Object.assign({}, ((_a = this._params) !== null && _a !== void 0 ? _a : {})), event.params);\n        /**\n         * delete new keys that have a value of undefined,\n         * allow values of null\n         */\n        for (const key of Object.keys(event.params)) {\n            if (event.params[key] === undefined) {\n                delete this._params[key];\n            }\n        }\n        // update the view with the updated props\n        this.view.update({\n            params: this._params,\n        });\n    }\n    updateParentGroup(group, options) {\n        this._group = group;\n        this.api.group = this._group;\n        const isPanelVisible = this._group.model.isPanelActive(this);\n        const isActive = this.group.api.isActive && isPanelVisible;\n        if (!(options === null || options === void 0 ? void 0 : options.skipSetActive)) {\n            if (this.api.isActive !== isActive) {\n                this.api._onDidActiveChange.fire({\n                    isActive: this.group.api.isActive && isPanelVisible,\n                });\n            }\n        }\n        if (this.api.isVisible !== isPanelVisible) {\n            this.api._onDidVisibilityChange.fire({\n                isVisible: isPanelVisible,\n            });\n        }\n    }\n    runEvents() {\n        const isPanelVisible = this._group.model.isPanelActive(this);\n        const isActive = this.group.api.isActive && isPanelVisible;\n        if (this.api.isActive !== isActive) {\n            this.api._onDidActiveChange.fire({\n                isActive: this.group.api.isActive && isPanelVisible,\n            });\n        }\n        if (this.api.isVisible !== isPanelVisible) {\n            this.api._onDidVisibilityChange.fire({\n                isVisible: isPanelVisible,\n            });\n        }\n    }\n    layout(width, height) {\n        // TODO: Can we somehow do height without header height or indicate what the header height is?\n        this.api._onDidDimensionChange.fire({\n            width,\n            height: height,\n        });\n        this.view.layout(width, height);\n    }\n    dispose() {\n        this.api.dispose();\n        this.view.dispose();\n    }\n}\n","import { CompositeDisposable } from '../../../lifecycle';\nimport { addDisposableListener } from '../../../events';\nimport { createCloseButton } from '../../../svg';\nexport class DefaultTab extends CompositeDisposable {\n    get element() {\n        return this._element;\n    }\n    constructor() {\n        super();\n        this._element = document.createElement('div');\n        this._element.className = 'dv-default-tab';\n        this._content = document.createElement('div');\n        this._content.className = 'dv-default-tab-content';\n        this.action = document.createElement('div');\n        this.action.className = 'dv-default-tab-action';\n        this.action.appendChild(createCloseButton());\n        this._element.appendChild(this._content);\n        this._element.appendChild(this.action);\n        this.render();\n    }\n    init(params) {\n        this._title = params.title;\n        this.addDisposables(params.api.onDidTitleChange((event) => {\n            this._title = event.title;\n            this.render();\n        }), addDisposableListener(this.action, 'pointerdown', (ev) => {\n            ev.preventDefault();\n        }), addDisposableListener(this.action, 'click', (ev) => {\n            if (ev.defaultPrevented) {\n                return;\n            }\n            ev.preventDefault();\n            params.api.close();\n        }));\n        this.render();\n    }\n    render() {\n        var _a;\n        if (this._content.textContent !== this._title) {\n            this._content.textContent = (_a = this._title) !== null && _a !== void 0 ? _a : '';\n        }\n    }\n}\n","import { DefaultTab } from './components/tab/defaultTab';\nexport class DockviewPanelModel {\n    get content() {\n        return this._content;\n    }\n    get tab() {\n        return this._tab;\n    }\n    constructor(accessor, id, contentComponent, tabComponent) {\n        this.accessor = accessor;\n        this.id = id;\n        this.contentComponent = contentComponent;\n        this.tabComponent = tabComponent;\n        this._content = this.createContentComponent(this.id, contentComponent);\n        this._tab = this.createTabComponent(this.id, tabComponent);\n    }\n    createTabRenderer(tabLocation) {\n        var _a;\n        const cmp = this.createTabComponent(this.id, this.tabComponent);\n        if (this._params) {\n            cmp.init(Object.assign(Object.assign({}, this._params), { tabLocation }));\n        }\n        if (this._updateEvent) {\n            (_a = cmp.update) === null || _a === void 0 ? void 0 : _a.call(cmp, this._updateEvent);\n        }\n        return cmp;\n    }\n    init(params) {\n        this._params = params;\n        this.content.init(params);\n        this.tab.init(Object.assign(Object.assign({}, params), { tabLocation: 'header' }));\n    }\n    layout(width, height) {\n        var _a, _b;\n        (_b = (_a = this.content).layout) === null || _b === void 0 ? void 0 : _b.call(_a, width, height);\n    }\n    update(event) {\n        var _a, _b, _c, _d;\n        this._updateEvent = event;\n        (_b = (_a = this.content).update) === null || _b === void 0 ? void 0 : _b.call(_a, event);\n        (_d = (_c = this.tab).update) === null || _d === void 0 ? void 0 : _d.call(_c, event);\n    }\n    dispose() {\n        var _a, _b, _c, _d;\n        (_b = (_a = this.content).dispose) === null || _b === void 0 ? void 0 : _b.call(_a);\n        (_d = (_c = this.tab).dispose) === null || _d === void 0 ? void 0 : _d.call(_c);\n    }\n    createContentComponent(id, componentName) {\n        return this.accessor.options.createComponent({\n            id,\n            name: componentName,\n        });\n    }\n    createTabComponent(id, componentName) {\n        const name = componentName !== null && componentName !== void 0 ? componentName : this.accessor.options.defaultTabComponent;\n        if (name) {\n            if (this.accessor.options.createTabComponent) {\n                const component = this.accessor.options.createTabComponent({\n                    id,\n                    name,\n                });\n                if (component) {\n                    return component;\n                }\n                else {\n                    return new DefaultTab();\n                }\n            }\n            console.warn(`dockview: tabComponent '${componentName}' was not found. falling back to the default tab.`);\n        }\n        return new DefaultTab();\n    }\n}\n","import { DockviewPanel } from './dockviewPanel';\nimport { DockviewPanelModel } from './dockviewPanelModel';\nimport { DockviewApi } from '../api/component.api';\nexport class DefaultDockviewDeserialzier {\n    constructor(accessor) {\n        this.accessor = accessor;\n    }\n    fromJSON(panelData, group) {\n        var _a, _b;\n        const panelId = panelData.id;\n        const params = panelData.params;\n        const title = panelData.title;\n        const viewData = panelData.view;\n        const contentComponent = viewData\n            ? viewData.content.id\n            : (_a = panelData.contentComponent) !== null && _a !== void 0 ? _a : 'unknown';\n        const tabComponent = viewData\n            ? (_b = viewData.tab) === null || _b === void 0 ? void 0 : _b.id\n            : panelData.tabComponent;\n        const view = new DockviewPanelModel(this.accessor, panelId, contentComponent, tabComponent);\n        const panel = new DockviewPanel(panelId, contentComponent, tabComponent, this.accessor, new DockviewApi(this.accessor), group, view, {\n            renderer: panelData.renderer,\n            minimumWidth: panelData.minimumWidth,\n            minimumHeight: panelData.minimumHeight,\n            maximumWidth: panelData.maximumWidth,\n            maximumHeight: panelData.maximumHeight,\n        });\n        panel.init({\n            title: title !== null && title !== void 0 ? title : panelId,\n            params: params !== null && params !== void 0 ? params : {},\n        });\n        return panel;\n    }\n}\n","import { CompositeDisposable } from '../../../lifecycle';\nexport class Watermark extends CompositeDisposable {\n    get element() {\n        return this._element;\n    }\n    constructor() {\n        super();\n        this._element = document.createElement('div');\n        this._element.className = 'dv-watermark';\n    }\n    init(_params) {\n        // noop\n    }\n}\n","import { disableIframePointEvents, quasiDefaultPrevented, toggleClass, } from '../dom';\nimport { Emitter, addDisposableListener, } from '../events';\nimport { CompositeDisposable, MutableDisposable } from '../lifecycle';\nimport { clamp } from '../math';\nclass AriaLevelTracker {\n    constructor() {\n        this._orderedList = [];\n    }\n    push(element) {\n        this._orderedList = [\n            ...this._orderedList.filter((item) => item !== element),\n            element,\n        ];\n        this.update();\n    }\n    destroy(element) {\n        this._orderedList = this._orderedList.filter((item) => item !== element);\n        this.update();\n    }\n    update() {\n        for (let i = 0; i < this._orderedList.length; i++) {\n            this._orderedList[i].setAttribute('aria-level', `${i}`);\n            this._orderedList[i].style.zIndex = `calc(var(--dv-overlay-z-index, 999) + ${i * 2})`;\n        }\n    }\n}\nconst arialLevelTracker = new AriaLevelTracker();\nexport class Overlay extends CompositeDisposable {\n    set minimumInViewportWidth(value) {\n        this.options.minimumInViewportWidth = value;\n    }\n    set minimumInViewportHeight(value) {\n        this.options.minimumInViewportHeight = value;\n    }\n    get element() {\n        return this._element;\n    }\n    get isVisible() {\n        return this._isVisible;\n    }\n    constructor(options) {\n        super();\n        this.options = options;\n        this._element = document.createElement('div');\n        this._onDidChange = new Emitter();\n        this.onDidChange = this._onDidChange.event;\n        this._onDidChangeEnd = new Emitter();\n        this.onDidChangeEnd = this._onDidChangeEnd.event;\n        this.addDisposables(this._onDidChange, this._onDidChangeEnd);\n        this._element.className = 'dv-resize-container';\n        this._isVisible = true;\n        this.setupResize('top');\n        this.setupResize('bottom');\n        this.setupResize('left');\n        this.setupResize('right');\n        this.setupResize('topleft');\n        this.setupResize('topright');\n        this.setupResize('bottomleft');\n        this.setupResize('bottomright');\n        this._element.appendChild(this.options.content);\n        this.options.container.appendChild(this._element);\n        // if input bad resize within acceptable boundaries\n        this.setBounds(Object.assign(Object.assign(Object.assign(Object.assign({ height: this.options.height, width: this.options.width }, ('top' in this.options && { top: this.options.top })), ('bottom' in this.options && { bottom: this.options.bottom })), ('left' in this.options && { left: this.options.left })), ('right' in this.options && { right: this.options.right })));\n        arialLevelTracker.push(this._element);\n    }\n    setVisible(isVisible) {\n        if (isVisible === this.isVisible) {\n            return;\n        }\n        this._isVisible = isVisible;\n        toggleClass(this.element, 'dv-hidden', !this.isVisible);\n    }\n    bringToFront() {\n        arialLevelTracker.push(this._element);\n    }\n    setBounds(bounds = {}) {\n        if (typeof bounds.height === 'number') {\n            this._element.style.height = `${bounds.height}px`;\n        }\n        if (typeof bounds.width === 'number') {\n            this._element.style.width = `${bounds.width}px`;\n        }\n        if ('top' in bounds && typeof bounds.top === 'number') {\n            this._element.style.top = `${bounds.top}px`;\n            this._element.style.bottom = 'auto';\n            this.verticalAlignment = 'top';\n        }\n        if ('bottom' in bounds && typeof bounds.bottom === 'number') {\n            this._element.style.bottom = `${bounds.bottom}px`;\n            this._element.style.top = 'auto';\n            this.verticalAlignment = 'bottom';\n        }\n        if ('left' in bounds && typeof bounds.left === 'number') {\n            this._element.style.left = `${bounds.left}px`;\n            this._element.style.right = 'auto';\n            this.horiziontalAlignment = 'left';\n        }\n        if ('right' in bounds && typeof bounds.right === 'number') {\n            this._element.style.right = `${bounds.right}px`;\n            this._element.style.left = 'auto';\n            this.horiziontalAlignment = 'right';\n        }\n        const containerRect = this.options.container.getBoundingClientRect();\n        const overlayRect = this._element.getBoundingClientRect();\n        // region: ensure bounds within allowable limits\n        // a minimum width of minimumViewportWidth must be inside the viewport\n        const xOffset = Math.max(0, this.getMinimumWidth(overlayRect.width));\n        // a minimum height of minimumViewportHeight must be inside the viewport\n        const yOffset = Math.max(0, this.getMinimumHeight(overlayRect.height));\n        if (this.verticalAlignment === 'top') {\n            const top = clamp(overlayRect.top - containerRect.top, -yOffset, Math.max(0, containerRect.height - overlayRect.height + yOffset));\n            this._element.style.top = `${top}px`;\n            this._element.style.bottom = 'auto';\n        }\n        if (this.verticalAlignment === 'bottom') {\n            const bottom = clamp(containerRect.bottom - overlayRect.bottom, -yOffset, Math.max(0, containerRect.height - overlayRect.height + yOffset));\n            this._element.style.bottom = `${bottom}px`;\n            this._element.style.top = 'auto';\n        }\n        if (this.horiziontalAlignment === 'left') {\n            const left = clamp(overlayRect.left - containerRect.left, -xOffset, Math.max(0, containerRect.width - overlayRect.width + xOffset));\n            this._element.style.left = `${left}px`;\n            this._element.style.right = 'auto';\n        }\n        if (this.horiziontalAlignment === 'right') {\n            const right = clamp(containerRect.right - overlayRect.right, -xOffset, Math.max(0, containerRect.width - overlayRect.width + xOffset));\n            this._element.style.right = `${right}px`;\n            this._element.style.left = 'auto';\n        }\n        this._onDidChange.fire();\n    }\n    toJSON() {\n        const container = this.options.container.getBoundingClientRect();\n        const element = this._element.getBoundingClientRect();\n        const result = {};\n        if (this.verticalAlignment === 'top') {\n            result.top = parseFloat(this._element.style.top);\n        }\n        else if (this.verticalAlignment === 'bottom') {\n            result.bottom = parseFloat(this._element.style.bottom);\n        }\n        else {\n            result.top = element.top - container.top;\n        }\n        if (this.horiziontalAlignment === 'left') {\n            result.left = parseFloat(this._element.style.left);\n        }\n        else if (this.horiziontalAlignment === 'right') {\n            result.right = parseFloat(this._element.style.right);\n        }\n        else {\n            result.left = element.left - container.left;\n        }\n        result.width = element.width;\n        result.height = element.height;\n        return result;\n    }\n    setupDrag(dragTarget, options = { inDragMode: false }) {\n        const move = new MutableDisposable();\n        const track = () => {\n            let offset = null;\n            const iframes = disableIframePointEvents();\n            move.value = new CompositeDisposable({\n                dispose: () => {\n                    iframes.release();\n                },\n            }, addDisposableListener(window, 'pointermove', (e) => {\n                const containerRect = this.options.container.getBoundingClientRect();\n                const x = e.clientX - containerRect.left;\n                const y = e.clientY - containerRect.top;\n                toggleClass(this._element, 'dv-resize-container-dragging', true);\n                const overlayRect = this._element.getBoundingClientRect();\n                if (offset === null) {\n                    offset = {\n                        x: e.clientX - overlayRect.left,\n                        y: e.clientY - overlayRect.top,\n                    };\n                }\n                const xOffset = Math.max(0, this.getMinimumWidth(overlayRect.width));\n                const yOffset = Math.max(0, this.getMinimumHeight(overlayRect.height));\n                const top = clamp(y - offset.y, -yOffset, Math.max(0, containerRect.height - overlayRect.height + yOffset));\n                const bottom = clamp(offset.y -\n                    y +\n                    containerRect.height -\n                    overlayRect.height, -yOffset, Math.max(0, containerRect.height - overlayRect.height + yOffset));\n                const left = clamp(x - offset.x, -xOffset, Math.max(0, containerRect.width - overlayRect.width + xOffset));\n                const right = clamp(offset.x - x + containerRect.width - overlayRect.width, -xOffset, Math.max(0, containerRect.width - overlayRect.width + xOffset));\n                const bounds = {};\n                // Anchor to top or to bottom depending on which one is closer\n                if (top <= bottom) {\n                    bounds.top = top;\n                }\n                else {\n                    bounds.bottom = bottom;\n                }\n                // Anchor to left or to right depending on which one is closer\n                if (left <= right) {\n                    bounds.left = left;\n                }\n                else {\n                    bounds.right = right;\n                }\n                this.setBounds(bounds);\n            }), addDisposableListener(window, 'pointerup', () => {\n                toggleClass(this._element, 'dv-resize-container-dragging', false);\n                move.dispose();\n                this._onDidChangeEnd.fire();\n            }));\n        };\n        this.addDisposables(move, addDisposableListener(dragTarget, 'pointerdown', (event) => {\n            if (event.defaultPrevented) {\n                event.preventDefault();\n                return;\n            }\n            // if somebody has marked this event then treat as a defaultPrevented\n            // without actually calling event.preventDefault()\n            if (quasiDefaultPrevented(event)) {\n                return;\n            }\n            track();\n        }), addDisposableListener(this.options.content, 'pointerdown', (event) => {\n            if (event.defaultPrevented) {\n                return;\n            }\n            // if somebody has marked this event then treat as a defaultPrevented\n            // without actually calling event.preventDefault()\n            if (quasiDefaultPrevented(event)) {\n                return;\n            }\n            if (event.shiftKey) {\n                track();\n            }\n        }), addDisposableListener(this.options.content, 'pointerdown', () => {\n            arialLevelTracker.push(this._element);\n        }, true));\n        if (options.inDragMode) {\n            track();\n        }\n    }\n    setupResize(direction) {\n        const resizeHandleElement = document.createElement('div');\n        resizeHandleElement.className = `dv-resize-handle-${direction}`;\n        this._element.appendChild(resizeHandleElement);\n        const move = new MutableDisposable();\n        this.addDisposables(move, addDisposableListener(resizeHandleElement, 'pointerdown', (e) => {\n            e.preventDefault();\n            let startPosition = null;\n            const iframes = disableIframePointEvents();\n            move.value = new CompositeDisposable(addDisposableListener(window, 'pointermove', (e) => {\n                const containerRect = this.options.container.getBoundingClientRect();\n                const overlayRect = this._element.getBoundingClientRect();\n                const y = e.clientY - containerRect.top;\n                const x = e.clientX - containerRect.left;\n                if (startPosition === null) {\n                    // record the initial dimensions since as all subsequence moves are relative to this\n                    startPosition = {\n                        originalY: y,\n                        originalHeight: overlayRect.height,\n                        originalX: x,\n                        originalWidth: overlayRect.width,\n                    };\n                }\n                let top = undefined;\n                let bottom = undefined;\n                let height = undefined;\n                let left = undefined;\n                let right = undefined;\n                let width = undefined;\n                const moveTop = () => {\n                    top = clamp(y, -Number.MAX_VALUE, startPosition.originalY +\n                        startPosition.originalHeight >\n                        containerRect.height\n                        ? this.getMinimumHeight(containerRect.height)\n                        : Math.max(0, startPosition.originalY +\n                            startPosition.originalHeight -\n                            Overlay.MINIMUM_HEIGHT));\n                    height =\n                        startPosition.originalY +\n                            startPosition.originalHeight -\n                            top;\n                    bottom = containerRect.height - top - height;\n                };\n                const moveBottom = () => {\n                    top =\n                        startPosition.originalY -\n                            startPosition.originalHeight;\n                    height = clamp(y - top, top < 0 &&\n                        typeof this.options\n                            .minimumInViewportHeight === 'number'\n                        ? -top +\n                            this.options.minimumInViewportHeight\n                        : Overlay.MINIMUM_HEIGHT, Number.MAX_VALUE);\n                    bottom = containerRect.height - top - height;\n                };\n                const moveLeft = () => {\n                    left = clamp(x, -Number.MAX_VALUE, startPosition.originalX +\n                        startPosition.originalWidth >\n                        containerRect.width\n                        ? this.getMinimumWidth(containerRect.width)\n                        : Math.max(0, startPosition.originalX +\n                            startPosition.originalWidth -\n                            Overlay.MINIMUM_WIDTH));\n                    width =\n                        startPosition.originalX +\n                            startPosition.originalWidth -\n                            left;\n                    right = containerRect.width - left - width;\n                };\n                const moveRight = () => {\n                    left =\n                        startPosition.originalX -\n                            startPosition.originalWidth;\n                    width = clamp(x - left, left < 0 &&\n                        typeof this.options\n                            .minimumInViewportWidth === 'number'\n                        ? -left +\n                            this.options.minimumInViewportWidth\n                        : Overlay.MINIMUM_WIDTH, Number.MAX_VALUE);\n                    right = containerRect.width - left - width;\n                };\n                switch (direction) {\n                    case 'top':\n                        moveTop();\n                        break;\n                    case 'bottom':\n                        moveBottom();\n                        break;\n                    case 'left':\n                        moveLeft();\n                        break;\n                    case 'right':\n                        moveRight();\n                        break;\n                    case 'topleft':\n                        moveTop();\n                        moveLeft();\n                        break;\n                    case 'topright':\n                        moveTop();\n                        moveRight();\n                        break;\n                    case 'bottomleft':\n                        moveBottom();\n                        moveLeft();\n                        break;\n                    case 'bottomright':\n                        moveBottom();\n                        moveRight();\n                        break;\n                }\n                const bounds = {};\n                // Anchor to top or to bottom depending on which one is closer\n                if (top <= bottom) {\n                    bounds.top = top;\n                }\n                else {\n                    bounds.bottom = bottom;\n                }\n                // Anchor to left or to right depending on which one is closer\n                if (left <= right) {\n                    bounds.left = left;\n                }\n                else {\n                    bounds.right = right;\n                }\n                bounds.height = height;\n                bounds.width = width;\n                this.setBounds(bounds);\n            }), {\n                dispose: () => {\n                    iframes.release();\n                },\n            }, addDisposableListener(window, 'pointerup', () => {\n                move.dispose();\n                this._onDidChangeEnd.fire();\n            }));\n        }));\n    }\n    getMinimumWidth(width) {\n        if (typeof this.options.minimumInViewportWidth === 'number') {\n            return width - this.options.minimumInViewportWidth;\n        }\n        return 0;\n    }\n    getMinimumHeight(height) {\n        if (typeof this.options.minimumInViewportHeight === 'number') {\n            return height - this.options.minimumInViewportHeight;\n        }\n        return 0;\n    }\n    dispose() {\n        arialLevelTracker.destroy(this._element);\n        this._element.remove();\n        super.dispose();\n    }\n}\nOverlay.MINIMUM_HEIGHT = 20;\nOverlay.MINIMUM_WIDTH = 20;\n","import { CompositeDisposable } from '../lifecycle';\nexport class DockviewFloatingGroupPanel extends CompositeDisposable {\n    constructor(group, overlay) {\n        super();\n        this.group = group;\n        this.overlay = overlay;\n        this.addDisposables(overlay);\n    }\n    position(bounds) {\n        this.overlay.setBounds(bounds);\n    }\n}\n","export const DEFAULT_FLOATING_GROUP_OVERFLOW_SIZE = 100;\nexport const DEFAULT_FLOATING_GROUP_POSITION = { left: 100, top: 100, width: 300, height: 300 };\nexport const DESERIALIZATION_POPOUT_DELAY_MS = 100;\n","import { DragAndDropObserver } from '../dnd/dnd';\nimport { getDomNodePagePosition, toggleClass } from '../dom';\nimport { CompositeDisposable, Disposable, MutableDisposable, } from '../lifecycle';\nclass PositionCache {\n    constructor() {\n        this.cache = new Map();\n        this.currentFrameId = 0;\n        this.rafId = null;\n    }\n    getPosition(element) {\n        const cached = this.cache.get(element);\n        if (cached && cached.frameId === this.currentFrameId) {\n            return cached.rect;\n        }\n        this.scheduleFrameUpdate();\n        const rect = getDomNodePagePosition(element);\n        this.cache.set(element, { rect, frameId: this.currentFrameId });\n        return rect;\n    }\n    invalidate() {\n        this.currentFrameId++;\n    }\n    scheduleFrameUpdate() {\n        if (this.rafId)\n            return;\n        this.rafId = requestAnimationFrame(() => {\n            this.currentFrameId++;\n            this.rafId = null;\n        });\n    }\n}\nfunction createFocusableElement() {\n    const element = document.createElement('div');\n    element.tabIndex = -1;\n    return element;\n}\nexport class OverlayRenderContainer extends CompositeDisposable {\n    constructor(element, accessor) {\n        super();\n        this.element = element;\n        this.accessor = accessor;\n        this.map = {};\n        this._disposed = false;\n        this.positionCache = new PositionCache();\n        this.pendingUpdates = new Set();\n        this.addDisposables(Disposable.from(() => {\n            for (const value of Object.values(this.map)) {\n                value.disposable.dispose();\n                value.destroy.dispose();\n            }\n            this._disposed = true;\n        }));\n    }\n    updateAllPositions() {\n        if (this._disposed) {\n            return;\n        }\n        // Invalidate position cache to force recalculation\n        this.positionCache.invalidate();\n        // Call resize function directly for all visible panels\n        for (const entry of Object.values(this.map)) {\n            if (entry.panel.api.isVisible && entry.resize) {\n                entry.resize();\n            }\n        }\n    }\n    detatch(panel) {\n        if (this.map[panel.api.id]) {\n            const { disposable, destroy } = this.map[panel.api.id];\n            disposable.dispose();\n            destroy.dispose();\n            delete this.map[panel.api.id];\n            return true;\n        }\n        return false;\n    }\n    attach(options) {\n        const { panel, referenceContainer } = options;\n        if (!this.map[panel.api.id]) {\n            const element = createFocusableElement();\n            element.className = 'dv-render-overlay';\n            this.map[panel.api.id] = {\n                panel,\n                disposable: Disposable.NONE,\n                destroy: Disposable.NONE,\n                element,\n            };\n        }\n        const focusContainer = this.map[panel.api.id].element;\n        if (panel.view.content.element.parentElement !== focusContainer) {\n            focusContainer.appendChild(panel.view.content.element);\n        }\n        if (focusContainer.parentElement !== this.element) {\n            this.element.appendChild(focusContainer);\n        }\n        const resize = () => {\n            const panelId = panel.api.id;\n            if (this.pendingUpdates.has(panelId)) {\n                return; // Update already scheduled\n            }\n            this.pendingUpdates.add(panelId);\n            requestAnimationFrame(() => {\n                this.pendingUpdates.delete(panelId);\n                if (this.isDisposed || !this.map[panelId]) {\n                    return;\n                }\n                const box = this.positionCache.getPosition(referenceContainer.element);\n                const box2 = this.positionCache.getPosition(this.element);\n                // Use traditional positioning for overlay containers\n                const left = box.left - box2.left;\n                const top = box.top - box2.top;\n                const width = box.width;\n                const height = box.height;\n                focusContainer.style.left = `${left}px`;\n                focusContainer.style.top = `${top}px`;\n                focusContainer.style.width = `${width}px`;\n                focusContainer.style.height = `${height}px`;\n                toggleClass(focusContainer, 'dv-render-overlay-float', panel.group.api.location.type === 'floating');\n            });\n        };\n        const visibilityChanged = () => {\n            if (panel.api.isVisible) {\n                this.positionCache.invalidate();\n                resize();\n            }\n            focusContainer.style.display = panel.api.isVisible ? '' : 'none';\n        };\n        const observerDisposable = new MutableDisposable();\n        const correctLayerPosition = () => {\n            if (panel.api.location.type === 'floating') {\n                queueMicrotask(() => {\n                    const floatingGroup = this.accessor.floatingGroups.find((group) => group.group === panel.api.group);\n                    if (!floatingGroup) {\n                        return;\n                    }\n                    const element = floatingGroup.overlay.element;\n                    const update = () => {\n                        const level = Number(element.getAttribute('aria-level'));\n                        focusContainer.style.zIndex = `calc(var(--dv-overlay-z-index, 999) + ${level * 2 + 1})`;\n                    };\n                    const observer = new MutationObserver(() => {\n                        update();\n                    });\n                    observerDisposable.value = Disposable.from(() => observer.disconnect());\n                    observer.observe(element, {\n                        attributeFilter: ['aria-level'],\n                        attributes: true,\n                    });\n                    update();\n                });\n            }\n            else {\n                focusContainer.style.zIndex = ''; // reset the z-index, perhaps CSS will take over here\n            }\n        };\n        const disposable = new CompositeDisposable(observerDisposable, \n        /**\n         * since container is positioned absoutely we must explicitly forward\n         * the dnd events for the expect behaviours to continue to occur in terms of dnd\n         *\n         * the dnd observer does not need to be conditional on whether the panel is visible since\n         * non-visible panels are 'display: none' and in such case the dnd observer will not fire.\n         */\n        new DragAndDropObserver(focusContainer, {\n            onDragEnd: (e) => {\n                referenceContainer.dropTarget.dnd.onDragEnd(e);\n            },\n            onDragEnter: (e) => {\n                referenceContainer.dropTarget.dnd.onDragEnter(e);\n            },\n            onDragLeave: (e) => {\n                referenceContainer.dropTarget.dnd.onDragLeave(e);\n            },\n            onDrop: (e) => {\n                referenceContainer.dropTarget.dnd.onDrop(e);\n            },\n            onDragOver: (e) => {\n                referenceContainer.dropTarget.dnd.onDragOver(e);\n            },\n        }), panel.api.onDidVisibilityChange(() => {\n            /**\n             * Control the visibility of the content, however even when not visible (display: none)\n             * the content is still maintained within the DOM hence DOM specific attributes\n             * such as scroll position are maintained when next made visible.\n             */\n            visibilityChanged();\n        }), panel.api.onDidDimensionsChange(() => {\n            if (!panel.api.isVisible) {\n                return;\n            }\n            resize();\n        }), panel.api.onDidLocationChange(() => {\n            correctLayerPosition();\n        }));\n        this.map[panel.api.id].destroy = Disposable.from(() => {\n            var _a;\n            if (panel.view.content.element.parentElement === focusContainer) {\n                focusContainer.removeChild(panel.view.content.element);\n            }\n            (_a = focusContainer.parentElement) === null || _a === void 0 ? void 0 : _a.removeChild(focusContainer);\n        });\n        correctLayerPosition();\n        queueMicrotask(() => {\n            if (this.isDisposed) {\n                return;\n            }\n            /**\n             * wait until everything has finished in the current stack-frame call before\n             * calling the first resize as other size-altering events may still occur before\n             * the end of the stack-frame.\n             */\n            visibilityChanged();\n        });\n        // dispose of logic asoccciated with previous reference-container\n        this.map[panel.api.id].disposable.dispose();\n        // and reset the disposable to the active reference-container\n        this.map[panel.api.id].disposable = disposable;\n        // store the resize function for direct access\n        this.map[panel.api.id].resize = resize;\n        return focusContainer;\n    }\n}\n","/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise, SuppressedError, Symbol */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __esDecorate(ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\r\n    function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\r\n    var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\r\n    var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\r\n    var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\r\n    var _, done = false;\r\n    for (var i = decorators.length - 1; i >= 0; i--) {\r\n        var context = {};\r\n        for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\r\n        for (var p in contextIn.access) context.access[p] = contextIn.access[p];\r\n        context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\r\n        var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\r\n        if (kind === \"accessor\") {\r\n            if (result === void 0) continue;\r\n            if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\r\n            if (_ = accept(result.get)) descriptor.get = _;\r\n            if (_ = accept(result.set)) descriptor.set = _;\r\n            if (_ = accept(result.init)) initializers.unshift(_);\r\n        }\r\n        else if (_ = accept(result)) {\r\n            if (kind === \"field\") initializers.unshift(_);\r\n            else descriptor[key] = _;\r\n        }\r\n    }\r\n    if (target) Object.defineProperty(target, contextIn.name, descriptor);\r\n    done = true;\r\n};\r\n\r\nexport function __runInitializers(thisArg, initializers, value) {\r\n    var useValue = arguments.length > 2;\r\n    for (var i = 0; i < initializers.length; i++) {\r\n        value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\r\n    }\r\n    return useValue ? value : void 0;\r\n};\r\n\r\nexport function __propKey(x) {\r\n    return typeof x === \"symbol\" ? x : \"\".concat(x);\r\n};\r\n\r\nexport function __setFunctionName(f, name, prefix) {\r\n    if (typeof name === \"symbol\") name = name.description ? \"[\".concat(name.description, \"]\") : \"\";\r\n    return Object.defineProperty(f, \"name\", { configurable: true, value: prefix ? \"\".concat(prefix, \" \", name) : name });\r\n};\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    var desc = Object.getOwnPropertyDescriptor(m, k);\r\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\r\n        desc = { enumerable: true, get: function() { return m[k]; } };\r\n    }\r\n    Object.defineProperty(o, k2, desc);\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: false } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n\r\nexport function __classPrivateFieldIn(state, receiver) {\r\n    if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\r\n    return typeof state === \"function\" ? receiver === state : state.has(receiver);\r\n}\r\n\r\nexport function __addDisposableResource(env, value, async) {\r\n    if (value !== null && value !== void 0) {\r\n        if (typeof value !== \"object\" && typeof value !== \"function\") throw new TypeError(\"Object expected.\");\r\n        var dispose;\r\n        if (async) {\r\n            if (!Symbol.asyncDispose) throw new TypeError(\"Symbol.asyncDispose is not defined.\");\r\n            dispose = value[Symbol.asyncDispose];\r\n        }\r\n        if (dispose === void 0) {\r\n            if (!Symbol.dispose) throw new TypeError(\"Symbol.dispose is not defined.\");\r\n            dispose = value[Symbol.dispose];\r\n        }\r\n        if (typeof dispose !== \"function\") throw new TypeError(\"Object not disposable.\");\r\n        env.stack.push({ value: value, dispose: dispose, async: async });\r\n    }\r\n    else if (async) {\r\n        env.stack.push({ async: true });\r\n    }\r\n    return value;\r\n}\r\n\r\nvar _SuppressedError = typeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\r\n    var e = new Error(message);\r\n    return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\r\n};\r\n\r\nexport function __disposeResources(env) {\r\n    function fail(e) {\r\n        env.error = env.hasError ? new _SuppressedError(e, env.error, \"An error was suppressed during disposal.\") : e;\r\n        env.hasError = true;\r\n    }\r\n    function next() {\r\n        while (env.stack.length) {\r\n            var rec = env.stack.pop();\r\n            try {\r\n                var result = rec.dispose && rec.dispose.call(rec.value);\r\n                if (rec.async) return Promise.resolve(result).then(next, function(e) { fail(e); return next(); });\r\n            }\r\n            catch (e) {\r\n                fail(e);\r\n            }\r\n        }\r\n        if (env.hasError) throw env.error;\r\n    }\r\n    return next();\r\n}\r\n\r\nexport default {\r\n    __extends: __extends,\r\n    __assign: __assign,\r\n    __rest: __rest,\r\n    __decorate: __decorate,\r\n    __param: __param,\r\n    __metadata: __metadata,\r\n    __awaiter: __awaiter,\r\n    __generator: __generator,\r\n    __createBinding: __createBinding,\r\n    __exportStar: __exportStar,\r\n    __values: __values,\r\n    __read: __read,\r\n    __spread: __spread,\r\n    __spreadArrays: __spreadArrays,\r\n    __spreadArray: __spreadArray,\r\n    __await: __await,\r\n    __asyncGenerator: __asyncGenerator,\r\n    __asyncDelegator: __asyncDelegator,\r\n    __asyncValues: __asyncValues,\r\n    __makeTemplateObject: __makeTemplateObject,\r\n    __importStar: __importStar,\r\n    __importDefault: __importDefault,\r\n    __classPrivateFieldGet: __classPrivateFieldGet,\r\n    __classPrivateFieldSet: __classPrivateFieldSet,\r\n    __classPrivateFieldIn: __classPrivateFieldIn,\r\n    __addDisposableResource: __addDisposableResource,\r\n    __disposeResources: __disposeResources,\r\n};\r\n","import { __awaiter } from \"tslib\";\nimport { addStyles } from './dom';\nimport { Emitter, addDisposableListener } from './events';\nimport { CompositeDisposable, Disposable } from './lifecycle';\nexport class PopoutWindow extends CompositeDisposable {\n    get window() {\n        var _a, _b;\n        return (_b = (_a = this._window) === null || _a === void 0 ? void 0 : _a.value) !== null && _b !== void 0 ? _b : null;\n    }\n    constructor(target, className, options) {\n        super();\n        this.target = target;\n        this.className = className;\n        this.options = options;\n        this._onWillClose = new Emitter();\n        this.onWillClose = this._onWillClose.event;\n        this._onDidClose = new Emitter();\n        this.onDidClose = this._onDidClose.event;\n        this._window = null;\n        this.addDisposables(this._onWillClose, this._onDidClose, {\n            dispose: () => {\n                this.close();\n            },\n        });\n    }\n    dimensions() {\n        if (!this._window) {\n            return null;\n        }\n        const left = this._window.value.screenX;\n        const top = this._window.value.screenY;\n        const width = this._window.value.innerWidth;\n        const height = this._window.value.innerHeight;\n        return { top, left, width, height };\n    }\n    close() {\n        var _a, _b;\n        if (this._window) {\n            this._onWillClose.fire();\n            (_b = (_a = this.options).onWillClose) === null || _b === void 0 ? void 0 : _b.call(_a, {\n                id: this.target,\n                window: this._window.value,\n            });\n            this._window.disposable.dispose();\n            this._window = null;\n            this._onDidClose.fire();\n        }\n    }\n    open() {\n        var _a, _b;\n        return __awaiter(this, void 0, void 0, function* () {\n            if (this._window) {\n                throw new Error('instance of popout window is already open');\n            }\n            const url = `${this.options.url}`;\n            const features = Object.entries({\n                top: this.options.top,\n                left: this.options.left,\n                width: this.options.width,\n                height: this.options.height,\n            })\n                .map(([key, value]) => `${key}=${value}`)\n                .join(',');\n            /**\n             * @see https://developer.mozilla.org/en-US/docs/Web/API/Window/open\n             */\n            const externalWindow = window.open(url, this.target, features);\n            if (!externalWindow) {\n                /**\n                 * Popup blocked\n                 */\n                return null;\n            }\n            const disposable = new CompositeDisposable();\n            this._window = { value: externalWindow, disposable };\n            disposable.addDisposables(Disposable.from(() => {\n                externalWindow.close();\n            }), addDisposableListener(window, 'beforeunload', () => {\n                /**\n                 * before the main window closes we should close this popup too\n                 * to be good citizens\n                 *\n                 * @see https://developer.mozilla.org/en-US/docs/Web/API/Window/beforeunload_event\n                 */\n                this.close();\n            }));\n            const container = this.createPopoutWindowContainer();\n            if (this.className) {\n                container.classList.add(this.className);\n            }\n            (_b = (_a = this.options).onDidOpen) === null || _b === void 0 ? void 0 : _b.call(_a, {\n                id: this.target,\n                window: externalWindow,\n            });\n            return new Promise((resolve, reject) => {\n                externalWindow.addEventListener('unload', (e) => {\n                    // if page fails to load before unloading\n                    // this.close();\n                });\n                externalWindow.addEventListener('load', () => {\n                    /**\n                     * @see https://developer.mozilla.org/en-US/docs/Web/API/Window/load_event\n                     */\n                    try {\n                        const externalDocument = externalWindow.document;\n                        externalDocument.title = document.title;\n                        externalDocument.body.appendChild(container);\n                        addStyles(externalDocument, window.document.styleSheets);\n                        /**\n                         * beforeunload must be registered after load for reasons I could not determine\n                         * otherwise the beforeunload event will not fire when the window is closed\n                         */\n                        addDisposableListener(externalWindow, 'beforeunload', () => {\n                            /**\n                             * @see https://developer.mozilla.org/en-US/docs/Web/API/Window/beforeunload_event\n                             */\n                            this.close();\n                        });\n                        resolve(container);\n                    }\n                    catch (err) {\n                        // only except this is the DOM isn't setup. e.g. in a in correctly configured test\n                        reject(err);\n                    }\n                });\n            });\n        });\n    }\n    createPopoutWindowContainer() {\n        const el = document.createElement('div');\n        el.classList.add('dv-popout-window');\n        el.id = 'dv-popout-window';\n        el.style.position = 'absolute';\n        el.style.width = '100%';\n        el.style.height = '100%';\n        el.style.top = '0px';\n        el.style.left = '0px';\n        return el;\n    }\n}\n","import { CompositeDisposable } from '../lifecycle';\nexport class StrictEventsSequencing extends CompositeDisposable {\n    constructor(accessor) {\n        super();\n        this.accessor = accessor;\n        this.init();\n    }\n    init() {\n        const panels = new Set();\n        const groups = new Set();\n        this.addDisposables(this.accessor.onDidAddPanel((panel) => {\n            if (panels.has(panel.api.id)) {\n                throw new Error(`dockview: Invalid event sequence. [onDidAddPanel] called for panel ${panel.api.id} but panel already exists`);\n            }\n            else {\n                panels.add(panel.api.id);\n            }\n        }), this.accessor.onDidRemovePanel((panel) => {\n            if (!panels.has(panel.api.id)) {\n                throw new Error(`dockview: Invalid event sequence. [onDidRemovePanel] called for panel ${panel.api.id} but panel does not exists`);\n            }\n            else {\n                panels.delete(panel.api.id);\n            }\n        }), this.accessor.onDidAddGroup((group) => {\n            if (groups.has(group.api.id)) {\n                throw new Error(`dockview: Invalid event sequence. [onDidAddGroup] called for group ${group.api.id} but group already exists`);\n            }\n            else {\n                groups.add(group.api.id);\n            }\n        }), this.accessor.onDidRemoveGroup((group) => {\n            if (!groups.has(group.api.id)) {\n                throw new Error(`dockview: Invalid event sequence. [onDidRemoveGroup] called for group ${group.api.id} but group does not exists`);\n            }\n            else {\n                groups.delete(group.api.id);\n            }\n        }));\n    }\n}\n","import { shiftAbsoluteElementIntoView } from '../../dom';\nimport { addDisposableListener } from '../../events';\nimport { CompositeDisposable, Disposable, MutableDisposable, } from '../../lifecycle';\nexport class PopupService extends CompositeDisposable {\n    constructor(root) {\n        super();\n        this.root = root;\n        this._active = null;\n        this._activeDisposable = new MutableDisposable();\n        this._element = document.createElement('div');\n        this._element.className = 'dv-popover-anchor';\n        this._element.style.position = 'relative';\n        this.root.prepend(this._element);\n        this.addDisposables(Disposable.from(() => {\n            this.close();\n        }), this._activeDisposable);\n    }\n    openPopover(element, position) {\n        var _a;\n        this.close();\n        const wrapper = document.createElement('div');\n        wrapper.style.position = 'absolute';\n        wrapper.style.zIndex = (_a = position.zIndex) !== null && _a !== void 0 ? _a : 'var(--dv-overlay-z-index)';\n        wrapper.appendChild(element);\n        const anchorBox = this._element.getBoundingClientRect();\n        const offsetX = anchorBox.left;\n        const offsetY = anchorBox.top;\n        wrapper.style.top = `${position.y - offsetY}px`;\n        wrapper.style.left = `${position.x - offsetX}px`;\n        this._element.appendChild(wrapper);\n        this._active = wrapper;\n        this._activeDisposable.value = new CompositeDisposable(addDisposableListener(window, 'pointerdown', (event) => {\n            var _a;\n            const target = event.target;\n            if (!(target instanceof HTMLElement)) {\n                return;\n            }\n            let el = target;\n            while (el && el !== wrapper) {\n                el = (_a = el === null || el === void 0 ? void 0 : el.parentElement) !== null && _a !== void 0 ? _a : null;\n            }\n            if (el) {\n                return; // clicked within popover\n            }\n            this.close();\n        }));\n        requestAnimationFrame(() => {\n            shiftAbsoluteElementIntoView(wrapper, this.root);\n        });\n    }\n    close() {\n        if (this._active) {\n            this._active.remove();\n            this._activeDisposable.dispose();\n            this._active = null;\n        }\n    }\n}\n","import { CompositeDisposable, Disposable } from '../lifecycle';\nexport class DropTargetAnchorContainer extends CompositeDisposable {\n    get disabled() {\n        return this._disabled;\n    }\n    set disabled(value) {\n        var _a;\n        if (this.disabled === value) {\n            return;\n        }\n        this._disabled = value;\n        if (value) {\n            (_a = this.model) === null || _a === void 0 ? void 0 : _a.clear();\n        }\n    }\n    get model() {\n        if (this.disabled) {\n            return undefined;\n        }\n        return {\n            clear: () => {\n                var _a;\n                if (this._model) {\n                    (_a = this._model.root.parentElement) === null || _a === void 0 ? void 0 : _a.removeChild(this._model.root);\n                }\n                this._model = undefined;\n            },\n            exists: () => {\n                return !!this._model;\n            },\n            getElements: (event, outline) => {\n                const changed = this._outline !== outline;\n                this._outline = outline;\n                if (this._model) {\n                    this._model.changed = changed;\n                    return this._model;\n                }\n                const container = this.createContainer();\n                const anchor = this.createAnchor();\n                this._model = { root: container, overlay: anchor, changed };\n                container.appendChild(anchor);\n                this.element.appendChild(container);\n                if ((event === null || event === void 0 ? void 0 : event.target) instanceof HTMLElement) {\n                    const targetBox = event.target.getBoundingClientRect();\n                    const box = this.element.getBoundingClientRect();\n                    anchor.style.left = `${targetBox.left - box.left}px`;\n                    anchor.style.top = `${targetBox.top - box.top}px`;\n                }\n                return this._model;\n            },\n        };\n    }\n    constructor(element, options) {\n        super();\n        this.element = element;\n        this._disabled = false;\n        this._disabled = options.disabled;\n        this.addDisposables(Disposable.from(() => {\n            var _a;\n            (_a = this.model) === null || _a === void 0 ? void 0 : _a.clear();\n        }));\n    }\n    createContainer() {\n        const el = document.createElement('div');\n        el.className = 'dv-drop-target-container';\n        return el;\n    }\n    createAnchor() {\n        const el = document.createElement('div');\n        el.className = 'dv-drop-target-anchor';\n        el.style.visibility = 'hidden';\n        return el;\n    }\n}\n","import { getRelativeLocation, getGridLocation, orthogonal, } from '../gridview/gridview';\nimport { directionToPosition, Droptarget, } from '../dnd/droptarget';\nimport { tail, sequenceEquals, remove } from '../array';\nimport { DockviewPanel } from './dockviewPanel';\nimport { CompositeDisposable, Disposable } from '../lifecycle';\nimport { Event, Emitter, addDisposableListener } from '../events';\nimport { Watermark } from './components/watermark/watermark';\nimport { sequentialNumberGenerator } from '../math';\nimport { DefaultDockviewDeserialzier } from './deserializer';\nimport { DockviewUnhandledDragOverEvent, isGroupOptionsWithGroup, isGroupOptionsWithPanel, isPanelOptionsWithGroup, isPanelOptionsWithPanel, } from './options';\nimport { BaseGrid, toTarget, } from '../gridview/baseComponentGridview';\nimport { DockviewApi } from '../api/component.api';\nimport { Orientation } from '../splitview/splitview';\nimport { DockviewDidDropEvent, DockviewWillDropEvent, } from './dockviewGroupPanelModel';\nimport { WillShowOverlayLocationEvent } from './events';\nimport { DockviewGroupPanel } from './dockviewGroupPanel';\nimport { DockviewPanelModel } from './dockviewPanelModel';\nimport { getPanelData } from '../dnd/dataTransfer';\nimport { Overlay } from '../overlay/overlay';\nimport { addTestId, Classnames, getDockviewTheme, onDidWindowResizeEnd, onDidWindowMoveEnd, toggleClass, watchElementResize, } from '../dom';\nimport { DockviewFloatingGroupPanel } from './dockviewFloatingGroupPanel';\nimport { DEFAULT_FLOATING_GROUP_OVERFLOW_SIZE, DEFAULT_FLOATING_GROUP_POSITION, DESERIALIZATION_POPOUT_DELAY_MS, } from '../constants';\nimport { OverlayRenderContainer, } from '../overlay/overlayRenderContainer';\nimport { PopoutWindow } from '../popoutWindow';\nimport { StrictEventsSequencing } from './strictEventsSequencing';\nimport { PopupService } from './components/popupService';\nimport { DropTargetAnchorContainer } from '../dnd/dropTargetAnchorContainer';\nimport { themeAbyss } from './theme';\nconst DEFAULT_ROOT_OVERLAY_MODEL = {\n    activationSize: { type: 'pixels', value: 10 },\n    size: { type: 'pixels', value: 20 },\n};\nfunction moveGroupWithoutDestroying(options) {\n    const activePanel = options.from.activePanel;\n    const panels = [...options.from.panels].map((panel) => {\n        const removedPanel = options.from.model.removePanel(panel);\n        options.from.model.renderContainer.detatch(panel);\n        return removedPanel;\n    });\n    panels.forEach((panel) => {\n        options.to.model.openPanel(panel, {\n            skipSetActive: activePanel !== panel,\n            skipSetGroupActive: true,\n        });\n    });\n}\nexport class DockviewComponent extends BaseGrid {\n    get orientation() {\n        return this.gridview.orientation;\n    }\n    get totalPanels() {\n        return this.panels.length;\n    }\n    get panels() {\n        return this.groups.flatMap((group) => group.panels);\n    }\n    get options() {\n        return this._options;\n    }\n    get activePanel() {\n        const activeGroup = this.activeGroup;\n        if (!activeGroup) {\n            return undefined;\n        }\n        return activeGroup.activePanel;\n    }\n    get renderer() {\n        var _a;\n        return (_a = this.options.defaultRenderer) !== null && _a !== void 0 ? _a : 'onlyWhenVisible';\n    }\n    get api() {\n        return this._api;\n    }\n    get floatingGroups() {\n        return this._floatingGroups;\n    }\n    /**\n     * Promise that resolves when all popout groups from the last fromJSON call are restored.\n     * Useful for tests that need to wait for delayed popout creation.\n     */\n    get popoutRestorationPromise() {\n        return this._popoutRestorationPromise;\n    }\n    constructor(container, options) {\n        var _a, _b, _c;\n        super(container, {\n            proportionalLayout: true,\n            orientation: Orientation.HORIZONTAL,\n            styles: options.hideBorders\n                ? { separatorBorder: 'transparent' }\n                : undefined,\n            disableAutoResizing: options.disableAutoResizing,\n            locked: options.locked,\n            margin: (_b = (_a = options.theme) === null || _a === void 0 ? void 0 : _a.gap) !== null && _b !== void 0 ? _b : 0,\n            className: options.className,\n        });\n        this.nextGroupId = sequentialNumberGenerator();\n        this._deserializer = new DefaultDockviewDeserialzier(this);\n        this._watermark = null;\n        this._onWillDragPanel = new Emitter();\n        this.onWillDragPanel = this._onWillDragPanel.event;\n        this._onWillDragGroup = new Emitter();\n        this.onWillDragGroup = this._onWillDragGroup.event;\n        this._onDidDrop = new Emitter();\n        this.onDidDrop = this._onDidDrop.event;\n        this._onWillDrop = new Emitter();\n        this.onWillDrop = this._onWillDrop.event;\n        this._onWillShowOverlay = new Emitter();\n        this.onWillShowOverlay = this._onWillShowOverlay.event;\n        this._onUnhandledDragOverEvent = new Emitter();\n        this.onUnhandledDragOverEvent = this._onUnhandledDragOverEvent.event;\n        this._onDidRemovePanel = new Emitter();\n        this.onDidRemovePanel = this._onDidRemovePanel.event;\n        this._onDidAddPanel = new Emitter();\n        this.onDidAddPanel = this._onDidAddPanel.event;\n        this._onDidPopoutGroupSizeChange = new Emitter();\n        this.onDidPopoutGroupSizeChange = this._onDidPopoutGroupSizeChange.event;\n        this._onDidPopoutGroupPositionChange = new Emitter();\n        this.onDidPopoutGroupPositionChange = this._onDidPopoutGroupPositionChange.event;\n        this._onDidOpenPopoutWindowFail = new Emitter();\n        this.onDidOpenPopoutWindowFail = this._onDidOpenPopoutWindowFail.event;\n        this._onDidLayoutFromJSON = new Emitter();\n        this.onDidLayoutFromJSON = this._onDidLayoutFromJSON.event;\n        this._onDidActivePanelChange = new Emitter({ replay: true });\n        this.onDidActivePanelChange = this._onDidActivePanelChange.event;\n        this._onDidMovePanel = new Emitter();\n        this.onDidMovePanel = this._onDidMovePanel.event;\n        this._onDidMaximizedGroupChange = new Emitter();\n        this.onDidMaximizedGroupChange = this._onDidMaximizedGroupChange.event;\n        this._floatingGroups = [];\n        this._popoutGroups = [];\n        this._popoutRestorationPromise = Promise.resolve();\n        this._onDidRemoveGroup = new Emitter();\n        this.onDidRemoveGroup = this._onDidRemoveGroup.event;\n        this._onDidAddGroup = new Emitter();\n        this.onDidAddGroup = this._onDidAddGroup.event;\n        this._onDidOptionsChange = new Emitter();\n        this.onDidOptionsChange = this._onDidOptionsChange.event;\n        this._onDidActiveGroupChange = new Emitter();\n        this.onDidActiveGroupChange = this._onDidActiveGroupChange.event;\n        this._moving = false;\n        this._options = options;\n        this.popupService = new PopupService(this.element);\n        this._themeClassnames = new Classnames(this.element);\n        this._api = new DockviewApi(this);\n        this.rootDropTargetContainer = new DropTargetAnchorContainer(this.element, { disabled: true });\n        this.overlayRenderContainer = new OverlayRenderContainer(this.gridview.element, this);\n        this._rootDropTarget = new Droptarget(this.element, {\n            className: 'dv-drop-target-edge',\n            canDisplayOverlay: (event, position) => {\n                const data = getPanelData();\n                if (data) {\n                    if (data.viewId !== this.id) {\n                        return false;\n                    }\n                    if (position === 'center') {\n                        // center drop target is only allowed if there are no panels in the grid\n                        // floating panels are allowed\n                        return this.gridview.length === 0;\n                    }\n                    return true;\n                }\n                if (position === 'center' && this.gridview.length !== 0) {\n                    /**\n                     * for external events only show the four-corner drag overlays, disable\n                     * the center position so that external drag events can fall through to the group\n                     * and panel drop target handlers\n                     */\n                    return false;\n                }\n                const firedEvent = new DockviewUnhandledDragOverEvent(event, 'edge', position, getPanelData);\n                this._onUnhandledDragOverEvent.fire(firedEvent);\n                return firedEvent.isAccepted;\n            },\n            acceptedTargetZones: ['top', 'bottom', 'left', 'right', 'center'],\n            overlayModel: (_c = options.rootOverlayModel) !== null && _c !== void 0 ? _c : DEFAULT_ROOT_OVERLAY_MODEL,\n            getOverrideTarget: () => { var _a; return (_a = this.rootDropTargetContainer) === null || _a === void 0 ? void 0 : _a.model; },\n        });\n        this.updateDropTargetModel(options);\n        toggleClass(this.gridview.element, 'dv-dockview', true);\n        toggleClass(this.element, 'dv-debug', !!options.debug);\n        this.updateTheme();\n        this.updateWatermark();\n        if (options.debug) {\n            this.addDisposables(new StrictEventsSequencing(this));\n        }\n        this.addDisposables(this.rootDropTargetContainer, this.overlayRenderContainer, this._onWillDragPanel, this._onWillDragGroup, this._onWillShowOverlay, this._onDidActivePanelChange, this._onDidAddPanel, this._onDidRemovePanel, this._onDidLayoutFromJSON, this._onDidDrop, this._onWillDrop, this._onDidMovePanel, this._onDidAddGroup, this._onDidRemoveGroup, this._onDidActiveGroupChange, this._onUnhandledDragOverEvent, this._onDidMaximizedGroupChange, this._onDidOptionsChange, this._onDidPopoutGroupSizeChange, this._onDidPopoutGroupPositionChange, this._onDidOpenPopoutWindowFail, this.onDidViewVisibilityChangeMicroTaskQueue(() => {\n            this.updateWatermark();\n        }), this.onDidAdd((event) => {\n            if (!this._moving) {\n                this._onDidAddGroup.fire(event);\n            }\n        }), this.onDidRemove((event) => {\n            if (!this._moving) {\n                this._onDidRemoveGroup.fire(event);\n            }\n        }), this.onDidActiveChange((event) => {\n            if (!this._moving) {\n                this._onDidActiveGroupChange.fire(event);\n            }\n        }), this.onDidMaximizedChange((event) => {\n            this._onDidMaximizedGroupChange.fire({\n                group: event.panel,\n                isMaximized: event.isMaximized,\n            });\n        }), Event.any(this.onDidAdd, this.onDidRemove)(() => {\n            this.updateWatermark();\n        }), Event.any(this.onDidAddPanel, this.onDidRemovePanel, this.onDidAddGroup, this.onDidRemove, this.onDidMovePanel, this.onDidActivePanelChange, this.onDidPopoutGroupPositionChange, this.onDidPopoutGroupSizeChange)(() => {\n            this._bufferOnDidLayoutChange.fire();\n        }), Disposable.from(() => {\n            // iterate over a copy of the array since .dispose() mutates the original array\n            for (const group of [...this._floatingGroups]) {\n                group.dispose();\n            }\n            // iterate over a copy of the array since .dispose() mutates the original array\n            for (const group of [...this._popoutGroups]) {\n                group.disposable.dispose();\n            }\n        }), this._rootDropTarget, this._rootDropTarget.onWillShowOverlay((event) => {\n            if (this.gridview.length > 0 && event.position === 'center') {\n                // option only available when no panels in primary grid\n                return;\n            }\n            this._onWillShowOverlay.fire(new WillShowOverlayLocationEvent(event, {\n                kind: 'edge',\n                panel: undefined,\n                api: this._api,\n                group: undefined,\n                getData: getPanelData,\n            }));\n        }), this._rootDropTarget.onDrop((event) => {\n            var _a;\n            const willDropEvent = new DockviewWillDropEvent({\n                nativeEvent: event.nativeEvent,\n                position: event.position,\n                panel: undefined,\n                api: this._api,\n                group: undefined,\n                getData: getPanelData,\n                kind: 'edge',\n            });\n            this._onWillDrop.fire(willDropEvent);\n            if (willDropEvent.defaultPrevented) {\n                return;\n            }\n            const data = getPanelData();\n            if (data) {\n                this.moveGroupOrPanel({\n                    from: {\n                        groupId: data.groupId,\n                        panelId: (_a = data.panelId) !== null && _a !== void 0 ? _a : undefined,\n                    },\n                    to: {\n                        group: this.orthogonalize(event.position),\n                        position: 'center',\n                    },\n                });\n            }\n            else {\n                this._onDidDrop.fire(new DockviewDidDropEvent({\n                    nativeEvent: event.nativeEvent,\n                    position: event.position,\n                    panel: undefined,\n                    api: this._api,\n                    group: undefined,\n                    getData: getPanelData,\n                }));\n            }\n        }), this._rootDropTarget);\n    }\n    setVisible(panel, visible) {\n        switch (panel.api.location.type) {\n            case 'grid':\n                super.setVisible(panel, visible);\n                break;\n            case 'floating': {\n                const item = this.floatingGroups.find((floatingGroup) => floatingGroup.group === panel);\n                if (item) {\n                    item.overlay.setVisible(visible);\n                    panel.api._onDidVisibilityChange.fire({\n                        isVisible: visible,\n                    });\n                }\n                break;\n            }\n            case 'popout':\n                console.warn('dockview: You cannot hide a group that is in a popout window');\n                break;\n        }\n    }\n    addPopoutGroup(itemToPopout, options) {\n        var _a, _b, _c, _d, _e;\n        if (itemToPopout instanceof DockviewPanel &&\n            itemToPopout.group.size === 1) {\n            return this.addPopoutGroup(itemToPopout.group, options);\n        }\n        const theme = getDockviewTheme(this.gridview.element);\n        const element = this.element;\n        function getBox() {\n            if (options === null || options === void 0 ? void 0 : options.position) {\n                return options.position;\n            }\n            if (itemToPopout instanceof DockviewGroupPanel) {\n                return itemToPopout.element.getBoundingClientRect();\n            }\n            if (itemToPopout.group) {\n                return itemToPopout.group.element.getBoundingClientRect();\n            }\n            return element.getBoundingClientRect();\n        }\n        const box = getBox();\n        const groupId = (_b = (_a = options === null || options === void 0 ? void 0 : options.overridePopoutGroup) === null || _a === void 0 ? void 0 : _a.id) !== null && _b !== void 0 ? _b : this.getNextGroupId();\n        const _window = new PopoutWindow(`${this.id}-${groupId}`, // unique id\n        theme !== null && theme !== void 0 ? theme : '', {\n            url: (_e = (_c = options === null || options === void 0 ? void 0 : options.popoutUrl) !== null && _c !== void 0 ? _c : (_d = this.options) === null || _d === void 0 ? void 0 : _d.popoutUrl) !== null && _e !== void 0 ? _e : '/popout.html',\n            left: window.screenX + box.left,\n            top: window.screenY + box.top,\n            width: box.width,\n            height: box.height,\n            onDidOpen: options === null || options === void 0 ? void 0 : options.onDidOpen,\n            onWillClose: options === null || options === void 0 ? void 0 : options.onWillClose,\n        });\n        const popoutWindowDisposable = new CompositeDisposable(_window, _window.onDidClose(() => {\n            popoutWindowDisposable.dispose();\n        }));\n        return _window\n            .open()\n            .then((popoutContainer) => {\n            var _a;\n            if (_window.isDisposed) {\n                return false;\n            }\n            const referenceGroup = (options === null || options === void 0 ? void 0 : options.referenceGroup)\n                ? options.referenceGroup\n                : itemToPopout instanceof DockviewPanel\n                    ? itemToPopout.group\n                    : itemToPopout;\n            const referenceLocation = itemToPopout.api.location.type;\n            /**\n             * The group that is being added doesn't already exist within the DOM, the most likely occurrence\n             * of this case is when being called from the `fromJSON(...)` method\n             */\n            const isGroupAddedToDom = referenceGroup.element.parentElement !== null;\n            let group;\n            if (!isGroupAddedToDom) {\n                group = referenceGroup;\n            }\n            else if (options === null || options === void 0 ? void 0 : options.overridePopoutGroup) {\n                group = options.overridePopoutGroup;\n            }\n            else {\n                group = this.createGroup({ id: groupId });\n                if (popoutContainer) {\n                    this._onDidAddGroup.fire(group);\n                }\n            }\n            if (popoutContainer === null) {\n                console.error('dockview: failed to create popout. perhaps you need to allow pop-ups for this website');\n                popoutWindowDisposable.dispose();\n                this._onDidOpenPopoutWindowFail.fire();\n                // if the popout window was blocked, we need to move the group back to the reference group\n                // and set it to visible\n                this.movingLock(() => moveGroupWithoutDestroying({\n                    from: group,\n                    to: referenceGroup,\n                }));\n                if (!referenceGroup.api.isVisible) {\n                    referenceGroup.api.setVisible(true);\n                }\n                return false;\n            }\n            const gready = document.createElement('div');\n            gready.className = 'dv-overlay-render-container';\n            const overlayRenderContainer = new OverlayRenderContainer(gready, this);\n            group.model.renderContainer = overlayRenderContainer;\n            group.layout(_window.window.innerWidth, _window.window.innerHeight);\n            let floatingBox;\n            if (!(options === null || options === void 0 ? void 0 : options.overridePopoutGroup) && isGroupAddedToDom) {\n                if (itemToPopout instanceof DockviewPanel) {\n                    this.movingLock(() => {\n                        const panel = referenceGroup.model.removePanel(itemToPopout);\n                        group.model.openPanel(panel);\n                    });\n                }\n                else {\n                    this.movingLock(() => moveGroupWithoutDestroying({\n                        from: referenceGroup,\n                        to: group,\n                    }));\n                    switch (referenceLocation) {\n                        case 'grid':\n                            referenceGroup.api.setVisible(false);\n                            break;\n                        case 'floating':\n                        case 'popout':\n                            floatingBox = (_a = this._floatingGroups\n                                .find((value) => value.group.api.id ===\n                                itemToPopout.api.id)) === null || _a === void 0 ? void 0 : _a.overlay.toJSON();\n                            this.removeGroup(referenceGroup);\n                            break;\n                    }\n                }\n            }\n            popoutContainer.classList.add('dv-dockview');\n            popoutContainer.style.overflow = 'hidden';\n            popoutContainer.appendChild(gready);\n            popoutContainer.appendChild(group.element);\n            const anchor = document.createElement('div');\n            const dropTargetContainer = new DropTargetAnchorContainer(anchor, { disabled: this.rootDropTargetContainer.disabled });\n            popoutContainer.appendChild(anchor);\n            group.model.dropTargetContainer = dropTargetContainer;\n            group.model.location = {\n                type: 'popout',\n                getWindow: () => _window.window,\n                popoutUrl: options === null || options === void 0 ? void 0 : options.popoutUrl,\n            };\n            if (isGroupAddedToDom &&\n                itemToPopout.api.location.type === 'grid') {\n                itemToPopout.api.setVisible(false);\n            }\n            this.doSetGroupAndPanelActive(group);\n            popoutWindowDisposable.addDisposables(group.api.onDidActiveChange((event) => {\n                var _a;\n                if (event.isActive) {\n                    (_a = _window.window) === null || _a === void 0 ? void 0 : _a.focus();\n                }\n            }), group.api.onWillFocus(() => {\n                var _a;\n                (_a = _window.window) === null || _a === void 0 ? void 0 : _a.focus();\n            }));\n            let returnedGroup;\n            const isValidReferenceGroup = isGroupAddedToDom &&\n                referenceGroup &&\n                this.getPanel(referenceGroup.id);\n            const value = {\n                window: _window,\n                popoutGroup: group,\n                referenceGroup: isValidReferenceGroup\n                    ? referenceGroup.id\n                    : undefined,\n                disposable: {\n                    dispose: () => {\n                        popoutWindowDisposable.dispose();\n                        return returnedGroup;\n                    },\n                },\n            };\n            const _onDidWindowPositionChange = onDidWindowMoveEnd(_window.window);\n            popoutWindowDisposable.addDisposables(_onDidWindowPositionChange, onDidWindowResizeEnd(_window.window, () => {\n                this._onDidPopoutGroupSizeChange.fire({\n                    width: _window.window.innerWidth,\n                    height: _window.window.innerHeight,\n                    group,\n                });\n            }), _onDidWindowPositionChange.event(() => {\n                this._onDidPopoutGroupPositionChange.fire({\n                    screenX: _window.window.screenX,\n                    screenY: _window.window.screenX,\n                    group,\n                });\n            }), \n            /**\n             * ResizeObserver seems slow here, I do not know why but we don't need it\n             * since we can reply on the window resize event as we will occupy the full\n             * window dimensions\n             */\n            addDisposableListener(_window.window, 'resize', () => {\n                group.layout(_window.window.innerWidth, _window.window.innerHeight);\n            }), overlayRenderContainer, Disposable.from(() => {\n                if (this.isDisposed) {\n                    return; // cleanup may run after instance is disposed\n                }\n                if (isGroupAddedToDom &&\n                    this.getPanel(referenceGroup.id)) {\n                    this.movingLock(() => moveGroupWithoutDestroying({\n                        from: group,\n                        to: referenceGroup,\n                    }));\n                    if (!referenceGroup.api.isVisible) {\n                        referenceGroup.api.setVisible(true);\n                    }\n                    if (this.getPanel(group.id)) {\n                        this.doRemoveGroup(group, {\n                            skipPopoutAssociated: true,\n                        });\n                    }\n                }\n                else if (this.getPanel(group.id)) {\n                    group.model.renderContainer =\n                        this.overlayRenderContainer;\n                    group.model.dropTargetContainer =\n                        this.rootDropTargetContainer;\n                    returnedGroup = group;\n                    const alreadyRemoved = !this._popoutGroups.find((p) => p.popoutGroup === group);\n                    if (alreadyRemoved) {\n                        /**\n                         * If this popout group was explicitly removed then we shouldn't run the additional\n                         * steps. To tell if the running of this disposable is the result of this popout group\n                         * being explicitly removed we can check if this popout group is still referenced in\n                         * the `this._popoutGroups` list.\n                         */\n                        return;\n                    }\n                    if (floatingBox) {\n                        this.addFloatingGroup(group, {\n                            height: floatingBox.height,\n                            width: floatingBox.width,\n                            position: floatingBox,\n                        });\n                    }\n                    else {\n                        this.doRemoveGroup(group, {\n                            skipDispose: true,\n                            skipActive: true,\n                            skipPopoutReturn: true,\n                        });\n                        group.model.location = { type: 'grid' };\n                        this.movingLock(() => {\n                            // suppress group add events since the group already exists\n                            this.doAddGroup(group, [0]);\n                        });\n                    }\n                    this.doSetGroupAndPanelActive(group);\n                }\n            }));\n            this._popoutGroups.push(value);\n            this.updateWatermark();\n            return true;\n        })\n            .catch((err) => {\n            console.error('dockview: failed to create popout.', err);\n            return false;\n        });\n    }\n    addFloatingGroup(item, options) {\n        var _a, _b, _c, _d, _e;\n        let group;\n        if (item instanceof DockviewPanel) {\n            group = this.createGroup();\n            this._onDidAddGroup.fire(group);\n            this.movingLock(() => this.removePanel(item, {\n                removeEmptyGroup: true,\n                skipDispose: true,\n                skipSetActiveGroup: true,\n            }));\n            this.movingLock(() => group.model.openPanel(item, { skipSetGroupActive: true }));\n        }\n        else {\n            group = item;\n            const popoutReferenceGroupId = (_a = this._popoutGroups.find((_) => _.popoutGroup === group)) === null || _a === void 0 ? void 0 : _a.referenceGroup;\n            const popoutReferenceGroup = popoutReferenceGroupId\n                ? this.getPanel(popoutReferenceGroupId)\n                : undefined;\n            const skip = typeof (options === null || options === void 0 ? void 0 : options.skipRemoveGroup) === 'boolean' &&\n                options.skipRemoveGroup;\n            if (!skip) {\n                if (popoutReferenceGroup) {\n                    this.movingLock(() => moveGroupWithoutDestroying({\n                        from: item,\n                        to: popoutReferenceGroup,\n                    }));\n                    this.doRemoveGroup(item, {\n                        skipPopoutReturn: true,\n                        skipPopoutAssociated: true,\n                    });\n                    this.doRemoveGroup(popoutReferenceGroup, {\n                        skipDispose: true,\n                    });\n                    group = popoutReferenceGroup;\n                }\n                else {\n                    this.doRemoveGroup(item, {\n                        skipDispose: true,\n                        skipPopoutReturn: true,\n                        skipPopoutAssociated: false,\n                    });\n                }\n            }\n        }\n        function getAnchoredBox() {\n            if (options === null || options === void 0 ? void 0 : options.position) {\n                const result = {};\n                if ('left' in options.position) {\n                    result.left = Math.max(options.position.left, 0);\n                }\n                else if ('right' in options.position) {\n                    result.right = Math.max(options.position.right, 0);\n                }\n                else {\n                    result.left = DEFAULT_FLOATING_GROUP_POSITION.left;\n                }\n                if ('top' in options.position) {\n                    result.top = Math.max(options.position.top, 0);\n                }\n                else if ('bottom' in options.position) {\n                    result.bottom = Math.max(options.position.bottom, 0);\n                }\n                else {\n                    result.top = DEFAULT_FLOATING_GROUP_POSITION.top;\n                }\n                if (typeof options.width === 'number') {\n                    result.width = Math.max(options.width, 0);\n                }\n                else {\n                    result.width = DEFAULT_FLOATING_GROUP_POSITION.width;\n                }\n                if (typeof options.height === 'number') {\n                    result.height = Math.max(options.height, 0);\n                }\n                else {\n                    result.height = DEFAULT_FLOATING_GROUP_POSITION.height;\n                }\n                return result;\n            }\n            return {\n                left: typeof (options === null || options === void 0 ? void 0 : options.x) === 'number'\n                    ? Math.max(options.x, 0)\n                    : DEFAULT_FLOATING_GROUP_POSITION.left,\n                top: typeof (options === null || options === void 0 ? void 0 : options.y) === 'number'\n                    ? Math.max(options.y, 0)\n                    : DEFAULT_FLOATING_GROUP_POSITION.top,\n                width: typeof (options === null || options === void 0 ? void 0 : options.width) === 'number'\n                    ? Math.max(options.width, 0)\n                    : DEFAULT_FLOATING_GROUP_POSITION.width,\n                height: typeof (options === null || options === void 0 ? void 0 : options.height) === 'number'\n                    ? Math.max(options.height, 0)\n                    : DEFAULT_FLOATING_GROUP_POSITION.height,\n            };\n        }\n        const anchoredBox = getAnchoredBox();\n        const overlay = new Overlay(Object.assign(Object.assign({ container: this.gridview.element, content: group.element }, anchoredBox), { minimumInViewportWidth: this.options.floatingGroupBounds === 'boundedWithinViewport'\n                ? undefined\n                : (_c = (_b = this.options.floatingGroupBounds) === null || _b === void 0 ? void 0 : _b.minimumWidthWithinViewport) !== null && _c !== void 0 ? _c : DEFAULT_FLOATING_GROUP_OVERFLOW_SIZE, minimumInViewportHeight: this.options.floatingGroupBounds === 'boundedWithinViewport'\n                ? undefined\n                : (_e = (_d = this.options.floatingGroupBounds) === null || _d === void 0 ? void 0 : _d.minimumHeightWithinViewport) !== null && _e !== void 0 ? _e : DEFAULT_FLOATING_GROUP_OVERFLOW_SIZE }));\n        const el = group.element.querySelector('.dv-void-container');\n        if (!el) {\n            throw new Error('failed to find drag handle');\n        }\n        overlay.setupDrag(el, {\n            inDragMode: typeof (options === null || options === void 0 ? void 0 : options.inDragMode) === 'boolean'\n                ? options.inDragMode\n                : false,\n        });\n        const floatingGroupPanel = new DockviewFloatingGroupPanel(group, overlay);\n        const disposable = new CompositeDisposable(group.api.onDidActiveChange((event) => {\n            if (event.isActive) {\n                overlay.bringToFront();\n            }\n        }), watchElementResize(group.element, (entry) => {\n            const { width, height } = entry.contentRect;\n            group.layout(width, height); // let the group know it's size is changing so it can fire events to the panel\n        }));\n        floatingGroupPanel.addDisposables(overlay.onDidChange(() => {\n            // this is either a resize or a move\n            // to inform the panels .layout(...) the group with it's current size\n            // don't care about resize since the above watcher handles that\n            group.layout(group.width, group.height);\n        }), overlay.onDidChangeEnd(() => {\n            this._bufferOnDidLayoutChange.fire();\n        }), group.onDidChange((event) => {\n            overlay.setBounds({\n                height: event === null || event === void 0 ? void 0 : event.height,\n                width: event === null || event === void 0 ? void 0 : event.width,\n            });\n        }), {\n            dispose: () => {\n                disposable.dispose();\n                remove(this._floatingGroups, floatingGroupPanel);\n                group.model.location = { type: 'grid' };\n                this.updateWatermark();\n            },\n        });\n        this._floatingGroups.push(floatingGroupPanel);\n        group.model.location = { type: 'floating' };\n        if (!(options === null || options === void 0 ? void 0 : options.skipActiveGroup)) {\n            this.doSetGroupAndPanelActive(group);\n        }\n        this.updateWatermark();\n    }\n    orthogonalize(position, options) {\n        this.gridview.normalize();\n        switch (position) {\n            case 'top':\n            case 'bottom':\n                if (this.gridview.orientation === Orientation.HORIZONTAL) {\n                    // we need to add to a vertical splitview but the current root is a horizontal splitview.\n                    // insert a vertical splitview at the root level and add the existing view as a child\n                    this.gridview.insertOrthogonalSplitviewAtRoot();\n                }\n                break;\n            case 'left':\n            case 'right':\n                if (this.gridview.orientation === Orientation.VERTICAL) {\n                    // we need to add to a horizontal splitview but the current root is a vertical splitview.\n                    // insert a horiziontal splitview at the root level and add the existing view as a child\n                    this.gridview.insertOrthogonalSplitviewAtRoot();\n                }\n                break;\n            default:\n                break;\n        }\n        switch (position) {\n            case 'top':\n            case 'left':\n            case 'center':\n                return this.createGroupAtLocation([0], undefined, options); // insert into first position\n            case 'bottom':\n            case 'right':\n                return this.createGroupAtLocation([this.gridview.length], undefined, options); // insert into last position\n            default:\n                throw new Error(`unsupported position ${position}`);\n        }\n    }\n    updateOptions(options) {\n        var _a, _b;\n        super.updateOptions(options);\n        if ('floatingGroupBounds' in options) {\n            for (const group of this._floatingGroups) {\n                switch (options.floatingGroupBounds) {\n                    case 'boundedWithinViewport':\n                        group.overlay.minimumInViewportHeight = undefined;\n                        group.overlay.minimumInViewportWidth = undefined;\n                        break;\n                    case undefined:\n                        group.overlay.minimumInViewportHeight =\n                            DEFAULT_FLOATING_GROUP_OVERFLOW_SIZE;\n                        group.overlay.minimumInViewportWidth =\n                            DEFAULT_FLOATING_GROUP_OVERFLOW_SIZE;\n                        break;\n                    default:\n                        group.overlay.minimumInViewportHeight =\n                            (_a = options.floatingGroupBounds) === null || _a === void 0 ? void 0 : _a.minimumHeightWithinViewport;\n                        group.overlay.minimumInViewportWidth =\n                            (_b = options.floatingGroupBounds) === null || _b === void 0 ? void 0 : _b.minimumWidthWithinViewport;\n                }\n                group.overlay.setBounds();\n            }\n        }\n        this.updateDropTargetModel(options);\n        const oldDisableDnd = this.options.disableDnd;\n        this._options = Object.assign(Object.assign({}, this.options), options);\n        const newDisableDnd = this.options.disableDnd;\n        if (oldDisableDnd !== newDisableDnd) {\n            this.updateDragAndDropState();\n        }\n        if ('theme' in options) {\n            this.updateTheme();\n        }\n        this.layout(this.gridview.width, this.gridview.height, true);\n    }\n    layout(width, height, forceResize) {\n        super.layout(width, height, forceResize);\n        if (this._floatingGroups) {\n            for (const floating of this._floatingGroups) {\n                // ensure floting groups stay within visible boundaries\n                floating.overlay.setBounds();\n            }\n        }\n    }\n    updateDragAndDropState() {\n        // Update draggable state for all tabs and void containers\n        for (const group of this.groups) {\n            group.model.updateDragAndDropState();\n        }\n    }\n    focus() {\n        var _a;\n        (_a = this.activeGroup) === null || _a === void 0 ? void 0 : _a.focus();\n    }\n    getGroupPanel(id) {\n        return this.panels.find((panel) => panel.id === id);\n    }\n    setActivePanel(panel) {\n        panel.group.model.openPanel(panel);\n        this.doSetGroupAndPanelActive(panel.group);\n    }\n    moveToNext(options = {}) {\n        var _a;\n        if (!options.group) {\n            if (!this.activeGroup) {\n                return;\n            }\n            options.group = this.activeGroup;\n        }\n        if (options.includePanel && options.group) {\n            if (options.group.activePanel !==\n                options.group.panels[options.group.panels.length - 1]) {\n                options.group.model.moveToNext({ suppressRoll: true });\n                return;\n            }\n        }\n        const location = getGridLocation(options.group.element);\n        const next = (_a = this.gridview.next(location)) === null || _a === void 0 ? void 0 : _a.view;\n        this.doSetGroupAndPanelActive(next);\n    }\n    moveToPrevious(options = {}) {\n        var _a;\n        if (!options.group) {\n            if (!this.activeGroup) {\n                return;\n            }\n            options.group = this.activeGroup;\n        }\n        if (options.includePanel && options.group) {\n            if (options.group.activePanel !== options.group.panels[0]) {\n                options.group.model.moveToPrevious({ suppressRoll: true });\n                return;\n            }\n        }\n        const location = getGridLocation(options.group.element);\n        const next = (_a = this.gridview.previous(location)) === null || _a === void 0 ? void 0 : _a.view;\n        if (next) {\n            this.doSetGroupAndPanelActive(next);\n        }\n    }\n    /**\n     * Serialize the current state of the layout\n     *\n     * @returns A JSON respresentation of the layout\n     */\n    toJSON() {\n        var _a;\n        const data = this.gridview.serialize();\n        const panels = this.panels.reduce((collection, panel) => {\n            collection[panel.id] = panel.toJSON();\n            return collection;\n        }, {});\n        const floats = this._floatingGroups.map((group) => {\n            return {\n                data: group.group.toJSON(),\n                position: group.overlay.toJSON(),\n            };\n        });\n        const popoutGroups = this._popoutGroups.map((group) => {\n            return {\n                data: group.popoutGroup.toJSON(),\n                gridReferenceGroup: group.referenceGroup,\n                position: group.window.dimensions(),\n                url: group.popoutGroup.api.location.type === 'popout'\n                    ? group.popoutGroup.api.location.popoutUrl\n                    : undefined,\n            };\n        });\n        const result = {\n            grid: data,\n            panels,\n            activeGroup: (_a = this.activeGroup) === null || _a === void 0 ? void 0 : _a.id,\n        };\n        if (floats.length > 0) {\n            result.floatingGroups = floats;\n        }\n        if (popoutGroups.length > 0) {\n            result.popoutGroups = popoutGroups;\n        }\n        return result;\n    }\n    fromJSON(data) {\n        var _a, _b;\n        this.clear();\n        if (typeof data !== 'object' || data === null) {\n            throw new Error('serialized layout must be a non-null object');\n        }\n        const { grid, panels, activeGroup } = data;\n        if (grid.root.type !== 'branch' || !Array.isArray(grid.root.data)) {\n            throw new Error('root must be of type branch');\n        }\n        try {\n            // take note of the existing dimensions\n            const width = this.width;\n            const height = this.height;\n            const createGroupFromSerializedState = (data) => {\n                const { id, locked, hideHeader, views, activeView } = data;\n                if (typeof id !== 'string') {\n                    throw new Error('group id must be of type string');\n                }\n                const group = this.createGroup({\n                    id,\n                    locked: !!locked,\n                    hideHeader: !!hideHeader,\n                });\n                this._onDidAddGroup.fire(group);\n                const createdPanels = [];\n                for (const child of views) {\n                    /**\n                     * Run the deserializer step seperately since this may fail to due corrupted external state.\n                     * In running this section first we avoid firing lots of 'add' events in the event of a failure\n                     * due to a corruption of input data.\n                     */\n                    const panel = this._deserializer.fromJSON(panels[child], group);\n                    createdPanels.push(panel);\n                }\n                for (let i = 0; i < views.length; i++) {\n                    const panel = createdPanels[i];\n                    const isActive = typeof activeView === 'string' &&\n                        activeView === panel.id;\n                    group.model.openPanel(panel, {\n                        skipSetActive: !isActive,\n                        skipSetGroupActive: true,\n                    });\n                }\n                if (!group.activePanel && group.panels.length > 0) {\n                    group.model.openPanel(group.panels[group.panels.length - 1], {\n                        skipSetGroupActive: true,\n                    });\n                }\n                return group;\n            };\n            this.gridview.deserialize(grid, {\n                fromJSON: (node) => {\n                    return createGroupFromSerializedState(node.data);\n                },\n            });\n            this.layout(width, height, true);\n            const serializedFloatingGroups = (_a = data.floatingGroups) !== null && _a !== void 0 ? _a : [];\n            for (const serializedFloatingGroup of serializedFloatingGroups) {\n                const { data, position } = serializedFloatingGroup;\n                const group = createGroupFromSerializedState(data);\n                this.addFloatingGroup(group, {\n                    position: position,\n                    width: position.width,\n                    height: position.height,\n                    skipRemoveGroup: true,\n                    inDragMode: false,\n                });\n            }\n            const serializedPopoutGroups = (_b = data.popoutGroups) !== null && _b !== void 0 ? _b : [];\n            // Create a promise that resolves when all popout groups are created\n            const popoutPromises = [];\n            // Queue popup group creation with delays to avoid browser blocking\n            serializedPopoutGroups.forEach((serializedPopoutGroup, index) => {\n                const { data, position, gridReferenceGroup, url } = serializedPopoutGroup;\n                const group = createGroupFromSerializedState(data);\n                // Add a small delay for each popup after the first to avoid browser popup blocking\n                const popoutPromise = new Promise((resolve) => {\n                    setTimeout(() => {\n                        this.addPopoutGroup(group, {\n                            position: position !== null && position !== void 0 ? position : undefined,\n                            overridePopoutGroup: gridReferenceGroup ? group : undefined,\n                            referenceGroup: gridReferenceGroup\n                                ? this.getPanel(gridReferenceGroup)\n                                : undefined,\n                            popoutUrl: url,\n                        });\n                        resolve();\n                    }, index * DESERIALIZATION_POPOUT_DELAY_MS); // 100ms delay between each popup\n                });\n                popoutPromises.push(popoutPromise);\n            });\n            // Store the promise for tests to wait on\n            this._popoutRestorationPromise = Promise.all(popoutPromises).then(() => void 0);\n            for (const floatingGroup of this._floatingGroups) {\n                floatingGroup.overlay.setBounds();\n            }\n            if (typeof activeGroup === 'string') {\n                const panel = this.getPanel(activeGroup);\n                if (panel) {\n                    this.doSetGroupAndPanelActive(panel);\n                }\n            }\n        }\n        catch (err) {\n            console.error('dockview: failed to deserialize layout. Reverting changes', err);\n            /**\n             * Takes all the successfully created groups and remove all of their panels.\n             */\n            for (const group of this.groups) {\n                for (const panel of group.panels) {\n                    this.removePanel(panel, {\n                        removeEmptyGroup: false,\n                        skipDispose: false,\n                    });\n                }\n            }\n            /**\n             * To remove a group we cannot call this.removeGroup(...) since this makes assumptions about\n             * the underlying HTMLElement existing in the Gridview.\n             */\n            for (const group of this.groups) {\n                group.dispose();\n                this._groups.delete(group.id);\n                this._onDidRemoveGroup.fire(group);\n            }\n            // iterate over a reassigned array since original array will be modified\n            for (const floatingGroup of [...this._floatingGroups]) {\n                floatingGroup.dispose();\n            }\n            // fires clean-up events and clears the underlying HTML gridview.\n            this.clear();\n            /**\n             * even though we have cleaned-up we still want to inform the caller of their error\n             * and we'll do this through re-throwing the original error since afterall you would\n             * expect trying to load a corrupted layout to result in an error and not silently fail...\n             */\n            throw err;\n        }\n        this.updateWatermark();\n        // Force position updates for always visible panels after DOM layout is complete\n        requestAnimationFrame(() => {\n            this.overlayRenderContainer.updateAllPositions();\n        });\n        this._onDidLayoutFromJSON.fire();\n    }\n    clear() {\n        const groups = Array.from(this._groups.values()).map((_) => _.value);\n        const hasActiveGroup = !!this.activeGroup;\n        for (const group of groups) {\n            // remove the group will automatically remove the panels\n            this.removeGroup(group, { skipActive: true });\n        }\n        if (hasActiveGroup) {\n            this.doSetGroupAndPanelActive(undefined);\n        }\n        this.gridview.clear();\n    }\n    closeAllGroups() {\n        for (const entry of this._groups.entries()) {\n            const [_, group] = entry;\n            group.value.model.closeAllPanels();\n        }\n    }\n    addPanel(options) {\n        var _a, _b;\n        if (this.panels.find((_) => _.id === options.id)) {\n            throw new Error(`panel with id ${options.id} already exists`);\n        }\n        let referenceGroup;\n        if (options.position && options.floating) {\n            throw new Error('you can only provide one of: position, floating as arguments to .addPanel(...)');\n        }\n        const initial = {\n            width: options.initialWidth,\n            height: options.initialHeight,\n        };\n        let index;\n        if (options.position) {\n            if (isPanelOptionsWithPanel(options.position)) {\n                const referencePanel = typeof options.position.referencePanel === 'string'\n                    ? this.getGroupPanel(options.position.referencePanel)\n                    : options.position.referencePanel;\n                index = options.position.index;\n                if (!referencePanel) {\n                    throw new Error(`referencePanel '${options.position.referencePanel}' does not exist`);\n                }\n                referenceGroup = this.findGroup(referencePanel);\n            }\n            else if (isPanelOptionsWithGroup(options.position)) {\n                referenceGroup =\n                    typeof options.position.referenceGroup === 'string'\n                        ? (_a = this._groups.get(options.position.referenceGroup)) === null || _a === void 0 ? void 0 : _a.value\n                        : options.position.referenceGroup;\n                index = options.position.index;\n                if (!referenceGroup) {\n                    throw new Error(`referenceGroup '${options.position.referenceGroup}' does not exist`);\n                }\n            }\n            else {\n                const group = this.orthogonalize(directionToPosition(options.position.direction));\n                const panel = this.createPanel(options, group);\n                group.model.openPanel(panel, {\n                    skipSetActive: options.inactive,\n                    skipSetGroupActive: options.inactive,\n                    index,\n                });\n                if (!options.inactive) {\n                    this.doSetGroupAndPanelActive(group);\n                }\n                group.api.setSize({\n                    height: initial === null || initial === void 0 ? void 0 : initial.height,\n                    width: initial === null || initial === void 0 ? void 0 : initial.width,\n                });\n                return panel;\n            }\n        }\n        else {\n            referenceGroup = this.activeGroup;\n        }\n        let panel;\n        if (referenceGroup) {\n            const target = toTarget(((_b = options.position) === null || _b === void 0 ? void 0 : _b.direction) || 'within');\n            if (options.floating) {\n                const group = this.createGroup();\n                this._onDidAddGroup.fire(group);\n                const floatingGroupOptions = typeof options.floating === 'object' &&\n                    options.floating !== null\n                    ? options.floating\n                    : {};\n                this.addFloatingGroup(group, Object.assign(Object.assign({}, floatingGroupOptions), { inDragMode: false, skipRemoveGroup: true, skipActiveGroup: true }));\n                panel = this.createPanel(options, group);\n                group.model.openPanel(panel, {\n                    skipSetActive: options.inactive,\n                    skipSetGroupActive: options.inactive,\n                    index,\n                });\n            }\n            else if (referenceGroup.api.location.type === 'floating' ||\n                target === 'center') {\n                panel = this.createPanel(options, referenceGroup);\n                referenceGroup.model.openPanel(panel, {\n                    skipSetActive: options.inactive,\n                    skipSetGroupActive: options.inactive,\n                    index,\n                });\n                referenceGroup.api.setSize({\n                    width: initial === null || initial === void 0 ? void 0 : initial.width,\n                    height: initial === null || initial === void 0 ? void 0 : initial.height,\n                });\n                if (!options.inactive) {\n                    this.doSetGroupAndPanelActive(referenceGroup);\n                }\n            }\n            else {\n                const location = getGridLocation(referenceGroup.element);\n                const relativeLocation = getRelativeLocation(this.gridview.orientation, location, target);\n                const group = this.createGroupAtLocation(relativeLocation, this.orientationAtLocation(relativeLocation) ===\n                    Orientation.VERTICAL\n                    ? initial === null || initial === void 0 ? void 0 : initial.height\n                    : initial === null || initial === void 0 ? void 0 : initial.width);\n                panel = this.createPanel(options, group);\n                group.model.openPanel(panel, {\n                    skipSetActive: options.inactive,\n                    skipSetGroupActive: options.inactive,\n                    index,\n                });\n                if (!options.inactive) {\n                    this.doSetGroupAndPanelActive(group);\n                }\n            }\n        }\n        else if (options.floating) {\n            const group = this.createGroup();\n            this._onDidAddGroup.fire(group);\n            const coordinates = typeof options.floating === 'object' &&\n                options.floating !== null\n                ? options.floating\n                : {};\n            this.addFloatingGroup(group, Object.assign(Object.assign({}, coordinates), { inDragMode: false, skipRemoveGroup: true, skipActiveGroup: true }));\n            panel = this.createPanel(options, group);\n            group.model.openPanel(panel, {\n                skipSetActive: options.inactive,\n                skipSetGroupActive: options.inactive,\n                index,\n            });\n        }\n        else {\n            const group = this.createGroupAtLocation([0], this.gridview.orientation === Orientation.VERTICAL\n                ? initial === null || initial === void 0 ? void 0 : initial.height\n                : initial === null || initial === void 0 ? void 0 : initial.width);\n            panel = this.createPanel(options, group);\n            group.model.openPanel(panel, {\n                skipSetActive: options.inactive,\n                skipSetGroupActive: options.inactive,\n                index,\n            });\n            if (!options.inactive) {\n                this.doSetGroupAndPanelActive(group);\n            }\n        }\n        return panel;\n    }\n    removePanel(panel, options = {\n        removeEmptyGroup: true,\n    }) {\n        const group = panel.group;\n        if (!group) {\n            throw new Error(`cannot remove panel ${panel.id}. it's missing a group.`);\n        }\n        group.model.removePanel(panel, {\n            skipSetActiveGroup: options.skipSetActiveGroup,\n        });\n        if (!options.skipDispose) {\n            panel.group.model.renderContainer.detatch(panel);\n            panel.dispose();\n        }\n        if (group.size === 0 && options.removeEmptyGroup) {\n            this.removeGroup(group, { skipActive: options.skipSetActiveGroup });\n        }\n    }\n    createWatermarkComponent() {\n        if (this.options.createWatermarkComponent) {\n            return this.options.createWatermarkComponent();\n        }\n        return new Watermark();\n    }\n    updateWatermark() {\n        var _a, _b;\n        if (this.groups.filter((x) => x.api.location.type === 'grid' && x.api.isVisible).length === 0) {\n            if (!this._watermark) {\n                this._watermark = this.createWatermarkComponent();\n                this._watermark.init({\n                    containerApi: new DockviewApi(this),\n                });\n                const watermarkContainer = document.createElement('div');\n                watermarkContainer.className = 'dv-watermark-container';\n                addTestId(watermarkContainer, 'watermark-component');\n                watermarkContainer.appendChild(this._watermark.element);\n                this.gridview.element.appendChild(watermarkContainer);\n            }\n        }\n        else if (this._watermark) {\n            this._watermark.element.parentElement.remove();\n            (_b = (_a = this._watermark).dispose) === null || _b === void 0 ? void 0 : _b.call(_a);\n            this._watermark = null;\n        }\n    }\n    addGroup(options) {\n        var _a;\n        if (options) {\n            let referenceGroup;\n            if (isGroupOptionsWithPanel(options)) {\n                const referencePanel = typeof options.referencePanel === 'string'\n                    ? this.panels.find((panel) => panel.id === options.referencePanel)\n                    : options.referencePanel;\n                if (!referencePanel) {\n                    throw new Error(`reference panel ${options.referencePanel} does not exist`);\n                }\n                referenceGroup = this.findGroup(referencePanel);\n                if (!referenceGroup) {\n                    throw new Error(`reference group for reference panel ${options.referencePanel} does not exist`);\n                }\n            }\n            else if (isGroupOptionsWithGroup(options)) {\n                referenceGroup =\n                    typeof options.referenceGroup === 'string'\n                        ? (_a = this._groups.get(options.referenceGroup)) === null || _a === void 0 ? void 0 : _a.value\n                        : options.referenceGroup;\n                if (!referenceGroup) {\n                    throw new Error(`reference group ${options.referenceGroup} does not exist`);\n                }\n            }\n            else {\n                const group = this.orthogonalize(directionToPosition(options.direction), options);\n                if (!options.skipSetActive) {\n                    this.doSetGroupAndPanelActive(group);\n                }\n                return group;\n            }\n            const target = toTarget(options.direction || 'within');\n            const location = getGridLocation(referenceGroup.element);\n            const relativeLocation = getRelativeLocation(this.gridview.orientation, location, target);\n            const group = this.createGroup(options);\n            const size = this.getLocationOrientation(relativeLocation) ===\n                Orientation.VERTICAL\n                ? options.initialHeight\n                : options.initialWidth;\n            this.doAddGroup(group, relativeLocation, size);\n            if (!options.skipSetActive) {\n                this.doSetGroupAndPanelActive(group);\n            }\n            return group;\n        }\n        else {\n            const group = this.createGroup(options);\n            this.doAddGroup(group);\n            this.doSetGroupAndPanelActive(group);\n            return group;\n        }\n    }\n    getLocationOrientation(location) {\n        return location.length % 2 == 0 &&\n            this.gridview.orientation === Orientation.HORIZONTAL\n            ? Orientation.HORIZONTAL\n            : Orientation.VERTICAL;\n    }\n    removeGroup(group, options) {\n        this.doRemoveGroup(group, options);\n    }\n    doRemoveGroup(group, options) {\n        var _a;\n        const panels = [...group.panels]; // reassign since group panels will mutate\n        if (!(options === null || options === void 0 ? void 0 : options.skipDispose)) {\n            for (const panel of panels) {\n                this.removePanel(panel, {\n                    removeEmptyGroup: false,\n                    skipDispose: (_a = options === null || options === void 0 ? void 0 : options.skipDispose) !== null && _a !== void 0 ? _a : false,\n                });\n            }\n        }\n        const activePanel = this.activePanel;\n        if (group.api.location.type === 'floating') {\n            const floatingGroup = this._floatingGroups.find((_) => _.group === group);\n            if (floatingGroup) {\n                if (!(options === null || options === void 0 ? void 0 : options.skipDispose)) {\n                    floatingGroup.group.dispose();\n                    this._groups.delete(group.id);\n                    this._onDidRemoveGroup.fire(group);\n                }\n                remove(this._floatingGroups, floatingGroup);\n                floatingGroup.dispose();\n                if (!(options === null || options === void 0 ? void 0 : options.skipActive) && this._activeGroup === group) {\n                    const groups = Array.from(this._groups.values());\n                    this.doSetGroupAndPanelActive(groups.length > 0 ? groups[0].value : undefined);\n                }\n                return floatingGroup.group;\n            }\n            throw new Error('failed to find floating group');\n        }\n        if (group.api.location.type === 'popout') {\n            const selectedGroup = this._popoutGroups.find((_) => _.popoutGroup === group);\n            if (selectedGroup) {\n                if (!(options === null || options === void 0 ? void 0 : options.skipDispose)) {\n                    if (!(options === null || options === void 0 ? void 0 : options.skipPopoutAssociated)) {\n                        const refGroup = selectedGroup.referenceGroup\n                            ? this.getPanel(selectedGroup.referenceGroup)\n                            : undefined;\n                        if (refGroup && refGroup.panels.length === 0) {\n                            this.removeGroup(refGroup);\n                        }\n                    }\n                    selectedGroup.popoutGroup.dispose();\n                    this._groups.delete(group.id);\n                    this._onDidRemoveGroup.fire(group);\n                }\n                remove(this._popoutGroups, selectedGroup);\n                const removedGroup = selectedGroup.disposable.dispose();\n                if (!(options === null || options === void 0 ? void 0 : options.skipPopoutReturn) && removedGroup) {\n                    this.doAddGroup(removedGroup, [0]);\n                    this.doSetGroupAndPanelActive(removedGroup);\n                }\n                if (!(options === null || options === void 0 ? void 0 : options.skipActive) && this._activeGroup === group) {\n                    const groups = Array.from(this._groups.values());\n                    this.doSetGroupAndPanelActive(groups.length > 0 ? groups[0].value : undefined);\n                }\n                this.updateWatermark();\n                return selectedGroup.popoutGroup;\n            }\n            throw new Error('failed to find popout group');\n        }\n        const re = super.doRemoveGroup(group, options);\n        if (!(options === null || options === void 0 ? void 0 : options.skipActive)) {\n            if (this.activePanel !== activePanel) {\n                this._onDidActivePanelChange.fire(this.activePanel);\n            }\n        }\n        return re;\n    }\n    movingLock(func) {\n        const isMoving = this._moving;\n        try {\n            this._moving = true;\n            return func();\n        }\n        finally {\n            this._moving = isMoving;\n        }\n    }\n    moveGroupOrPanel(options) {\n        var _a;\n        const destinationGroup = options.to.group;\n        const sourceGroupId = options.from.groupId;\n        const sourceItemId = options.from.panelId;\n        const destinationTarget = options.to.position;\n        const destinationIndex = options.to.index;\n        const sourceGroup = sourceGroupId\n            ? (_a = this._groups.get(sourceGroupId)) === null || _a === void 0 ? void 0 : _a.value\n            : undefined;\n        if (!sourceGroup) {\n            throw new Error(`Failed to find group id ${sourceGroupId}`);\n        }\n        if (sourceItemId === undefined) {\n            /**\n             * Moving an entire group into another group\n             */\n            this.moveGroup({\n                from: { group: sourceGroup },\n                to: {\n                    group: destinationGroup,\n                    position: destinationTarget,\n                },\n                skipSetActive: options.skipSetActive,\n            });\n            return;\n        }\n        if (!destinationTarget || destinationTarget === 'center') {\n            /**\n             * Dropping a panel within another group\n             */\n            const removedPanel = this.movingLock(() => sourceGroup.model.removePanel(sourceItemId, {\n                skipSetActive: false,\n                skipSetActiveGroup: true,\n            }));\n            if (!removedPanel) {\n                throw new Error(`No panel with id ${sourceItemId}`);\n            }\n            if (sourceGroup.model.size === 0) {\n                // remove the group and do not set a new group as active\n                this.doRemoveGroup(sourceGroup, { skipActive: true });\n            }\n            // Check if destination group is empty - if so, force render the component\n            const isDestinationGroupEmpty = destinationGroup.model.size === 0;\n            this.movingLock(() => {\n                var _a;\n                return destinationGroup.model.openPanel(removedPanel, {\n                    index: destinationIndex,\n                    skipSetActive: ((_a = options.skipSetActive) !== null && _a !== void 0 ? _a : false) && !isDestinationGroupEmpty,\n                    skipSetGroupActive: true,\n                });\n            });\n            if (!options.skipSetActive) {\n                this.doSetGroupAndPanelActive(destinationGroup);\n            }\n            this._onDidMovePanel.fire({\n                panel: removedPanel,\n                from: sourceGroup,\n            });\n        }\n        else {\n            /**\n             * Dropping a panel to the extremities of a group which will place that panel\n             * into an adjacent group\n             */\n            const referenceLocation = getGridLocation(destinationGroup.element);\n            const targetLocation = getRelativeLocation(this.gridview.orientation, referenceLocation, destinationTarget);\n            if (sourceGroup.size < 2) {\n                /**\n                 * If we are moving from a group which only has one panel left we will consider\n                 * moving the group itself rather than moving the panel into a newly created group\n                 */\n                const [targetParentLocation, to] = tail(targetLocation);\n                if (sourceGroup.api.location.type === 'grid') {\n                    const sourceLocation = getGridLocation(sourceGroup.element);\n                    const [sourceParentLocation, from] = tail(sourceLocation);\n                    if (sequenceEquals(sourceParentLocation, targetParentLocation)) {\n                        // special case when 'swapping' two views within same grid location\n                        // if a group has one tab - we are essentially moving the 'group'\n                        // which is equivalent to swapping two views in this case\n                        this.gridview.moveView(sourceParentLocation, from, to);\n                        this._onDidMovePanel.fire({\n                            panel: this.getGroupPanel(sourceItemId),\n                            from: sourceGroup,\n                        });\n                        return;\n                    }\n                }\n                if (sourceGroup.api.location.type === 'popout') {\n                    /**\n                     * the source group is a popout group with a single panel\n                     *\n                     * 1. remove the panel from the group without triggering any events\n                     * 2. remove the popout group\n                     * 3. create a new group at the requested location and add that panel\n                     */\n                    const popoutGroup = this._popoutGroups.find((group) => group.popoutGroup === sourceGroup);\n                    const removedPanel = this.movingLock(() => popoutGroup.popoutGroup.model.removePanel(popoutGroup.popoutGroup.panels[0], {\n                        skipSetActive: true,\n                        skipSetActiveGroup: true,\n                    }));\n                    this.doRemoveGroup(sourceGroup, { skipActive: true });\n                    const newGroup = this.createGroupAtLocation(targetLocation);\n                    this.movingLock(() => newGroup.model.openPanel(removedPanel));\n                    this.doSetGroupAndPanelActive(newGroup);\n                    this._onDidMovePanel.fire({\n                        panel: this.getGroupPanel(sourceItemId),\n                        from: sourceGroup,\n                    });\n                    return;\n                }\n                // source group will become empty so delete the group\n                const targetGroup = this.movingLock(() => this.doRemoveGroup(sourceGroup, {\n                    skipActive: true,\n                    skipDispose: true,\n                }));\n                // after deleting the group we need to re-evaulate the ref location\n                const updatedReferenceLocation = getGridLocation(destinationGroup.element);\n                const location = getRelativeLocation(this.gridview.orientation, updatedReferenceLocation, destinationTarget);\n                this.movingLock(() => this.doAddGroup(targetGroup, location));\n                this.doSetGroupAndPanelActive(targetGroup);\n                this._onDidMovePanel.fire({\n                    panel: this.getGroupPanel(sourceItemId),\n                    from: sourceGroup,\n                });\n            }\n            else {\n                /**\n                 * The group we are removing from has many panels, we need to remove the panels we are moving,\n                 * create a new group, add the panels to that new group and add the new group in an appropiate position\n                 */\n                const removedPanel = this.movingLock(() => sourceGroup.model.removePanel(sourceItemId, {\n                    skipSetActive: false,\n                    skipSetActiveGroup: true,\n                }));\n                if (!removedPanel) {\n                    throw new Error(`No panel with id ${sourceItemId}`);\n                }\n                const dropLocation = getRelativeLocation(this.gridview.orientation, referenceLocation, destinationTarget);\n                const group = this.createGroupAtLocation(dropLocation);\n                this.movingLock(() => group.model.openPanel(removedPanel, {\n                    skipSetGroupActive: true,\n                }));\n                this.doSetGroupAndPanelActive(group);\n                this._onDidMovePanel.fire({\n                    panel: removedPanel,\n                    from: sourceGroup,\n                });\n            }\n        }\n    }\n    moveGroup(options) {\n        const from = options.from.group;\n        const to = options.to.group;\n        const target = options.to.position;\n        if (target === 'center') {\n            const activePanel = from.activePanel;\n            const panels = this.movingLock(() => [...from.panels].map((p) => from.model.removePanel(p.id, {\n                skipSetActive: true,\n            })));\n            if ((from === null || from === void 0 ? void 0 : from.model.size) === 0) {\n                this.doRemoveGroup(from, { skipActive: true });\n            }\n            this.movingLock(() => {\n                for (const panel of panels) {\n                    to.model.openPanel(panel, {\n                        skipSetActive: panel !== activePanel,\n                        skipSetGroupActive: true,\n                    });\n                }\n            });\n            // Ensure group becomes active after move\n            if (options.skipSetActive !== true) {\n                // For center moves (merges), we need to ensure the target group is active\n                // unless explicitly told not to (skipSetActive: true)\n                this.doSetGroupAndPanelActive(to);\n            }\n            else if (!this.activePanel) {\n                // Even with skipSetActive: true, ensure there's an active panel if none exists\n                // This maintains basic functionality while respecting skipSetActive\n                this.doSetGroupAndPanelActive(to);\n            }\n        }\n        else {\n            switch (from.api.location.type) {\n                case 'grid':\n                    this.gridview.removeView(getGridLocation(from.element));\n                    break;\n                case 'floating': {\n                    const selectedFloatingGroup = this._floatingGroups.find((x) => x.group === from);\n                    if (!selectedFloatingGroup) {\n                        throw new Error('failed to find floating group');\n                    }\n                    selectedFloatingGroup.dispose();\n                    break;\n                }\n                case 'popout': {\n                    const selectedPopoutGroup = this._popoutGroups.find((x) => x.popoutGroup === from);\n                    if (!selectedPopoutGroup) {\n                        throw new Error('failed to find popout group');\n                    }\n                    // Remove from popout groups list to prevent automatic restoration\n                    const index = this._popoutGroups.indexOf(selectedPopoutGroup);\n                    if (index >= 0) {\n                        this._popoutGroups.splice(index, 1);\n                    }\n                    // Clean up the reference group (ghost) if it exists and is hidden\n                    if (selectedPopoutGroup.referenceGroup) {\n                        const referenceGroup = this.getPanel(selectedPopoutGroup.referenceGroup);\n                        if (referenceGroup && !referenceGroup.api.isVisible) {\n                            this.doRemoveGroup(referenceGroup, {\n                                skipActive: true,\n                            });\n                        }\n                    }\n                    // Manually dispose the window without triggering restoration\n                    selectedPopoutGroup.window.dispose();\n                    // Update group's location and containers for target\n                    if (to.api.location.type === 'grid') {\n                        from.model.renderContainer =\n                            this.overlayRenderContainer;\n                        from.model.dropTargetContainer =\n                            this.rootDropTargetContainer;\n                        from.model.location = { type: 'grid' };\n                    }\n                    else if (to.api.location.type === 'floating') {\n                        from.model.renderContainer =\n                            this.overlayRenderContainer;\n                        from.model.dropTargetContainer =\n                            this.rootDropTargetContainer;\n                        from.model.location = { type: 'floating' };\n                    }\n                    break;\n                }\n            }\n            // For moves to grid locations\n            if (to.api.location.type === 'grid') {\n                const referenceLocation = getGridLocation(to.element);\n                const dropLocation = getRelativeLocation(this.gridview.orientation, referenceLocation, target);\n                // Add to grid for all moves targeting grid location\n                let size;\n                switch (this.gridview.orientation) {\n                    case Orientation.VERTICAL:\n                        size =\n                            referenceLocation.length % 2 == 0\n                                ? from.api.width\n                                : from.api.height;\n                        break;\n                    case Orientation.HORIZONTAL:\n                        size =\n                            referenceLocation.length % 2 == 0\n                                ? from.api.height\n                                : from.api.width;\n                        break;\n                }\n                this.gridview.addView(from, size, dropLocation);\n            }\n            else if (to.api.location.type === 'floating') {\n                // For moves to floating locations, add as floating group\n                // Get the position/size from the target floating group\n                const targetFloatingGroup = this._floatingGroups.find((x) => x.group === to);\n                if (targetFloatingGroup) {\n                    const box = targetFloatingGroup.overlay.toJSON();\n                    // Calculate position based on available properties\n                    let left, top;\n                    if ('left' in box) {\n                        left = box.left + 50;\n                    }\n                    else if ('right' in box) {\n                        left = Math.max(0, box.right - box.width - 50);\n                    }\n                    else {\n                        left = 50; // Default fallback\n                    }\n                    if ('top' in box) {\n                        top = box.top + 50;\n                    }\n                    else if ('bottom' in box) {\n                        top = Math.max(0, box.bottom - box.height - 50);\n                    }\n                    else {\n                        top = 50; // Default fallback\n                    }\n                    this.addFloatingGroup(from, {\n                        height: box.height,\n                        width: box.width,\n                        position: {\n                            left,\n                            top,\n                        },\n                    });\n                }\n            }\n        }\n        from.panels.forEach((panel) => {\n            this._onDidMovePanel.fire({ panel, from });\n        });\n        // Ensure group becomes active after move\n        if (options.skipSetActive === false) {\n            // Only activate when explicitly requested (skipSetActive: false)\n            // Use 'to' group for non-center moves since 'from' may have been destroyed\n            const targetGroup = to !== null && to !== void 0 ? to : from;\n            this.doSetGroupAndPanelActive(targetGroup);\n        }\n    }\n    doSetGroupActive(group) {\n        super.doSetGroupActive(group);\n        const activePanel = this.activePanel;\n        if (!this._moving &&\n            activePanel !== this._onDidActivePanelChange.value) {\n            this._onDidActivePanelChange.fire(activePanel);\n        }\n    }\n    doSetGroupAndPanelActive(group) {\n        super.doSetGroupActive(group);\n        const activePanel = this.activePanel;\n        if (group &&\n            this.hasMaximizedGroup() &&\n            !this.isMaximizedGroup(group)) {\n            this.exitMaximizedGroup();\n        }\n        if (!this._moving &&\n            activePanel !== this._onDidActivePanelChange.value) {\n            this._onDidActivePanelChange.fire(activePanel);\n        }\n    }\n    getNextGroupId() {\n        let id = this.nextGroupId.next();\n        while (this._groups.has(id)) {\n            id = this.nextGroupId.next();\n        }\n        return id;\n    }\n    createGroup(options) {\n        if (!options) {\n            options = {};\n        }\n        let id = options === null || options === void 0 ? void 0 : options.id;\n        if (id && this._groups.has(options.id)) {\n            console.warn(`dockview: Duplicate group id ${options === null || options === void 0 ? void 0 : options.id}. reassigning group id to avoid errors`);\n            id = undefined;\n        }\n        if (!id) {\n            id = this.nextGroupId.next();\n            while (this._groups.has(id)) {\n                id = this.nextGroupId.next();\n            }\n        }\n        const view = new DockviewGroupPanel(this, id, options);\n        view.init({ params: {}, accessor: this });\n        if (!this._groups.has(view.id)) {\n            const disposable = new CompositeDisposable(view.model.onTabDragStart((event) => {\n                this._onWillDragPanel.fire(event);\n            }), view.model.onGroupDragStart((event) => {\n                this._onWillDragGroup.fire(event);\n            }), view.model.onMove((event) => {\n                const { groupId, itemId, target, index } = event;\n                this.moveGroupOrPanel({\n                    from: { groupId: groupId, panelId: itemId },\n                    to: {\n                        group: view,\n                        position: target,\n                        index,\n                    },\n                });\n            }), view.model.onDidDrop((event) => {\n                this._onDidDrop.fire(event);\n            }), view.model.onWillDrop((event) => {\n                this._onWillDrop.fire(event);\n            }), view.model.onWillShowOverlay((event) => {\n                if (this.options.disableDnd) {\n                    event.preventDefault();\n                    return;\n                }\n                this._onWillShowOverlay.fire(event);\n            }), view.model.onUnhandledDragOverEvent((event) => {\n                this._onUnhandledDragOverEvent.fire(event);\n            }), view.model.onDidAddPanel((event) => {\n                if (this._moving) {\n                    return;\n                }\n                this._onDidAddPanel.fire(event.panel);\n            }), view.model.onDidRemovePanel((event) => {\n                if (this._moving) {\n                    return;\n                }\n                this._onDidRemovePanel.fire(event.panel);\n            }), view.model.onDidActivePanelChange((event) => {\n                if (this._moving) {\n                    return;\n                }\n                if (event.panel !== this.activePanel) {\n                    return;\n                }\n                if (this._onDidActivePanelChange.value !== event.panel) {\n                    this._onDidActivePanelChange.fire(event.panel);\n                }\n            }), Event.any(view.model.onDidPanelTitleChange, view.model.onDidPanelParametersChange)(() => {\n                this._bufferOnDidLayoutChange.fire();\n            }));\n            this._groups.set(view.id, { value: view, disposable });\n        }\n        // TODO: must be called after the above listeners have been setup, not an ideal pattern\n        view.initialize();\n        return view;\n    }\n    createPanel(options, group) {\n        var _a, _b, _c;\n        const contentComponent = options.component;\n        const tabComponent = (_a = options.tabComponent) !== null && _a !== void 0 ? _a : this.options.defaultTabComponent;\n        const view = new DockviewPanelModel(this, options.id, contentComponent, tabComponent);\n        const panel = new DockviewPanel(options.id, contentComponent, tabComponent, this, this._api, group, view, {\n            renderer: options.renderer,\n            minimumWidth: options.minimumWidth,\n            minimumHeight: options.minimumHeight,\n            maximumWidth: options.maximumWidth,\n            maximumHeight: options.maximumHeight,\n        });\n        panel.init({\n            title: (_b = options.title) !== null && _b !== void 0 ? _b : options.id,\n            params: (_c = options === null || options === void 0 ? void 0 : options.params) !== null && _c !== void 0 ? _c : {},\n        });\n        return panel;\n    }\n    createGroupAtLocation(location, size, options) {\n        const group = this.createGroup(options);\n        this.doAddGroup(group, location, size);\n        return group;\n    }\n    findGroup(panel) {\n        var _a;\n        return (_a = Array.from(this._groups.values()).find((group) => group.value.model.containsPanel(panel))) === null || _a === void 0 ? void 0 : _a.value;\n    }\n    orientationAtLocation(location) {\n        const rootOrientation = this.gridview.orientation;\n        return location.length % 2 == 1\n            ? rootOrientation\n            : orthogonal(rootOrientation);\n    }\n    updateDropTargetModel(options) {\n        if ('dndEdges' in options) {\n            this._rootDropTarget.disabled =\n                typeof options.dndEdges === 'boolean' &&\n                    options.dndEdges === false;\n            if (typeof options.dndEdges === 'object' &&\n                options.dndEdges !== null) {\n                this._rootDropTarget.setOverlayModel(options.dndEdges);\n            }\n            else {\n                this._rootDropTarget.setOverlayModel(DEFAULT_ROOT_OVERLAY_MODEL);\n            }\n        }\n        if ('rootOverlayModel' in options) {\n            this.updateDropTargetModel({ dndEdges: options.dndEdges });\n        }\n    }\n    updateTheme() {\n        var _a, _b;\n        const theme = (_a = this._options.theme) !== null && _a !== void 0 ? _a : themeAbyss;\n        this._themeClassnames.setClassNames(theme.className);\n        this.gridview.margin = (_b = theme.gap) !== null && _b !== void 0 ? _b : 0;\n        switch (theme.dndOverlayMounting) {\n            case 'absolute':\n                this.rootDropTargetContainer.disabled = false;\n                break;\n            case 'relative':\n            default:\n                this.rootDropTargetContainer.disabled = true;\n                break;\n        }\n    }\n}\n","import { getRelativeLocation, getGridLocation, } from './gridview';\nimport { tail, sequenceEquals } from '../array';\nimport { CompositeDisposable } from '../lifecycle';\nimport { BaseGrid, toTarget, } from './baseComponentGridview';\nimport { Emitter } from '../events';\nexport class GridviewComponent extends BaseGrid {\n    get orientation() {\n        return this.gridview.orientation;\n    }\n    set orientation(value) {\n        this.gridview.orientation = value;\n    }\n    get options() {\n        return this._options;\n    }\n    get deserializer() {\n        return this._deserializer;\n    }\n    set deserializer(value) {\n        this._deserializer = value;\n    }\n    constructor(container, options) {\n        var _a;\n        super(container, {\n            proportionalLayout: (_a = options.proportionalLayout) !== null && _a !== void 0 ? _a : true,\n            orientation: options.orientation,\n            styles: options.hideBorders\n                ? { separatorBorder: 'transparent' }\n                : undefined,\n            disableAutoResizing: options.disableAutoResizing,\n            className: options.className,\n        });\n        this._onDidLayoutfromJSON = new Emitter();\n        this.onDidLayoutFromJSON = this._onDidLayoutfromJSON.event;\n        this._onDidRemoveGroup = new Emitter();\n        this.onDidRemoveGroup = this._onDidRemoveGroup.event;\n        this._onDidAddGroup = new Emitter();\n        this.onDidAddGroup = this._onDidAddGroup.event;\n        this._onDidActiveGroupChange = new Emitter();\n        this.onDidActiveGroupChange = this._onDidActiveGroupChange.event;\n        this._options = options;\n        this.addDisposables(this._onDidAddGroup, this._onDidRemoveGroup, this._onDidActiveGroupChange, this.onDidAdd((event) => {\n            this._onDidAddGroup.fire(event);\n        }), this.onDidRemove((event) => {\n            this._onDidRemoveGroup.fire(event);\n        }), this.onDidActiveChange((event) => {\n            this._onDidActiveGroupChange.fire(event);\n        }));\n    }\n    updateOptions(options) {\n        super.updateOptions(options);\n        const hasOrientationChanged = typeof options.orientation === 'string' &&\n            this.gridview.orientation !== options.orientation;\n        this._options = Object.assign(Object.assign({}, this.options), options);\n        if (hasOrientationChanged) {\n            this.gridview.orientation = options.orientation;\n        }\n        this.layout(this.gridview.width, this.gridview.height, true);\n    }\n    removePanel(panel) {\n        this.removeGroup(panel);\n    }\n    /**\n     * Serialize the current state of the layout\n     *\n     * @returns A JSON respresentation of the layout\n     */\n    toJSON() {\n        var _a;\n        const data = this.gridview.serialize();\n        return {\n            grid: data,\n            activePanel: (_a = this.activeGroup) === null || _a === void 0 ? void 0 : _a.id,\n        };\n    }\n    setVisible(panel, visible) {\n        this.gridview.setViewVisible(getGridLocation(panel.element), visible);\n    }\n    setActive(panel) {\n        this._groups.forEach((value, _key) => {\n            value.value.setActive(panel === value.value);\n        });\n    }\n    focus() {\n        var _a;\n        (_a = this.activeGroup) === null || _a === void 0 ? void 0 : _a.focus();\n    }\n    fromJSON(serializedGridview) {\n        this.clear();\n        const { grid, activePanel } = serializedGridview;\n        try {\n            const queue = [];\n            // take note of the existing dimensions\n            const width = this.width;\n            const height = this.height;\n            this.gridview.deserialize(grid, {\n                fromJSON: (node) => {\n                    const { data } = node;\n                    const view = this.options.createComponent({\n                        id: data.id,\n                        name: data.component,\n                    });\n                    queue.push(() => view.init({\n                        params: data.params,\n                        minimumWidth: data.minimumWidth,\n                        maximumWidth: data.maximumWidth,\n                        minimumHeight: data.minimumHeight,\n                        maximumHeight: data.maximumHeight,\n                        priority: data.priority,\n                        snap: !!data.snap,\n                        accessor: this,\n                        isVisible: node.visible,\n                    }));\n                    this._onDidAddGroup.fire(view);\n                    this.registerPanel(view);\n                    return view;\n                },\n            });\n            this.layout(width, height, true);\n            queue.forEach((f) => f());\n            if (typeof activePanel === 'string') {\n                const panel = this.getPanel(activePanel);\n                if (panel) {\n                    this.doSetGroupActive(panel);\n                }\n            }\n        }\n        catch (err) {\n            /**\n             * To remove a group we cannot call this.removeGroup(...) since this makes assumptions about\n             * the underlying HTMLElement existing in the Gridview.\n             */\n            for (const group of this.groups) {\n                group.dispose();\n                this._groups.delete(group.id);\n                this._onDidRemoveGroup.fire(group);\n            }\n            // fires clean-up events and clears the underlying HTML gridview.\n            this.clear();\n            /**\n             * even though we have cleaned-up we still want to inform the caller of their error\n             * and we'll do this through re-throwing the original error since afterall you would\n             * expect trying to load a corrupted layout to result in an error and not silently fail...\n             */\n            throw err;\n        }\n        this._onDidLayoutfromJSON.fire();\n    }\n    clear() {\n        const hasActiveGroup = this.activeGroup;\n        const groups = Array.from(this._groups.values()); // reassign since group panels will mutate\n        for (const group of groups) {\n            group.disposable.dispose();\n            this.doRemoveGroup(group.value, { skipActive: true });\n        }\n        if (hasActiveGroup) {\n            this.doSetGroupActive(undefined);\n        }\n        this.gridview.clear();\n    }\n    movePanel(panel, options) {\n        var _a;\n        let relativeLocation;\n        const removedPanel = this.gridview.remove(panel);\n        const referenceGroup = (_a = this._groups.get(options.reference)) === null || _a === void 0 ? void 0 : _a.value;\n        if (!referenceGroup) {\n            throw new Error(`reference group ${options.reference} does not exist`);\n        }\n        const target = toTarget(options.direction);\n        if (target === 'center') {\n            throw new Error(`${target} not supported as an option`);\n        }\n        else {\n            const location = getGridLocation(referenceGroup.element);\n            relativeLocation = getRelativeLocation(this.gridview.orientation, location, target);\n        }\n        this.doAddGroup(removedPanel, relativeLocation, options.size);\n    }\n    addPanel(options) {\n        var _a, _b, _c, _d;\n        let relativeLocation = (_a = options.location) !== null && _a !== void 0 ? _a : [0];\n        if ((_b = options.position) === null || _b === void 0 ? void 0 : _b.referencePanel) {\n            const referenceGroup = (_c = this._groups.get(options.position.referencePanel)) === null || _c === void 0 ? void 0 : _c.value;\n            if (!referenceGroup) {\n                throw new Error(`reference group ${options.position.referencePanel} does not exist`);\n            }\n            const target = toTarget(options.position.direction);\n            if (target === 'center') {\n                throw new Error(`${target} not supported as an option`);\n            }\n            else {\n                const location = getGridLocation(referenceGroup.element);\n                relativeLocation = getRelativeLocation(this.gridview.orientation, location, target);\n            }\n        }\n        const view = this.options.createComponent({\n            id: options.id,\n            name: options.component,\n        });\n        view.init({\n            params: (_d = options.params) !== null && _d !== void 0 ? _d : {},\n            minimumWidth: options.minimumWidth,\n            maximumWidth: options.maximumWidth,\n            minimumHeight: options.minimumHeight,\n            maximumHeight: options.maximumHeight,\n            priority: options.priority,\n            snap: !!options.snap,\n            accessor: this,\n            isVisible: true,\n        });\n        this.registerPanel(view);\n        this.doAddGroup(view, relativeLocation, options.size);\n        this.doSetGroupActive(view);\n        return view;\n    }\n    registerPanel(panel) {\n        const disposable = new CompositeDisposable(panel.api.onDidFocusChange((event) => {\n            if (!event.isFocused) {\n                return;\n            }\n            this._groups.forEach((groupItem) => {\n                const group = groupItem.value;\n                if (group !== panel) {\n                    group.setActive(false);\n                }\n                else {\n                    group.setActive(true);\n                }\n            });\n        }));\n        this._groups.set(panel.id, {\n            value: panel,\n            disposable,\n        });\n    }\n    moveGroup(referenceGroup, groupId, target) {\n        const sourceGroup = this.getPanel(groupId);\n        if (!sourceGroup) {\n            throw new Error('invalid operation');\n        }\n        const referenceLocation = getGridLocation(referenceGroup.element);\n        const targetLocation = getRelativeLocation(this.gridview.orientation, referenceLocation, target);\n        const [targetParentLocation, to] = tail(targetLocation);\n        const sourceLocation = getGridLocation(sourceGroup.element);\n        const [sourceParentLocation, from] = tail(sourceLocation);\n        if (sequenceEquals(sourceParentLocation, targetParentLocation)) {\n            // special case when 'swapping' two views within same grid location\n            // if a group has one tab - we are essentially moving the 'group'\n            // which is equivalent to swapping two views in this case\n            this.gridview.moveView(sourceParentLocation, from, to);\n            return;\n        }\n        // source group will become empty so delete the group\n        const targetGroup = this.doRemoveGroup(sourceGroup, {\n            skipActive: true,\n            skipDispose: true,\n        });\n        // after deleting the group we need to re-evaulate the ref location\n        const updatedReferenceLocation = getGridLocation(referenceGroup.element);\n        const location = getRelativeLocation(this.gridview.orientation, updatedReferenceLocation, target);\n        this.doAddGroup(targetGroup, location);\n    }\n    removeGroup(group) {\n        super.removeGroup(group);\n    }\n    dispose() {\n        super.dispose();\n        this._onDidLayoutfromJSON.dispose();\n    }\n}\n","import { CompositeDisposable, MutableDisposable, } from '../lifecycle';\nimport { Orientation, Sizing, Splitview, } from './splitview';\nimport { Emitter } from '../events';\nimport { Resizable } from '../resizable';\nimport { Classnames } from '../dom';\n/**\n * A high-level implementation of splitview that works using 'panels'\n */\nexport class SplitviewComponent extends Resizable {\n    get panels() {\n        return this.splitview.getViews();\n    }\n    get options() {\n        return this._options;\n    }\n    get length() {\n        return this._panels.size;\n    }\n    get orientation() {\n        return this.splitview.orientation;\n    }\n    get splitview() {\n        return this._splitview;\n    }\n    set splitview(value) {\n        if (this._splitview) {\n            this._splitview.dispose();\n        }\n        this._splitview = value;\n        this._splitviewChangeDisposable.value = new CompositeDisposable(this._splitview.onDidSashEnd(() => {\n            this._onDidLayoutChange.fire(undefined);\n        }), this._splitview.onDidAddView((e) => this._onDidAddView.fire(e)), this._splitview.onDidRemoveView((e) => this._onDidRemoveView.fire(e)));\n    }\n    get minimumSize() {\n        return this.splitview.minimumSize;\n    }\n    get maximumSize() {\n        return this.splitview.maximumSize;\n    }\n    get height() {\n        return this.splitview.orientation === Orientation.HORIZONTAL\n            ? this.splitview.orthogonalSize\n            : this.splitview.size;\n    }\n    get width() {\n        return this.splitview.orientation === Orientation.HORIZONTAL\n            ? this.splitview.size\n            : this.splitview.orthogonalSize;\n    }\n    constructor(container, options) {\n        var _a;\n        super(document.createElement('div'), options.disableAutoResizing);\n        this._splitviewChangeDisposable = new MutableDisposable();\n        this._panels = new Map();\n        this._onDidLayoutfromJSON = new Emitter();\n        this.onDidLayoutFromJSON = this._onDidLayoutfromJSON.event;\n        this._onDidAddView = new Emitter();\n        this.onDidAddView = this._onDidAddView.event;\n        this._onDidRemoveView = new Emitter();\n        this.onDidRemoveView = this._onDidRemoveView.event;\n        this._onDidLayoutChange = new Emitter();\n        this.onDidLayoutChange = this._onDidLayoutChange.event;\n        this.element.style.height = '100%';\n        this.element.style.width = '100%';\n        this._classNames = new Classnames(this.element);\n        this._classNames.setClassNames((_a = options.className) !== null && _a !== void 0 ? _a : '');\n        // the container is owned by the third-party, do not modify/delete it\n        container.appendChild(this.element);\n        this._options = options;\n        this.splitview = new Splitview(this.element, options);\n        this.addDisposables(this._onDidAddView, this._onDidLayoutfromJSON, this._onDidRemoveView, this._onDidLayoutChange);\n    }\n    updateOptions(options) {\n        var _a, _b;\n        if ('className' in options) {\n            this._classNames.setClassNames((_a = options.className) !== null && _a !== void 0 ? _a : '');\n        }\n        if ('disableResizing' in options) {\n            this.disableResizing = (_b = options.disableAutoResizing) !== null && _b !== void 0 ? _b : false;\n        }\n        if (typeof options.orientation === 'string') {\n            this.splitview.orientation = options.orientation;\n        }\n        this._options = Object.assign(Object.assign({}, this.options), options);\n        this.splitview.layout(this.splitview.size, this.splitview.orthogonalSize);\n    }\n    focus() {\n        var _a;\n        (_a = this._activePanel) === null || _a === void 0 ? void 0 : _a.focus();\n    }\n    movePanel(from, to) {\n        this.splitview.moveView(from, to);\n    }\n    setVisible(panel, visible) {\n        const index = this.panels.indexOf(panel);\n        this.splitview.setViewVisible(index, visible);\n    }\n    setActive(panel, skipFocus) {\n        this._activePanel = panel;\n        this.panels\n            .filter((v) => v !== panel)\n            .forEach((v) => {\n            v.api._onDidActiveChange.fire({ isActive: false });\n            if (!skipFocus) {\n                v.focus();\n            }\n        });\n        panel.api._onDidActiveChange.fire({ isActive: true });\n        if (!skipFocus) {\n            panel.focus();\n        }\n    }\n    removePanel(panel, sizing) {\n        const item = this._panels.get(panel.id);\n        if (!item) {\n            throw new Error(`unknown splitview panel ${panel.id}`);\n        }\n        item.dispose();\n        this._panels.delete(panel.id);\n        const index = this.panels.findIndex((_) => _ === panel);\n        const removedView = this.splitview.removeView(index, sizing);\n        removedView.dispose();\n        const panels = this.panels;\n        if (panels.length > 0) {\n            this.setActive(panels[panels.length - 1]);\n        }\n    }\n    getPanel(id) {\n        return this.panels.find((view) => view.id === id);\n    }\n    addPanel(options) {\n        var _a;\n        if (this._panels.has(options.id)) {\n            throw new Error(`panel ${options.id} already exists`);\n        }\n        const view = this.options.createComponent({\n            id: options.id,\n            name: options.component,\n        });\n        view.orientation = this.splitview.orientation;\n        view.init({\n            params: (_a = options.params) !== null && _a !== void 0 ? _a : {},\n            minimumSize: options.minimumSize,\n            maximumSize: options.maximumSize,\n            snap: options.snap,\n            priority: options.priority,\n            accessor: this,\n        });\n        const size = typeof options.size === 'number' ? options.size : Sizing.Distribute;\n        const index = typeof options.index === 'number' ? options.index : undefined;\n        this.splitview.addView(view, size, index);\n        this.doAddView(view);\n        this.setActive(view);\n        return view;\n    }\n    layout(width, height) {\n        const [size, orthogonalSize] = this.splitview.orientation === Orientation.HORIZONTAL\n            ? [width, height]\n            : [height, width];\n        this.splitview.layout(size, orthogonalSize);\n    }\n    doAddView(view) {\n        const disposable = view.api.onDidFocusChange((event) => {\n            if (!event.isFocused) {\n                return;\n            }\n            this.setActive(view, true);\n        });\n        this._panels.set(view.id, disposable);\n    }\n    toJSON() {\n        var _a;\n        const views = this.splitview\n            .getViews()\n            .map((view, i) => {\n            const size = this.splitview.getViewSize(i);\n            return {\n                size,\n                data: view.toJSON(),\n                snap: !!view.snap,\n                priority: view.priority,\n            };\n        });\n        return {\n            views,\n            activeView: (_a = this._activePanel) === null || _a === void 0 ? void 0 : _a.id,\n            size: this.splitview.size,\n            orientation: this.splitview.orientation,\n        };\n    }\n    fromJSON(serializedSplitview) {\n        this.clear();\n        const { views, orientation, size, activeView } = serializedSplitview;\n        const queue = [];\n        // take note of the existing dimensions\n        const width = this.width;\n        const height = this.height;\n        this.splitview = new Splitview(this.element, {\n            orientation,\n            proportionalLayout: this.options.proportionalLayout,\n            descriptor: {\n                size,\n                views: views.map((view) => {\n                    const data = view.data;\n                    if (this._panels.has(data.id)) {\n                        throw new Error(`panel ${data.id} already exists`);\n                    }\n                    const panel = this.options.createComponent({\n                        id: data.id,\n                        name: data.component,\n                    });\n                    queue.push(() => {\n                        var _a;\n                        panel.init({\n                            params: (_a = data.params) !== null && _a !== void 0 ? _a : {},\n                            minimumSize: data.minimumSize,\n                            maximumSize: data.maximumSize,\n                            snap: view.snap,\n                            priority: view.priority,\n                            accessor: this,\n                        });\n                    });\n                    panel.orientation = orientation;\n                    this.doAddView(panel);\n                    setTimeout(() => {\n                        // the original onDidAddView events are missed since they are fired before we can subcribe to them\n                        this._onDidAddView.fire(panel);\n                    }, 0);\n                    return { size: view.size, view: panel };\n                }),\n            },\n        });\n        this.layout(width, height);\n        queue.forEach((f) => f());\n        if (typeof activeView === 'string') {\n            const panel = this.getPanel(activeView);\n            if (panel) {\n                this.setActive(panel);\n            }\n        }\n        this._onDidLayoutfromJSON.fire();\n    }\n    clear() {\n        for (const disposable of this._panels.values()) {\n            disposable.dispose();\n        }\n        this._panels.clear();\n        while (this.splitview.length > 0) {\n            const view = this.splitview.removeView(0, Sizing.Distribute, true);\n            view.dispose();\n        }\n    }\n    dispose() {\n        for (const disposable of this._panels.values()) {\n            disposable.dispose();\n        }\n        this._panels.clear();\n        const views = this.splitview.getViews();\n        this._splitviewChangeDisposable.dispose();\n        this.splitview.dispose();\n        for (const view of views) {\n            view.dispose();\n        }\n        this.element.remove();\n        super.dispose();\n    }\n}\n","import { addDisposableListener } from '../events';\nimport { CompositeDisposable, MutableDisposable } from '../lifecycle';\nimport { toggleClass } from '../dom';\nimport { createChevronRightButton, createExpandMoreButton } from '../svg';\nexport class DefaultHeader extends CompositeDisposable {\n    get element() {\n        return this._element;\n    }\n    constructor() {\n        super();\n        this._expandedIcon = createExpandMoreButton();\n        this._collapsedIcon = createChevronRightButton();\n        this.disposable = new MutableDisposable();\n        this.apiRef = {\n            api: null,\n        };\n        this._element = document.createElement('div');\n        this.element.className = 'dv-default-header';\n        this._content = document.createElement('span');\n        this._expander = document.createElement('div');\n        this._expander.className = 'dv-pane-header-icon';\n        this.element.appendChild(this._expander);\n        this.element.appendChild(this._content);\n        this.addDisposables(addDisposableListener(this._element, 'click', () => {\n            var _a;\n            (_a = this.apiRef.api) === null || _a === void 0 ? void 0 : _a.setExpanded(!this.apiRef.api.isExpanded);\n        }));\n    }\n    init(params) {\n        this.apiRef.api = params.api;\n        this._content.textContent = params.title;\n        this.updateIcon();\n        this.disposable.value = params.api.onDidExpansionChange(() => {\n            this.updateIcon();\n        });\n    }\n    updateIcon() {\n        var _a;\n        const isExpanded = !!((_a = this.apiRef.api) === null || _a === void 0 ? void 0 : _a.isExpanded);\n        toggleClass(this._expander, 'collapsed', !isExpanded);\n        if (isExpanded) {\n            if (this._expander.contains(this._collapsedIcon)) {\n                this._collapsedIcon.remove();\n            }\n            if (!this._expander.contains(this._expandedIcon)) {\n                this._expander.appendChild(this._expandedIcon);\n            }\n        }\n        else {\n            if (this._expander.contains(this._expandedIcon)) {\n                this._expandedIcon.remove();\n            }\n            if (!this._expander.contains(this._collapsedIcon)) {\n                this._expander.appendChild(this._collapsedIcon);\n            }\n        }\n    }\n    update(_params) {\n        //\n    }\n    dispose() {\n        this.disposable.dispose();\n        super.dispose();\n    }\n}\n","import { PaneviewApi } from '../api/component.api';\nimport { Emitter } from '../events';\nimport { CompositeDisposable, MutableDisposable, } from '../lifecycle';\nimport { Orientation, Sizing } from '../splitview/splitview';\nimport { Paneview } from './paneview';\nimport { DraggablePaneviewPanel, } from './draggablePaneviewPanel';\nimport { DefaultHeader } from './defaultPaneviewHeader';\nimport { sequentialNumberGenerator } from '../math';\nimport { Resizable } from '../resizable';\nimport { Classnames } from '../dom';\nconst nextLayoutId = sequentialNumberGenerator();\nconst HEADER_SIZE = 22;\nconst MINIMUM_BODY_SIZE = 0;\nconst MAXIMUM_BODY_SIZE = Number.MAX_SAFE_INTEGER;\nexport class PaneFramework extends DraggablePaneviewPanel {\n    constructor(options) {\n        super({\n            accessor: options.accessor,\n            id: options.id,\n            component: options.component,\n            headerComponent: options.headerComponent,\n            orientation: options.orientation,\n            isExpanded: options.isExpanded,\n            disableDnd: options.disableDnd,\n            headerSize: options.headerSize,\n            minimumBodySize: options.minimumBodySize,\n            maximumBodySize: options.maximumBodySize,\n        });\n        this.options = options;\n    }\n    getBodyComponent() {\n        return this.options.body;\n    }\n    getHeaderComponent() {\n        return this.options.header;\n    }\n}\nexport class PaneviewComponent extends Resizable {\n    get id() {\n        return this._id;\n    }\n    get panels() {\n        return this.paneview.getPanes();\n    }\n    set paneview(value) {\n        this._paneview = value;\n        this._disposable.value = new CompositeDisposable(this._paneview.onDidChange(() => {\n            this._onDidLayoutChange.fire(undefined);\n        }), this._paneview.onDidAddView((e) => this._onDidAddView.fire(e)), this._paneview.onDidRemoveView((e) => this._onDidRemoveView.fire(e)));\n    }\n    get paneview() {\n        return this._paneview;\n    }\n    get minimumSize() {\n        return this.paneview.minimumSize;\n    }\n    get maximumSize() {\n        return this.paneview.maximumSize;\n    }\n    get height() {\n        return this.paneview.orientation === Orientation.HORIZONTAL\n            ? this.paneview.orthogonalSize\n            : this.paneview.size;\n    }\n    get width() {\n        return this.paneview.orientation === Orientation.HORIZONTAL\n            ? this.paneview.size\n            : this.paneview.orthogonalSize;\n    }\n    get options() {\n        return this._options;\n    }\n    constructor(container, options) {\n        var _a;\n        super(document.createElement('div'), options.disableAutoResizing);\n        this._id = nextLayoutId.next();\n        this._disposable = new MutableDisposable();\n        this._viewDisposables = new Map();\n        this._onDidLayoutfromJSON = new Emitter();\n        this.onDidLayoutFromJSON = this._onDidLayoutfromJSON.event;\n        this._onDidLayoutChange = new Emitter();\n        this.onDidLayoutChange = this._onDidLayoutChange.event;\n        this._onDidDrop = new Emitter();\n        this.onDidDrop = this._onDidDrop.event;\n        this._onDidAddView = new Emitter();\n        this.onDidAddView = this._onDidAddView.event;\n        this._onDidRemoveView = new Emitter();\n        this.onDidRemoveView = this._onDidRemoveView.event;\n        this._onUnhandledDragOverEvent = new Emitter();\n        this.onUnhandledDragOverEvent = this._onUnhandledDragOverEvent.event;\n        this.element.style.height = '100%';\n        this.element.style.width = '100%';\n        this.addDisposables(this._onDidLayoutChange, this._onDidLayoutfromJSON, this._onDidDrop, this._onDidAddView, this._onDidRemoveView, this._onUnhandledDragOverEvent);\n        this._classNames = new Classnames(this.element);\n        this._classNames.setClassNames((_a = options.className) !== null && _a !== void 0 ? _a : '');\n        // the container is owned by the third-party, do not modify/delete it\n        container.appendChild(this.element);\n        this._options = options;\n        this.paneview = new Paneview(this.element, {\n            // only allow paneview in the vertical orientation for now\n            orientation: Orientation.VERTICAL,\n        });\n        this.addDisposables(this._disposable);\n    }\n    setVisible(panel, visible) {\n        const index = this.panels.indexOf(panel);\n        this.paneview.setViewVisible(index, visible);\n    }\n    focus() {\n        //noop\n    }\n    updateOptions(options) {\n        var _a, _b;\n        if ('className' in options) {\n            this._classNames.setClassNames((_a = options.className) !== null && _a !== void 0 ? _a : '');\n        }\n        if ('disableResizing' in options) {\n            this.disableResizing = (_b = options.disableAutoResizing) !== null && _b !== void 0 ? _b : false;\n        }\n        this._options = Object.assign(Object.assign({}, this.options), options);\n    }\n    addPanel(options) {\n        var _a, _b;\n        const body = this.options.createComponent({\n            id: options.id,\n            name: options.component,\n        });\n        let header;\n        if (options.headerComponent && this.options.createHeaderComponent) {\n            header = this.options.createHeaderComponent({\n                id: options.id,\n                name: options.headerComponent,\n            });\n        }\n        if (!header) {\n            header = new DefaultHeader();\n        }\n        const view = new PaneFramework({\n            id: options.id,\n            component: options.component,\n            headerComponent: options.headerComponent,\n            header,\n            body,\n            orientation: Orientation.VERTICAL,\n            isExpanded: !!options.isExpanded,\n            disableDnd: !!this.options.disableDnd,\n            accessor: this,\n            headerSize: (_a = options.headerSize) !== null && _a !== void 0 ? _a : HEADER_SIZE,\n            minimumBodySize: MINIMUM_BODY_SIZE,\n            maximumBodySize: MAXIMUM_BODY_SIZE,\n        });\n        this.doAddPanel(view);\n        const size = typeof options.size === 'number' ? options.size : Sizing.Distribute;\n        const index = typeof options.index === 'number' ? options.index : undefined;\n        view.init({\n            params: (_b = options.params) !== null && _b !== void 0 ? _b : {},\n            minimumBodySize: options.minimumBodySize,\n            maximumBodySize: options.maximumBodySize,\n            isExpanded: options.isExpanded,\n            title: options.title,\n            containerApi: new PaneviewApi(this),\n            accessor: this,\n        });\n        this.paneview.addPane(view, size, index);\n        view.orientation = this.paneview.orientation;\n        return view;\n    }\n    removePanel(panel) {\n        const views = this.panels;\n        const index = views.findIndex((_) => _ === panel);\n        this.paneview.removePane(index);\n        this.doRemovePanel(panel);\n    }\n    movePanel(from, to) {\n        this.paneview.moveView(from, to);\n    }\n    getPanel(id) {\n        return this.panels.find((view) => view.id === id);\n    }\n    layout(width, height) {\n        const [size, orthogonalSize] = this.paneview.orientation === Orientation.HORIZONTAL\n            ? [width, height]\n            : [height, width];\n        this.paneview.layout(size, orthogonalSize);\n    }\n    toJSON() {\n        const maximum = (value) => value === Number.MAX_SAFE_INTEGER ||\n            value === Number.POSITIVE_INFINITY\n            ? undefined\n            : value;\n        const minimum = (value) => (value <= 0 ? undefined : value);\n        const views = this.paneview\n            .getPanes()\n            .map((view, i) => {\n            const size = this.paneview.getViewSize(i);\n            return {\n                size,\n                data: view.toJSON(),\n                minimumSize: minimum(view.minimumBodySize),\n                maximumSize: maximum(view.maximumBodySize),\n                headerSize: view.headerSize,\n                expanded: view.isExpanded(),\n            };\n        });\n        return {\n            views,\n            size: this.paneview.size,\n        };\n    }\n    fromJSON(serializedPaneview) {\n        this.clear();\n        const { views, size } = serializedPaneview;\n        const queue = [];\n        // take note of the existing dimensions\n        const width = this.width;\n        const height = this.height;\n        this.paneview = new Paneview(this.element, {\n            orientation: Orientation.VERTICAL,\n            descriptor: {\n                size,\n                views: views.map((view) => {\n                    var _a, _b, _c;\n                    const data = view.data;\n                    const body = this.options.createComponent({\n                        id: data.id,\n                        name: data.component,\n                    });\n                    let header;\n                    if (data.headerComponent &&\n                        this.options.createHeaderComponent) {\n                        header = this.options.createHeaderComponent({\n                            id: data.id,\n                            name: data.headerComponent,\n                        });\n                    }\n                    if (!header) {\n                        header = new DefaultHeader();\n                    }\n                    const panel = new PaneFramework({\n                        id: data.id,\n                        component: data.component,\n                        headerComponent: data.headerComponent,\n                        header,\n                        body,\n                        orientation: Orientation.VERTICAL,\n                        isExpanded: !!view.expanded,\n                        disableDnd: !!this.options.disableDnd,\n                        accessor: this,\n                        headerSize: (_a = view.headerSize) !== null && _a !== void 0 ? _a : HEADER_SIZE,\n                        minimumBodySize: (_b = view.minimumSize) !== null && _b !== void 0 ? _b : MINIMUM_BODY_SIZE,\n                        maximumBodySize: (_c = view.maximumSize) !== null && _c !== void 0 ? _c : MAXIMUM_BODY_SIZE,\n                    });\n                    this.doAddPanel(panel);\n                    queue.push(() => {\n                        var _a;\n                        panel.init({\n                            params: (_a = data.params) !== null && _a !== void 0 ? _a : {},\n                            minimumBodySize: view.minimumSize,\n                            maximumBodySize: view.maximumSize,\n                            title: data.title,\n                            isExpanded: !!view.expanded,\n                            containerApi: new PaneviewApi(this),\n                            accessor: this,\n                        });\n                        panel.orientation = this.paneview.orientation;\n                    });\n                    setTimeout(() => {\n                        // the original onDidAddView events are missed since they are fired before we can subcribe to them\n                        this._onDidAddView.fire(panel);\n                    }, 0);\n                    return { size: view.size, view: panel };\n                }),\n            },\n        });\n        this.layout(width, height);\n        queue.forEach((f) => f());\n        this._onDidLayoutfromJSON.fire();\n    }\n    clear() {\n        for (const [_, value] of this._viewDisposables.entries()) {\n            value.dispose();\n        }\n        this._viewDisposables.clear();\n        this.paneview.dispose();\n    }\n    doAddPanel(panel) {\n        const disposable = new CompositeDisposable(panel.onDidDrop((event) => {\n            this._onDidDrop.fire(event);\n        }), panel.onUnhandledDragOverEvent((event) => {\n            this._onUnhandledDragOverEvent.fire(event);\n        }));\n        this._viewDisposables.set(panel.id, disposable);\n    }\n    doRemovePanel(panel) {\n        const disposable = this._viewDisposables.get(panel.id);\n        if (disposable) {\n            disposable.dispose();\n            this._viewDisposables.delete(panel.id);\n        }\n    }\n    dispose() {\n        super.dispose();\n        for (const [_, value] of this._viewDisposables.entries()) {\n            value.dispose();\n        }\n        this._viewDisposables.clear();\n        this.element.remove();\n        this.paneview.dispose();\n    }\n}\n","import { BasePanelView, } from '../gridview/basePanelView';\nimport { SplitviewPanelApiImpl } from '../api/splitviewPanelApi';\nimport { Orientation } from './splitview';\nimport { Emitter } from '../events';\nexport class SplitviewPanel extends BasePanelView {\n    get priority() {\n        return this._priority;\n    }\n    set orientation(value) {\n        this._orientation = value;\n    }\n    get orientation() {\n        return this._orientation;\n    }\n    get minimumSize() {\n        const size = typeof this._minimumSize === 'function'\n            ? this._minimumSize()\n            : this._minimumSize;\n        if (size !== this._evaluatedMinimumSize) {\n            this._evaluatedMinimumSize = size;\n            this.updateConstraints();\n        }\n        return size;\n    }\n    get maximumSize() {\n        const size = typeof this._maximumSize === 'function'\n            ? this._maximumSize()\n            : this._maximumSize;\n        if (size !== this._evaluatedMaximumSize) {\n            this._evaluatedMaximumSize = size;\n            this.updateConstraints();\n        }\n        return size;\n    }\n    get snap() {\n        return this._snap;\n    }\n    constructor(id, componentName) {\n        super(id, componentName, new SplitviewPanelApiImpl(id, componentName));\n        this._evaluatedMinimumSize = 0;\n        this._evaluatedMaximumSize = Number.POSITIVE_INFINITY;\n        this._minimumSize = 0;\n        this._maximumSize = Number.POSITIVE_INFINITY;\n        this._snap = false;\n        this._onDidChange = new Emitter();\n        this.onDidChange = this._onDidChange.event;\n        this.api.initialize(this);\n        this.addDisposables(this._onDidChange, this.api.onWillVisibilityChange((event) => {\n            const { isVisible } = event;\n            const { accessor } = this._params;\n            accessor.setVisible(this, isVisible);\n        }), this.api.onActiveChange(() => {\n            const { accessor } = this._params;\n            accessor.setActive(this);\n        }), this.api.onDidConstraintsChangeInternal((event) => {\n            if (typeof event.minimumSize === 'number' ||\n                typeof event.minimumSize === 'function') {\n                this._minimumSize = event.minimumSize;\n            }\n            if (typeof event.maximumSize === 'number' ||\n                typeof event.maximumSize === 'function') {\n                this._maximumSize = event.maximumSize;\n            }\n            this.updateConstraints();\n        }), this.api.onDidSizeChange((event) => {\n            this._onDidChange.fire({ size: event.size });\n        }));\n    }\n    setVisible(isVisible) {\n        this.api._onDidVisibilityChange.fire({ isVisible });\n    }\n    setActive(isActive) {\n        this.api._onDidActiveChange.fire({ isActive });\n    }\n    layout(size, orthogonalSize) {\n        const [width, height] = this.orientation === Orientation.HORIZONTAL\n            ? [size, orthogonalSize]\n            : [orthogonalSize, size];\n        super.layout(width, height);\n    }\n    init(parameters) {\n        super.init(parameters);\n        this._priority = parameters.priority;\n        if (parameters.minimumSize) {\n            this._minimumSize = parameters.minimumSize;\n        }\n        if (parameters.maximumSize) {\n            this._maximumSize = parameters.maximumSize;\n        }\n        if (parameters.snap) {\n            this._snap = parameters.snap;\n        }\n    }\n    toJSON() {\n        const maximum = (value) => value === Number.MAX_SAFE_INTEGER ||\n            value === Number.POSITIVE_INFINITY\n            ? undefined\n            : value;\n        const minimum = (value) => (value <= 0 ? undefined : value);\n        return Object.assign(Object.assign({}, super.toJSON()), { minimumSize: minimum(this.minimumSize), maximumSize: maximum(this.maximumSize) });\n    }\n    updateConstraints() {\n        this.api._onDidConstraintsChange.fire({\n            maximumSize: this._evaluatedMaximumSize,\n            minimumSize: this._evaluatedMinimumSize,\n        });\n    }\n}\n","import { GridviewApi, PaneviewApi, SplitviewApi, } from '../api/component.api';\nimport { DockviewComponent } from '../dockview/dockviewComponent';\nimport { GridviewComponent } from '../gridview/gridviewComponent';\nimport { PaneviewComponent } from '../paneview/paneviewComponent';\nimport { SplitviewComponent } from '../splitview/splitviewComponent';\nexport function createDockview(element, options) {\n    const component = new DockviewComponent(element, options);\n    return component.api;\n}\nexport function createSplitview(element, options) {\n    const component = new SplitviewComponent(element, options);\n    return new SplitviewApi(component);\n}\nexport function createGridview(element, options) {\n    const component = new GridviewComponent(element, options);\n    return new GridviewApi(component);\n}\nexport function createPaneview(element, options) {\n    const component = new PaneviewComponent(element, options);\n    return new PaneviewApi(component);\n}\n"],"names":["Event","Disposable","css","ref","insertAt","document","head","getElementsByTagName","style","createElement","type","firstChild","insertBefore","appendChild","styleSheet","cssText","createTextNode","TransferObject","PanelTransfer","constructor","viewId","groupId","panelId","super","this","PaneTransfer","paneId","LocalSelectionTransfer","getInstance","INSTANCE","hasData","proto","clearData","undefined","data","getData","setData","getPanelData","panelTransfer","prototype","getPaneData","paneTransfer","any","children","listener","disposables","map","child","dispose","forEach","d","DockviewEvent","_defaultPrevented","defaultPrevented","preventDefault","AcceptableEvent","_isAccepted","isAccepted","accept","Stacktrace","create","_a","Error","stack","value","print","console","warn","Listener","callback","stacktrace","Emitter","setLeakageMonitorEnabled","isEnabled","ENABLE_TRACKING","MEMORY_LEAK_WATCHER","clear","_last","options","_listeners","_disposed","event","_event","replay","push","index","indexOf","splice","add","fire","e","length","queueMicrotask","delete","addDisposableListener","element","addEventListener","removeEventListener","events","Map","size","set","AsapEvent","_onFired","_currentFireCount","_queued","onEvent","fireCountAtTimeOfEventSubscription","NONE","from","func","CompositeDisposable","isDisposed","_isDisposed","args","_disposables","addDisposables","arg","MutableDisposable","_disposable","disposable","OverflowObserver","el","_onDidChange","onDidChange","_value","watchElementResize","entry","hasScrollX","target","scrollWidth","clientWidth","hasScrollY","scrollHeight","clientHeight","cb","observer","ResizeObserver","entires","requestAnimationFrame","firstEntry","observe","unobserve","disconnect","removeClasses","classes","classname","classList","contains","remove","addClasses","toggleClass","className","isToggled","hasClass","isAncestor","testChild","testAncestor","parentNode","trackFocus","FocusTracker","_onDidFocus","onDidFocus","_onDidBlur","onDidBlur","hasFocus","activeElement","loosingFocus","onFocus","onBlur","window","setTimeout","_refreshStateHandler","refreshState","QUASI_PREVENT_DEFAULT_KEY","quasiDefaultPrevented","getDomNodePagePosition","domNode","left","top","width","height","getBoundingClientRect","scrollX","scrollY","disableIframePointEvents","rootNode","iframes","tagNames","findIframesInNode","node","nodeType","Node","ELEMENT_NODE","includes","tagName","shadowRoot","documentElement","allTagsNamesInclusiveOfShadowDoms","original","WeakMap","iframe","pointerEvents","release","get","Classnames","_classNames","setClassNames","classNames","split","filter","v","trim","tail","arr","slice","sequenceEquals","arr1","arr2","i","pushToStart","unshift","pushToEnd","array","findIndex","t","clamp","min","max","Math","sequentialNumberGenerator","next","toString","range","to","result","ViewItem","_size","cachedVisibleSize","_cachedVisibleSize","visible","minimumSize","view","viewMinimumSize","maximumSize","viewMaximumSize","priority","snap","enabled","container","setVisible","toggle","Orientation","SashState","LayoutPriority","Sizing","Distribute","Split","Invisible","Splitview","contentSize","_contentSize","orthogonalSize","_orthogonalSize","viewItems","proportions","_proportions","orientation","_orientation","tmp","HORIZONTAL","reduce","r","item","Number","POSITIVE_INFINITY","startSnappingEnabled","_startSnappingEnabled","updateSashEnablement","endSnappingEnabled","_endSnappingEnabled","disabled","_disabled","margin","_margin","_b","sashes","_onDidSashEnd","onDidSashEnd","_onDidAddView","onDidAddView","_onDidRemoveView","onDidRemoveView","resize","delta","sizes","x","lowPriorityIndexes","highPriorityIndexes","overloadMinDelta","NEGATIVE_INFINITY","overloadMaxDelta","snapBefore","snapAfter","upIndexes","downIndexes","upItems","upSizes","downItems","downSizes","minDeltaUp","_","maxDeltaUp","maxDeltaDown","minDeltaDown","minDelta","maxDelta","snapped","snapView","limitDelta","actualDelta","deltaUp","viewDelta","deltaDown","VERTICAL","createContainer","proportionalLayout","viewContainer","createViewContainer","sashContainer","createSashContainer","styles","descriptor","views","viewDescriptor","sizing","addView","saveProportions","separatorBorder","removeProperty","setProperty","isViewVisible","setViewVisible","viewItem","distributeEmptySpace","layoutViews","getViewSize","resizeView","indexes","Low","High","round","relayout","getViews","skipLayout","viewSize","newSize","removeChild","sash","onPointerStart","start","clientX","clientY","sashIndex","fn","firstIndex","s","snapBeforeIndex","findFirstSnapIndex","snapAfterIndex","snappedViewItem","halfSize","floor","onPointerMove","end","sashItem","distributeViewSizes","flexibleViewItems","flexibleSize","removeView","getViewCachedVisibleSize","moveView","layout","previousSize","total","proportion","lowPriorityIndex","emptyDelta","visibleViewItems","sashCount","marginReducedSize","totalLeftOffset","viewLeftOffsets","runningVisiblePanelCount","flag","visiblePanelsBeforeThisView","offset","sashWidth","previous","collapsesDown","expandsDown","reverseViews","reverse","collapsesUp","expandsUp","position","snappedBefore","snappedAfter","updateSash","MINIMUM","MAXIMUM","DISABLED","ENABLED","state","orientationClassname","PROPERTY_KEYS_SPLITVIEW","properties","disableAutoResizing","Object","keys","Paneview","splitview","paneItems","skipAnimation","getPanes","pane","onDidChangeExpansionState","setupAnimation","paneItem","addPane","removePane","skipDispose","animationTimer","clearTimeout","LeafNode","minimumWidth","maximumWidth","minimumHeight","maximumHeight","minimumOrthogonalSize","maximumOrthogonalSize","BranchNode","c","Normal","priorities","some","p","childDescriptors","_childrenDisposable","_onDidVisibilityChange","onDidVisibilityChange","childDescriptor","setupChildrenEvents","_visible","isChildVisible","setChildVisible","wereAllChildrenHidden","areAllChildrenHidden","moveChild","_removeChild","_addChild","getChildSize","resizeChild","addChild","getChildCachedVisibleSize","findLeaf","candiateNode","last","cloneNode","flipNode","orthogonal","totalSize","childSize","indexInParent","parentElement","firstElementChild","lastElementChild","nextElementSibling","getGridLocation","test","getRelativeLocation","rootOrientation","location","direction","getLocationOrientation","getDirectionOrientation","rest","_index","isGridBranchNode","serializeBranchNode","box","toJSON","Gridview","_root","root","locked","_locked","branch","pop","maximizedView","_maximizedNode","leaf","hasMaximizedView","maximizeView","getNode","exitMaximizedView","getView","hiddenOnMaximize","hideAllViewsBut","parent","exclude","_onDidMaximizedNodeChange","isMaximized","showViewsInReverseOrder","serialize","maxmizedViewLocation","resullt","maximizedNode","_onDidViewVisibilityChange","deserialize","json","deserializer","_deserialize","_deserializeNode","serializedChild","fromJSON","call","oldRoot","normalize","childReference","insertOrthogonalSplitviewAtRoot","progmaticSelect","_getViews","nodeCachedVisibleSize","path","n","l","onDidViewVisibilityChange","onDidMaximizedNodeChange","parentLocation","pathToParent","grandParent","parentIndex","__","newSiblingSize","newSiblingCachedVisibleSize","newParent","newSibling","nodeToRemove","sibling","isSiblingVisible","siblingSizing","PROPERTY_KEYS_GRIDVIEW","hideBorders","Resizable","_element","disableResizing","_disableResizing","offsetParent","currentElement","DocumentFragment","host","isInDocument","contentRect","nextLayoutId","toTarget","BaseGrid","id","_id","_groups","groups","Array","values","gridview","activeGroup","_activeGroup","_onDidRemove","onDidRemove","_onDidAdd","onDidAdd","_onDidMaximizedChange","onDidMaximizedChange","_onDidActiveChange","onDidActiveChange","_bufferOnDidLayoutChange","onDidLayoutChange","_onDidViewVisibilityChangeMicroTaskQueue","onDidViewVisibilityChangeMicroTaskQueue","panel","isVisible","updateOptions","_c","_d","maximizeGroup","doSetGroupActive","isMaximizedGroup","exitMaximizedGroup","hasMaximizedGroup","doAddGroup","group","doRemoveGroup","has","skipActive","getPanel","setActive","removeGroup","moveToNext","moveToPrevious","forceResize","SplitviewApi","component","panels","onDidLayoutFromJSON","removePanel","focus","addPanel","movePanel","PaneviewApi","onDidDrop","onUnhandledDragOverEvent","GridviewApi","onDidAddPanel","onDidAddGroup","onDidRemovePanel","onDidRemoveGroup","onDidActivePanelChange","onDidActiveGroupChange","force","DockviewApi","totalPanels","onDidMovePanel","onWillDrop","onWillShowOverlay","onWillDragGroup","onWillDragPanel","onDidPopoutGroupSizeChange","onDidPopoutGroupPositionChange","onDidOpenPopoutWindowFail","activePanel","getGroupPanel","addGroup","closeAllGroups","getGroup","addFloatingGroup","onDidMaximizedGroupChange","addPopoutGroup","DragHandler","dataDisposable","pointerEventsDisposable","_onDragStart","onDragStart","configure","setDisabled","isCancelled","dataTransfer","effectAllowed","items","DragAndDropObserver","callbacks","registerListeners","onDragEnter","onDragOver","onDragLeave","onDragEnd","onDrop","WillShowOverlayEvent","nativeEvent","directionToPosition","positionToDirection","DEFAULT_ACTIVATION_SIZE","DEFAULT_SIZE","Droptarget","_state","_onDrop","_onWillShowOverlay","_acceptedTargetZonesSet","Set","acceptedTargetZones","dnd","getOverrideTarget","getElements","_e","_f","_g","ACTUAL_TARGET","overrideTarget","removeDropTarget","getOverlayOutline","offsetWidth","offsetHeight","rect","currentTarget","y","quadrant","calculateQuadrant","isAlreadyUsed","canDisplayOverlay","willShowOverlayEvent","markAsUsed","targetElement","overlayElement","append","toggleClasses","stopPropagation","setTargetZones","setOverlayModel","model","overlayModel","USED_EVENT_ID","isSmallX","isSmallY","isLeft","isRight","isTop","isBottom","rightClass","leftClass","topClass","bottomClass","sizeOptions","outlineEl","elBox","ta","overlay","bigbox","rootTop","rootLeft","bounds","topPx","leftPx","widthPx","heightPx","checkBoundsChanged","visibility","transform","setGPUOptimizedBounds","changed","setGPUOptimizedBoundsFromStrings","overlayType","activationSizeOptions","activationSize","threshold","xp","yp","calculateQuadrantAsPercentage","calculateQuadrantAsPixels","PROPERTY_KEYS_PANEVIEW","disableDnd","PaneviewUnhandledDragOverEvent","WillFocusEvent","PanelApiImpl","isFocused","_isFocused","isActive","_isActive","_isVisible","_width","_height","_parameters","panelUpdatesDisposable","_onDidDimensionChange","onDidDimensionsChange","_onDidChangeFocus","onDidFocusChange","_onWillFocus","onWillFocus","_onWillVisibilityChange","onWillVisibilityChange","_onActiveChange","onActiveChange","_onDidParametersChange","onDidParametersChange","getParameters","initialize","parameters","update","params","updateParameters","SplitviewPanelApiImpl","_onDidConstraintsChangeInternal","onDidConstraintsChangeInternal","_onDidConstraintsChange","onDidConstraintsChange","_onDidSizeChange","onDidSizeChange","setConstraints","setSize","PaneviewPanelApiImpl","_pane","_onDidExpansionChange","onDidExpansionChange","_onMouseEnter","onMouseEnter","_onMouseLeave","onMouseLeave","setExpanded","isExpanded","BasePanelView","_params","api","tabIndex","outline","overflow","focusTracker","part","init","getComponent","assign","key","PaneviewPanel","headerSize","_minimumBodySize","_maximumBodySize","minimumBodySize","maximumBodySize","headerVisible","_headerVisible","header","display","_onDidChangeExpansionState","_isExpanded","headerComponent","isHeaderVisible","accessor","ev","isPanelExpanded","renderOnce","expanded","body","bodyPart","getBodyComponent","headerPart","getHeaderComponent","title","lineHeight","minHeight","maxHeight","DraggablePaneviewPanel","_onDidDrop","_onUnhandledDragOverEvent","initDragFeatures","accessorId","draggable","handler","firedEvent","containerApi","existingPanel","allPanels","fromIndex","toIndex","ContentContainer","dropTargetContainer","dropTarget","theme","dndPanelOverlay","shiftKey","show","hide","renderPanel","asActive","doRender","isPanelActive","content","renderer","renderContainer","detatch","attach","referenceContainer","openPanel","closePanel","addGhostImage","ghostElement","setDragImage","TabDragHandler","Tab","_onPointDown","onPointerDown","_onDropped","dragHandler","getComputedStyle","newNode","getPropertyValue","getPropertyPriority","setContent","updateDragAndDropState","WillShowOverlayLocationEvent","kind","GroupDragHandler","dragEvent","bgColor","color","backgroundColor","padding","fontSize","borderRadius","textContent","VoidContainer","Scrollbar","scrollableElement","_scrollLeft","_horizontalScrollbar","deltaY","MouseWheelSpeed","calculateScrollbarStyles","originalClientX","originalScrollLeft","deltaX","onEnd","scrollLeft","_animationTimer","px","percentageComplete","Tabs","showTabsOverflowControl","_showTabsOverflowControl","_tabsList","_observerDisposable","hasOverflow","toggleDropdown","reset","_tabs","tabs","selectedIndex","_onTabDragStart","onTabDragStart","_onOverflowTabsChange","onOverflowTabsChange","scrollbars","scrollbar","button","tab","setActivePanel","runningWidth","isActivePanel","find","isFloatingGroupsEnabled","disableFloatingGroups","isFloatingWithOnePanel","inDragMode","addTab","tabToRemove","childPosition","parentPosition","isChildEntirelyVisibleWithinParent","createSvgElementFromPath","svg","createElementNS","setAttributeNS","viewbox","createChevronRightButton","TabsContainer","hidden","_hidden","dropdownPart","_overflowTabs","_dropdownDisposable","_onGroupDragStart","onGroupDragStart","singleTabMode","rightActionsContainer","leftActionsContainer","preActionsContainer","disableTabsOverflowList","voidContainer","onDidOptionsChange","setRightActionsElement","rightActions","setLeftActionsElement","leftActions","setPrefixActionsElement","preActions","_isGroupActive","updateClassnames","text","icon","createDropdownElementHandle","prepend","capture","panelObject","createTabRenderer","wrapper","popupService","close","scrollIntoView","relativeParent","zIndex","findRelativeZIndexParent","openPopover","DockviewUnhandledDragOverEvent","PROPERTY_KEYS_DOCKVIEW","floatingGroupBounds","popoutUrl","defaultRenderer","debug","rootOverlayModel","noPanelsOverlay","dndEdges","isPanelOptionsWithPanel","referencePanel","isPanelOptionsWithGroup","referenceGroup","isGroupOptionsWithPanel","isGroupOptionsWithGroup","DockviewDidDropEvent","DockviewWillDropEvent","_kind","DockviewGroupPanelModel","_activePanel","_panels","isEmpty","hasWatermark","watermark","tabsContainer","isContentFocused","contentContainer","_location","groupPanel","_onDidLocationChange","mostRecentlyUsed","_overwriteRenderContainer","_overwriteDropTargetContainer","_panelDisposables","_onMove","onMove","_onWillDrop","_onDidAddPanel","_onDidPanelTitleChange","onDidPanelTitleChange","_onDidPanelParametersChange","onDidPanelParametersChange","_onDidRemovePanel","_onDidActivePanelChange","_api","hideHeader","handleDropEvent","focusContent","rerender","overlayRenderContainer","rootDropTargetContainer","doAddPanel","updateContainer","createRightHeaderActionComponent","_rightHeaderActions","createLeftHeaderActionComponent","_leftHeaderActions","createPrefixHeaderActionComponent","_prefixHeaderActions","activeView","normalizedIndex","suppressRoll","containsPanel","skipSetActive","updateParentGroup","doSetActivePanel","skipSetGroupActive","groupItemOrId","panelToRemove","_removePanel","closeAllPanels","arrPanelCpy","doClose","isLast","removeEmptyGroup","updateActions","isGroupActive","doRemovePanel","nextPanel","skipSetActiveGroup","hasExistingPanel","updateMru","onDidTitleChange","runEvents","createWatermarkComponent","willDropEvent","getKind","itemId","GridviewPanelApiImpl","GridviewPanel","_priority","_snap","__minimumWidth","__minimumHeight","__maximumHeight","__maximumWidth","_minimumWidth","_evaluatedMinimumWidth","updateConstraints","_maximumWidth","_evaluatedMaximumWidth","_minimumHeight","_evaluatedMinimumHeight","_maximumHeight","_evaluatedMaximumHeight","MAX_SAFE_INTEGER","maximum","minimum","NOT_INITIALIZED_MESSAGE","DockviewGroupPanelApiImpl","_group","onDidLocationChange","getWindow","moveTo","moveGroupOrPanel","maximize","exitMaximized","DockviewGroupPanel","activePanelMinimumWidth","activePanelMinimumHeight","activePanelMaximumWidth","activePanelMaximumHeight","_model","constraints","themeDark","name","themeLight","themeVisualStudio","themeAbyss","themeDracula","themeReplit","gap","themeAbyssSpaced","dndOverlayMounting","themeLightSpaced","DockviewPanelApiImpl","oldGroup","_onDidGroupChange","setupGroupEventListeners","tabComponent","_tabComponent","_onDidTitleChange","_onDidActiveGroupChange","onDidGroupChange","_onDidRendererChange","onDidRendererChange","groupEventsDisposable","setTitle","setRenderer","previousGroup","_trackGroupActive","hasBecomeHidden","hasBecomeVisible","DockviewPanel","_title","_renderer","contentComponent","isPanelVisible","DefaultTab","_content","action","render","DockviewPanelModel","_tab","createContentComponent","createTabComponent","tabLocation","cmp","_updateEvent","componentName","createComponent","defaultTabComponent","DefaultDockviewDeserialzier","panelData","viewData","Watermark","arialLevelTracker","_orderedList","destroy","setAttribute","Overlay","minimumInViewportWidth","minimumInViewportHeight","_onDidChangeEnd","onDidChangeEnd","setupResize","setBounds","bottom","right","bringToFront","verticalAlignment","horiziontalAlignment","containerRect","overlayRect","xOffset","getMinimumWidth","yOffset","getMinimumHeight","parseFloat","setupDrag","dragTarget","move","track","resizeHandleElement","startPosition","originalY","originalHeight","originalX","originalWidth","moveTop","MAX_VALUE","MINIMUM_HEIGHT","moveBottom","moveLeft","MINIMUM_WIDTH","moveRight","DockviewFloatingGroupPanel","DEFAULT_FLOATING_GROUP_OVERFLOW_SIZE","DEFAULT_FLOATING_GROUP_POSITION","PositionCache","cache","currentFrameId","rafId","getPosition","cached","frameId","scheduleFrameUpdate","invalidate","OverlayRenderContainer","positionCache","pendingUpdates","updateAllPositions","createFocusableElement","focusContainer","box2","visibilityChanged","observerDisposable","correctLayerPosition","floatingGroup","floatingGroups","level","getAttribute","MutationObserver","attributeFilter","attributes","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","step","rejected","done","then","apply","SuppressedError","PopoutWindow","_window","_onWillClose","onWillClose","_onDidClose","onDidClose","dimensions","screenX","screenY","innerWidth","innerHeight","open","url","features","entries","join","externalWindow","createPopoutWindowContainer","onDidOpen","externalDocument","styleSheetList","styleSheets","href","link","rel","cssTexts","cssRules","rule","err","addStyles","StrictEventsSequencing","PopupService","_active","_activeDisposable","anchorBox","offsetX","offsetY","HTMLElement","buffer","rootRect","translateX","translateY","shiftAbsoluteElementIntoView","DropTargetAnchorContainer","exists","_outline","anchor","createAnchor","targetBox","DEFAULT_ROOT_OVERLAY_MODEL","moveGroupWithoutDestroying","removedPanel","DockviewComponent","flatMap","_options","_floatingGroups","popoutRestorationPromise","_popoutRestorationPromise","nextGroupId","_deserializer","_watermark","_onWillDragPanel","_onWillDragGroup","_onDidPopoutGroupSizeChange","_onDidPopoutGroupPositionChange","_onDidOpenPopoutWindowFail","_onDidLayoutFromJSON","_onDidMovePanel","_onDidMaximizedGroupChange","_popoutGroups","_onDidRemoveGroup","_onDidAddGroup","_onDidOptionsChange","_moving","_themeClassnames","_rootDropTarget","updateDropTargetModel","updateTheme","updateWatermark","orthogonalize","itemToPopout","toClassList","list","cls","startsWith","getDockviewTheme","overridePopoutGroup","getNextGroupId","popoutWindowDisposable","popoutContainer","referenceLocation","isGroupAddedToDom","createGroup","error","movingLock","gready","floatingBox","returnedGroup","doSetGroupAndPanelActive","isValidReferenceGroup","popoutGroup","_onDidWindowPositionChange","emitter","timeout","previousScreenX","previousScreenY","checkMovement","closed","currentScreenX","currentScreenY","onDidWindowMoveEnd","resizeTimeout","onDidWindowResizeEnd","skipPopoutAssociated","skipPopoutReturn","catch","popoutReferenceGroupId","popoutReferenceGroup","skipRemoveGroup","anchoredBox","getAnchoredBox","minimumWidthWithinViewport","minimumHeightWithinViewport","querySelector","floatingGroupPanel","skipActiveGroup","createGroupAtLocation","oldDisableDnd","floating","includePanel","collection","floats","popoutGroups","gridReferenceGroup","grid","isArray","createGroupFromSerializedState","createdPanels","serializedFloatingGroups","serializedFloatingGroup","serializedPopoutGroups","popoutPromises","serializedPopoutGroup","popoutPromise","all","hasActiveGroup","initial","initialWidth","initialHeight","findGroup","createPanel","inactive","floatingGroupOptions","relativeLocation","orientationAtLocation","coordinates","watermarkContainer","selectedGroup","refGroup","removedGroup","re","isMoving","destinationGroup","sourceGroupId","sourceItemId","destinationTarget","destinationIndex","sourceGroup","targetLocation","targetParentLocation","sourceLocation","sourceParentLocation","newGroup","targetGroup","updatedReferenceLocation","dropLocation","isDestinationGroupEmpty","moveGroup","selectedFloatingGroup","selectedPopoutGroup","targetFloatingGroup","GridviewComponent","_onDidLayoutfromJSON","hasOrientationChanged","_key","serializedGridview","queue","registerPanel","f","reference","groupItem","SplitviewComponent","_splitview","_splitviewChangeDisposable","_onDidLayoutChange","skipFocus","doAddView","serializedSplitview","DefaultHeader","_expandedIcon","_collapsedIcon","apiRef","_expander","updateIcon","MAXIMUM_BODY_SIZE","PaneFramework","PaneviewComponent","paneview","_paneview","_viewDisposables","createHeaderComponent","serializedPaneview","SplitviewPanel","_minimumSize","_evaluatedMinimumSize","_maximumSize","_evaluatedMaximumSize","createDockview","createSplitview","createGridview","createPaneview"],"mappings":"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","x_google_ignoreList":[2,56]}