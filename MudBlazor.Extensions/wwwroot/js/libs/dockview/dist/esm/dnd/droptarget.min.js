/**
 * Minified by jsDelivr using Terser v5.39.0.
 * Original file: /npm/dockview-core@4.7.1/dist/esm/dnd/droptarget.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{toggleClass}from"../dom";import{DockviewEvent,Emitter}from"../events";import{CompositeDisposable}from"../lifecycle";import{DragAndDropObserver}from"./dnd";import{clamp}from"../math";function setGPUOptimizedBounds(t,e){const{top:o,left:r,width:i,height:s}=e,l=`${Math.round(o)}px`,n=`${Math.round(r)}px`,a=`${Math.round(i)}px`,d=`${Math.round(s)}px`;t.style.top=l,t.style.left=n,t.style.width=a,t.style.height=d,t.style.visibility="visible",t.style.transform&&""!==t.style.transform||(t.style.transform="translate3d(0, 0, 0)")}function setGPUOptimizedBoundsFromStrings(t,e){const{top:o,left:r,width:i,height:s}=e;t.style.top=o,t.style.left=r,t.style.width=i,t.style.height=s,t.style.visibility="visible",t.style.transform&&""!==t.style.transform||(t.style.transform="translate3d(0, 0, 0)")}function checkBoundsChanged(t,e){const{top:o,left:r,width:i,height:s}=e,l=`${Math.round(o)}px`,n=`${Math.round(r)}px`,a=`${Math.round(i)}px`,d=`${Math.round(s)}px`;return t.style.top!==l||t.style.left!==n||t.style.width!==a||t.style.height!==d}export class WillShowOverlayEvent extends DockviewEvent{get nativeEvent(){return this.options.nativeEvent}get position(){return this.options.position}constructor(t){super(),this.options=t}}export function directionToPosition(t){switch(t){case"above":return"top";case"below":return"bottom";case"left":return"left";case"right":return"right";case"within":return"center";default:throw new Error(`invalid direction '${t}'`)}}export function positionToDirection(t){switch(t){case"top":return"above";case"bottom":return"below";case"left":return"left";case"right":return"right";case"center":return"within";default:throw new Error(`invalid position '${t}'`)}}const DEFAULT_ACTIVATION_SIZE={value:20,type:"percentage"},DEFAULT_SIZE={value:50,type:"percentage"},SMALL_WIDTH_BOUNDARY=100,SMALL_HEIGHT_BOUNDARY=100;export class Droptarget extends CompositeDisposable{get disabled(){return this._disabled}set disabled(t){this._disabled=t}get state(){return this._state}constructor(t,e){super(),this.element=t,this.options=e,this._onDrop=new Emitter,this.onDrop=this._onDrop.event,this._onWillShowOverlay=new Emitter,this.onWillShowOverlay=this._onWillShowOverlay.event,this._disabled=!1,this._acceptedTargetZonesSet=new Set(this.options.acceptedTargetZones),this.dnd=new DragAndDropObserver(this.element,{onDragEnter:()=>{var t,e,o;null===(o=null===(e=(t=this.options).getOverrideTarget)||void 0===e?void 0:e.call(t))||void 0===o||o.getElements()},onDragOver:t=>{var e,o,r,i,s,l,n;Droptarget.ACTUAL_TARGET=this;const a=null===(o=(e=this.options).getOverrideTarget)||void 0===o?void 0:o.call(e);if(0===this._acceptedTargetZonesSet.size){if(a)return;return void this.removeDropTarget()}const d=null!==(s=null===(i=(r=this.options).getOverlayOutline)||void 0===i?void 0:i.call(r))&&void 0!==s?s:this.element,h=d.offsetWidth,p=d.offsetHeight;if(0===h||0===p)return;const g=t.currentTarget.getBoundingClientRect(),v=(null!==(l=t.clientX)&&void 0!==l?l:0)-g.left,c=(null!==(n=t.clientY)&&void 0!==n?n:0)-g.top,u=this.calculateQuadrant(this._acceptedTargetZonesSet,v,c,h,p);if(this.isAlreadyUsed(t)||null===u)return void this.removeDropTarget();if(!this.options.canDisplayOverlay(t,u)){if(a)return;return void this.removeDropTarget()}const m=new WillShowOverlayEvent({nativeEvent:t,position:u});this._onWillShowOverlay.fire(m),m.defaultPrevented?this.removeDropTarget():(this.markAsUsed(t),a||this.targetElement||(this.targetElement=document.createElement("div"),this.targetElement.className="dv-drop-target-dropzone",this.overlayElement=document.createElement("div"),this.overlayElement.className="dv-drop-target-selection",this._state="center",this.targetElement.appendChild(this.overlayElement),d.classList.add("dv-drop-target"),d.append(this.targetElement)),this.toggleClasses(u,h,p),this._state=u)},onDragLeave:()=>{var t,e;(null===(e=(t=this.options).getOverrideTarget)||void 0===e?void 0:e.call(t))||this.removeDropTarget()},onDragEnd:t=>{var e,o;const r=null===(o=(e=this.options).getOverrideTarget)||void 0===o?void 0:o.call(e);r&&Droptarget.ACTUAL_TARGET===this&&this._state&&(t.stopPropagation(),this._onDrop.fire({position:this._state,nativeEvent:t})),this.removeDropTarget(),null==r||r.clear()},onDrop:t=>{var e,o,r;t.preventDefault();const i=this._state;this.removeDropTarget(),null===(r=null===(o=(e=this.options).getOverrideTarget)||void 0===o?void 0:o.call(e))||void 0===r||r.clear(),i&&(t.stopPropagation(),this._onDrop.fire({position:i,nativeEvent:t}))}}),this.addDisposables(this._onDrop,this._onWillShowOverlay,this.dnd)}setTargetZones(t){this._acceptedTargetZonesSet=new Set(t)}setOverlayModel(t){this.options.overlayModel=t}dispose(){this.removeDropTarget(),super.dispose()}markAsUsed(t){t[Droptarget.USED_EVENT_ID]=!0}isAlreadyUsed(t){const e=t[Droptarget.USED_EVENT_ID];return"boolean"==typeof e&&e}toggleClasses(t,e,o){var r,i,s,l,n,a,d;const h=null===(i=(r=this.options).getOverrideTarget)||void 0===i?void 0:i.call(r);if(!h&&!this.overlayElement)return;const p=e<100,g=o<100,v="left"===t,c="right"===t,u="top"===t,m="bottom"===t,f=!p&&c,E=!p&&v,y=!g&&u,D=!g&&m;let _=1;const T=null!==(l=null===(s=this.options.overlayModel)||void 0===s?void 0:s.size)&&void 0!==l?l:DEFAULT_SIZE;if("percentage"===T.type?_=clamp(T.value,0,100)/100:((f||E)&&(_=clamp(0,T.value,e)/e),(y||D)&&(_=clamp(0,T.value,o)/o)),h){const r=null!==(d=null===(a=(n=this.options).getOverlayOutline)||void 0===a?void 0:a.call(n))&&void 0!==d?d:this.element,i=r.getBoundingClientRect(),s=h.getElements(void 0,r),l=s.root,g=s.overlay,T=l.getBoundingClientRect(),w=i.top-T.top,O=i.left-T.left,C={top:w,left:O,width:e,height:o};if(f?(C.left=O+e*(1-_),C.width=e*_):E?C.width=e*_:y?C.height=o*_:D&&(C.top=w+o*(1-_),C.height=o*_),p&&v&&(C.width=4),p&&c&&(C.left=O+e-4,C.width=4),!checkBoundsChanged(g,C))return;return setGPUOptimizedBounds(g,C),g.className="dv-drop-target-anchor"+(this.options.className?` ${this.options.className}`:""),toggleClass(g,"dv-drop-target-left",v),toggleClass(g,"dv-drop-target-right",c),toggleClass(g,"dv-drop-target-top",u),toggleClass(g,"dv-drop-target-bottom",m),toggleClass(g,"dv-drop-target-center","center"===t),void(s.changed&&(toggleClass(g,"dv-drop-target-anchor-container-changed",!0),setTimeout((()=>{toggleClass(g,"dv-drop-target-anchor-container-changed",!1)}),10)))}if(!this.overlayElement)return;const w={top:"0px",left:"0px",width:"100%",height:"100%"};f?(w.left=100*(1-_)+"%",w.width=100*_+"%"):E?w.width=100*_+"%":y?w.height=100*_+"%":D&&(w.top=100*(1-_)+"%",w.height=100*_+"%"),setGPUOptimizedBoundsFromStrings(this.overlayElement,w),toggleClass(this.overlayElement,"dv-drop-target-small-vertical",g),toggleClass(this.overlayElement,"dv-drop-target-small-horizontal",p),toggleClass(this.overlayElement,"dv-drop-target-left",v),toggleClass(this.overlayElement,"dv-drop-target-right",c),toggleClass(this.overlayElement,"dv-drop-target-top",u),toggleClass(this.overlayElement,"dv-drop-target-bottom",m),toggleClass(this.overlayElement,"dv-drop-target-center","center"===t)}calculateQuadrant(t,e,o,r,i){var s,l;const n=null!==(l=null===(s=this.options.overlayModel)||void 0===s?void 0:s.activationSize)&&void 0!==l?l:DEFAULT_ACTIVATION_SIZE;return"percentage"===n.type?calculateQuadrantAsPercentage(t,e,o,r,i,n.value):calculateQuadrantAsPixels(t,e,o,r,i,n.value)}removeDropTarget(){var t;this.targetElement&&(this._state=void 0,null===(t=this.targetElement.parentElement)||void 0===t||t.classList.remove("dv-drop-target"),this.targetElement.remove(),this.targetElement=void 0,this.overlayElement=void 0)}}Droptarget.USED_EVENT_ID="__dockview_droptarget_event_is_used__";export function calculateQuadrantAsPercentage(t,e,o,r,i,s){const l=100*e/r,n=100*o/i;return t.has("left")&&l<s?"left":t.has("right")&&l>100-s?"right":t.has("top")&&n<s?"top":t.has("bottom")&&n>100-s?"bottom":t.has("center")?"center":null}export function calculateQuadrantAsPixels(t,e,o,r,i,s){return t.has("left")&&e<s?"left":t.has("right")&&e>r-s?"right":t.has("top")&&o<s?"top":t.has("bottom")&&o>i-s?"bottom":t.has("center")?"center":null}
//# sourceMappingURL=/sm/02592638f3128a7e26729c8728be44afb768472665493349a76d26993bc8d035.map