/**
 * Minified by jsDelivr using Terser v5.39.0.
 * Original file: /npm/dockview-core@4.7.1/dist/esm/splitview/splitview.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{removeClasses,addClasses,toggleClass,disableIframePointEvents}from"../dom";import{Emitter}from"../events";import{pushToStart,pushToEnd,firstIndex}from"../array";import{range,clamp}from"../math";import{ViewItem}from"./viewItem";export var Orientation;!function(e){e.HORIZONTAL="HORIZONTAL",e.VERTICAL="VERTICAL"}(Orientation||(Orientation={}));export var SashState;!function(e){e[e.MAXIMUM=0]="MAXIMUM",e[e.MINIMUM=1]="MINIMUM",e[e.DISABLED=2]="DISABLED",e[e.ENABLED=3]="ENABLED"}(SashState||(SashState={}));export var LayoutPriority;!function(e){e.Low="low",e.High="high",e.Normal="normal"}(LayoutPriority||(LayoutPriority={}));export var Sizing;!function(e){e.Distribute={type:"distribute"},e.Split=function(e){return{type:"split",index:e}},e.Invisible=function(e){return{type:"invisible",cachedVisibleSize:e}}}(Sizing||(Sizing={}));export class Splitview{get contentSize(){return this._contentSize}get size(){return this._size}set size(e){this._size=e}get orthogonalSize(){return this._orthogonalSize}set orthogonalSize(e){this._orthogonalSize=e}get length(){return this.viewItems.length}get proportions(){return this._proportions?[...this._proportions]:void 0}get orientation(){return this._orientation}set orientation(e){this._orientation=e;const i=this.size;this.size=this.orthogonalSize,this.orthogonalSize=i,removeClasses(this.element,"dv-horizontal","dv-vertical"),this.element.classList.add(this.orientation==Orientation.HORIZONTAL?"dv-horizontal":"dv-vertical")}get minimumSize(){return this.viewItems.reduce(((e,i)=>e+i.minimumSize),0)}get maximumSize(){return 0===this.length?Number.POSITIVE_INFINITY:this.viewItems.reduce(((e,i)=>e+i.maximumSize),0)}get startSnappingEnabled(){return this._startSnappingEnabled}set startSnappingEnabled(e){this._startSnappingEnabled!==e&&(this._startSnappingEnabled=e,this.updateSashEnablement())}get endSnappingEnabled(){return this._endSnappingEnabled}set endSnappingEnabled(e){this._endSnappingEnabled!==e&&(this._endSnappingEnabled=e,this.updateSashEnablement())}get disabled(){return this._disabled}set disabled(e){this._disabled=e,toggleClass(this.element,"dv-splitview-disabled",e)}get margin(){return this._margin}set margin(e){this._margin=e,toggleClass(this.element,"dv-splitview-has-margin",0!==e)}constructor(e,i){var t,s;this.container=e,this.viewItems=[],this.sashes=[],this._size=0,this._orthogonalSize=0,this._contentSize=0,this._proportions=void 0,this._startSnappingEnabled=!0,this._endSnappingEnabled=!0,this._disabled=!1,this._margin=0,this._onDidSashEnd=new Emitter,this.onDidSashEnd=this._onDidSashEnd.event,this._onDidAddView=new Emitter,this.onDidAddView=this._onDidAddView.event,this._onDidRemoveView=new Emitter,this.onDidRemoveView=this._onDidRemoveView.event,this.resize=(e,i,t=this.viewItems.map((e=>e.size)),s,n,o=Number.NEGATIVE_INFINITY,r=Number.POSITIVE_INFINITY,a,h)=>{if(e<0||e>this.viewItems.length)return 0;const m=range(e,-1),l=range(e+1,this.viewItems.length);if(n)for(const e of n)pushToStart(m,e),pushToStart(l,e);if(s)for(const e of s)pushToEnd(m,e),pushToEnd(l,e);const d=m.map((e=>this.viewItems[e])),v=m.map((e=>t[e])),p=l.map((e=>this.viewItems[e])),u=l.map((e=>t[e])),c=m.reduce(((e,i)=>e+this.viewItems[i].minimumSize-t[i]),0),w=m.reduce(((e,i)=>e+this.viewItems[i].maximumSize-t[i]),0),I=0===l.length?Number.POSITIVE_INFINITY:l.reduce(((e,i)=>e+t[i]-this.viewItems[i].minimumSize),0),S=0===l.length?Number.NEGATIVE_INFINITY:l.reduce(((e,i)=>e+t[i]-this.viewItems[i].maximumSize),0),g=Math.max(c,S),z=Math.min(I,w);let f=!1;if(a){const e=this.viewItems[a.index],t=i>=a.limitDelta;f=t!==e.visible,e.setVisible(t,a.size)}if(!f&&h){const e=this.viewItems[h.index],t=i<h.limitDelta;f=t!==e.visible,e.setVisible(t,h.size)}if(f)return this.resize(e,i,t,s,n,o,r);let b=0,y=clamp(i,g,z);for(let e=0;e<d.length;e++){const i=d[e],t=clamp(v[e]+y,i.minimumSize,i.maximumSize),s=t-v[e];b+=s,y-=s,i.size=t}let E=b;for(let e=0;e<p.length;e++){const i=p[e],t=clamp(u[e]-E,i.minimumSize,i.maximumSize);E+=t-u[e],i.size=t}return i},this._orientation=null!==(t=i.orientation)&&void 0!==t?t:Orientation.VERTICAL,this.element=this.createContainer(),this.margin=null!==(s=i.margin)&&void 0!==s?s:0,this.proportionalLayout=void 0===i.proportionalLayout||!!i.proportionalLayout,this.viewContainer=this.createViewContainer(),this.sashContainer=this.createSashContainer(),this.element.appendChild(this.sashContainer),this.element.appendChild(this.viewContainer),this.container.appendChild(this.element),this.style(i.styles),i.descriptor&&(this._size=i.descriptor.size,i.descriptor.views.forEach(((e,i)=>{const t=void 0===e.visible||e.visible?e.size:{type:"invisible",cachedVisibleSize:e.size},s=e.view;this.addView(s,t,i,!0)})),this._contentSize=this.viewItems.reduce(((e,i)=>e+i.size),0),this.saveProportions())}style(e){"transparent"===(null==e?void 0:e.separatorBorder)?(removeClasses(this.element,"dv-separator-border"),this.element.style.removeProperty("--dv-separator-border")):(addClasses(this.element,"dv-separator-border"),(null==e?void 0:e.separatorBorder)&&this.element.style.setProperty("--dv-separator-border",e.separatorBorder))}isViewVisible(e){if(e<0||e>=this.viewItems.length)throw new Error("Index out of bounds");return this.viewItems[e].visible}setViewVisible(e,i){if(e<0||e>=this.viewItems.length)throw new Error("Index out of bounds");const t=this.viewItems[e];t.setVisible(i,t.size),this.distributeEmptySpace(e),this.layoutViews(),this.saveProportions()}getViewSize(e){return e<0||e>=this.viewItems.length?-1:this.viewItems[e].size}resizeView(e,i){if(e<0||e>=this.viewItems.length)return;const t=range(this.viewItems.length).filter((i=>i!==e)),s=[...t.filter((e=>this.viewItems[e].priority===LayoutPriority.Low)),e],n=t.filter((e=>this.viewItems[e].priority===LayoutPriority.High)),o=this.viewItems[e];i=Math.round(i),i=clamp(i,o.minimumSize,Math.min(o.maximumSize,this._size)),o.size=i,this.relayout(s,n)}getViews(){return this.viewItems.map((e=>e.view))}onDidChange(e,i){const t=this.viewItems.indexOf(e);if(t<0||t>=this.viewItems.length)return;i="number"==typeof i?i:e.size,i=clamp(i,e.minimumSize,e.maximumSize),e.size=i;const s=range(this.viewItems.length).filter((e=>e!==t)),n=[...s.filter((e=>this.viewItems[e].priority===LayoutPriority.Low)),t],o=s.filter((e=>this.viewItems[e].priority===LayoutPriority.High));this.relayout([...n,t],o)}addView(e,i={type:"distribute"},t=this.viewItems.length,s){const n=document.createElement("div");let o;n.className="dv-view",n.appendChild(e.element),o="number"==typeof i?i:"split"===i.type?this.getViewSize(i.index)/2:"invisible"===i.type?{cachedVisibleSize:i.cachedVisibleSize}:e.minimumSize;const r=e.onDidChange((e=>this.onDidChange(a,e.size))),a=new ViewItem(n,e,o,{dispose:()=>{r.dispose(),this.viewContainer.removeChild(n)}});if(t===this.viewItems.length?this.viewContainer.appendChild(n):this.viewContainer.insertBefore(n,this.viewContainer.children.item(t)),this.viewItems.splice(t,0,a),this.viewItems.length>1){const e=document.createElement("div");e.className="dv-sash";const i=i=>{for(const e of this.viewItems)e.enabled=!1;const t=disableIframePointEvents(),s=this._orientation===Orientation.HORIZONTAL?i.clientX:i.clientY,n=firstIndex(this.sashes,(i=>i.container===e)),o=this.viewItems.map((e=>e.size));let r,a;const h=range(n,-1),m=range(n+1,this.viewItems.length),l=h.reduce(((e,i)=>e+(this.viewItems[i].minimumSize-o[i])),0),d=h.reduce(((e,i)=>e+(this.viewItems[i].viewMaximumSize-o[i])),0),v=0===m.length?Number.POSITIVE_INFINITY:m.reduce(((e,i)=>e+(o[i]-this.viewItems[i].minimumSize)),0),p=0===m.length?Number.NEGATIVE_INFINITY:m.reduce(((e,i)=>e+(o[i]-this.viewItems[i].viewMaximumSize)),0),u=Math.max(l,p),c=Math.min(v,d),w=this.findFirstSnapIndex(h),I=this.findFirstSnapIndex(m);if("number"==typeof w){const e=this.viewItems[w],i=Math.floor(e.viewMinimumSize/2);r={index:w,limitDelta:e.visible?u-i:u+i,size:e.size}}if("number"==typeof I){const e=this.viewItems[I],i=Math.floor(e.viewMinimumSize/2);a={index:I,limitDelta:e.visible?c+i:c-i,size:e.size}}const S=e=>{const i=(this._orientation===Orientation.HORIZONTAL?e.clientX:e.clientY)-s;this.resize(n,i,o,void 0,void 0,u,c,r,a),this.distributeEmptySpace(),this.layoutViews()},g=()=>{for(const e of this.viewItems)e.enabled=!0;t.release(),this.saveProportions(),document.removeEventListener("pointermove",S),document.removeEventListener("pointerup",g),document.removeEventListener("pointercancel",g),this._onDidSashEnd.fire(void 0)};document.addEventListener("pointermove",S),document.addEventListener("pointerup",g),document.addEventListener("pointercancel",g)};e.addEventListener("pointerdown",i);const t={container:e,disposable:()=>{e.removeEventListener("pointerdown",i),this.sashContainer.removeChild(e)}};this.sashContainer.appendChild(e),this.sashes.push(t)}s||this.relayout([t]),s||"number"==typeof i||"distribute"!==i.type||this.distributeViewSizes(),this._onDidAddView.fire(e)}distributeViewSizes(){const e=[];let i=0;for(const t of this.viewItems)t.maximumSize-t.minimumSize>0&&(e.push(t),i+=t.size);const t=Math.floor(i/e.length);for(const i of e)i.size=clamp(t,i.minimumSize,i.maximumSize);const s=range(this.viewItems.length),n=s.filter((e=>this.viewItems[e].priority===LayoutPriority.Low)),o=s.filter((e=>this.viewItems[e].priority===LayoutPriority.High));this.relayout(n,o)}removeView(e,i,t=!1){const s=this.viewItems.splice(e,1)[0];if(s.dispose(),this.viewItems.length>=1){const i=Math.max(e-1,0);this.sashes.splice(i,1)[0].disposable()}return t||this.relayout(),i&&"distribute"===i.type&&this.distributeViewSizes(),this._onDidRemoveView.fire(s.view),s.view}getViewCachedVisibleSize(e){if(e<0||e>=this.viewItems.length)throw new Error("Index out of bounds");return this.viewItems[e].cachedVisibleSize}moveView(e,i){const t=this.getViewCachedVisibleSize(e),s=void 0===t?this.getViewSize(e):Sizing.Invisible(t),n=this.removeView(e,void 0,!0);this.addView(n,s,i)}layout(e,i){const t=Math.max(this.size,this._contentSize);if(this.size=e,this.orthogonalSize=i,this.proportions){let i=0;for(let t=0;t<this.viewItems.length;t++){const s=this.viewItems[t],n=this.proportions[t];"number"==typeof n?i+=n:e-=s.size}for(let t=0;t<this.viewItems.length;t++){const s=this.viewItems[t],n=this.proportions[t];"number"==typeof n&&i>0&&(s.size=clamp(Math.round(n*e/i),s.minimumSize,s.maximumSize))}}else{const i=range(this.viewItems.length),s=i.filter((e=>this.viewItems[e].priority===LayoutPriority.Low)),n=i.filter((e=>this.viewItems[e].priority===LayoutPriority.High));this.resize(this.viewItems.length-1,e-t,void 0,s,n)}this.distributeEmptySpace(),this.layoutViews()}relayout(e,i){const t=this.viewItems.reduce(((e,i)=>e+i.size),0);this.resize(this.viewItems.length-1,this._size-t,void 0,e,i),this.distributeEmptySpace(),this.layoutViews(),this.saveProportions()}distributeEmptySpace(e){const i=this.viewItems.reduce(((e,i)=>e+i.size),0);let t=this.size-i;const s=range(this.viewItems.length-1,-1),n=s.filter((e=>this.viewItems[e].priority===LayoutPriority.Low)),o=s.filter((e=>this.viewItems[e].priority===LayoutPriority.High));for(const e of o)pushToStart(s,e);for(const e of n)pushToEnd(s,e);"number"==typeof e&&pushToEnd(s,e);for(let e=0;0!==t&&e<s.length;e++){const i=this.viewItems[s[e]],n=clamp(i.size+t,i.minimumSize,i.maximumSize);t-=n-i.size,i.size=n}}saveProportions(){this.proportionalLayout&&this._contentSize>0&&(this._proportions=this.viewItems.map((e=>e.visible?e.size/this._contentSize:void 0)))}layoutViews(){if(this._contentSize=this.viewItems.reduce(((e,i)=>e+i.size),0),this.updateSashEnablement(),0===this.viewItems.length)return;const e=this.viewItems.filter((e=>e.visible)),i=Math.max(0,e.length-1),t=this.margin*i/Math.max(1,e.length);let s=0;const n=[],o=this.viewItems.reduce(((e,i,t)=>{const s=i.visible?1:0;return 0===t?e.push(s):e.push(e[t-1]+s),e}),[]);this.viewItems.forEach(((e,r)=>{s+=this.viewItems[r].size,n.push(s);const a=e.visible?e.size-t:0,h=Math.max(0,o[r]-1),m=0===r||0===h?0:n[r-1]+h/i*t;if(r<this.viewItems.length-1){const i=e.visible?m+a-2+this.margin/2:m;this._orientation===Orientation.HORIZONTAL&&(this.sashes[r].container.style.left=`${i}px`,this.sashes[r].container.style.top="0px"),this._orientation===Orientation.VERTICAL&&(this.sashes[r].container.style.left="0px",this.sashes[r].container.style.top=`${i}px`)}this._orientation===Orientation.HORIZONTAL&&(e.container.style.width=`${a}px`,e.container.style.left=`${m}px`,e.container.style.top="",e.container.style.height=""),this._orientation===Orientation.VERTICAL&&(e.container.style.height=`${a}px`,e.container.style.top=`${m}px`,e.container.style.width="",e.container.style.left=""),e.view.layout(e.size-t,this._orthogonalSize)}))}findFirstSnapIndex(e){for(const i of e){const e=this.viewItems[i];if(e.visible&&e.snap)return i}for(const i of e){const e=this.viewItems[i];if(e.visible&&e.maximumSize-e.minimumSize>0)return;if(!e.visible&&e.snap)return i}}updateSashEnablement(){let e=!1;const i=this.viewItems.map((i=>e=i.size-i.minimumSize>0||e));e=!1;const t=this.viewItems.map((i=>e=i.maximumSize-i.size>0||e)),s=[...this.viewItems].reverse();e=!1;const n=s.map((i=>e=i.size-i.minimumSize>0||e)).reverse();e=!1;const o=s.map((i=>e=i.maximumSize-i.size>0||e)).reverse();let r=0;for(let e=0;e<this.sashes.length;e++){const s=this.sashes[e];r+=this.viewItems[e].size;const a=!(i[e]&&o[e+1]),h=!(t[e]&&n[e+1]);if(a&&h){const t=range(e,-1),o=range(e+1,this.viewItems.length),a=this.findFirstSnapIndex(t),h=this.findFirstSnapIndex(o),m="number"==typeof a&&!this.viewItems[a].visible,l="number"==typeof h&&!this.viewItems[h].visible;m&&n[e]&&(r>0||this.startSnappingEnabled)?this.updateSash(s,SashState.MINIMUM):l&&i[e]&&(r<this._contentSize||this.endSnappingEnabled)?this.updateSash(s,SashState.MAXIMUM):this.updateSash(s,SashState.DISABLED)}else a&&!h?this.updateSash(s,SashState.MINIMUM):!a&&h?this.updateSash(s,SashState.MAXIMUM):this.updateSash(s,SashState.ENABLED)}}updateSash(e,i){toggleClass(e.container,"dv-disabled",i===SashState.DISABLED),toggleClass(e.container,"dv-enabled",i===SashState.ENABLED),toggleClass(e.container,"dv-maximum",i===SashState.MAXIMUM),toggleClass(e.container,"dv-minimum",i===SashState.MINIMUM)}createViewContainer(){const e=document.createElement("div");return e.className="dv-view-container",e}createSashContainer(){const e=document.createElement("div");return e.className="dv-sash-container",e}createContainer(){const e=document.createElement("div"),i=this._orientation===Orientation.HORIZONTAL?"dv-horizontal":"dv-vertical";return e.className=`dv-split-view-container ${i}`,e}dispose(){this._onDidSashEnd.dispose(),this._onDidAddView.dispose(),this._onDidRemoveView.dispose();for(let e=0;e<this.element.children.length;e++)if(this.element.children.item(e)===this.element){this.element.removeChild(this.element);break}for(const e of this.viewItems)e.dispose();this.element.remove()}}
//# sourceMappingURL=/sm/5c6e8624067edad45b8fa914c7c16d05fcf176beaf2a08ecdf9c8554801c381c.map