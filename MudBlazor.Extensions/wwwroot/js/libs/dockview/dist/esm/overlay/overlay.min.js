/**
 * Minified by jsDelivr using Terser v5.39.0.
 * Original file: /npm/dockview-core@4.7.1/dist/esm/overlay/overlay.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{disableIframePointEvents,quasiDefaultPrevented,toggleClass}from"../dom";import{Emitter,addDisposableListener}from"../events";import{CompositeDisposable,MutableDisposable}from"../lifecycle";import{clamp}from"../math";class AriaLevelTracker{constructor(){this._orderedList=[]}push(t){this._orderedList=[...this._orderedList.filter((e=>e!==t)),t],this.update()}destroy(t){this._orderedList=this._orderedList.filter((e=>e!==t)),this.update()}update(){for(let t=0;t<this._orderedList.length;t++)this._orderedList[t].setAttribute("aria-level",`${t}`),this._orderedList[t].style.zIndex=`calc(var(--dv-overlay-z-index, 999) + ${2*t})`}}const arialLevelTracker=new AriaLevelTracker;export class Overlay extends CompositeDisposable{set minimumInViewportWidth(t){this.options.minimumInViewportWidth=t}set minimumInViewportHeight(t){this.options.minimumInViewportHeight=t}get element(){return this._element}get isVisible(){return this._isVisible}constructor(t){super(),this.options=t,this._element=document.createElement("div"),this._onDidChange=new Emitter,this.onDidChange=this._onDidChange.event,this._onDidChangeEnd=new Emitter,this.onDidChangeEnd=this._onDidChangeEnd.event,this.addDisposables(this._onDidChange,this._onDidChangeEnd),this._element.className="dv-resize-container",this._isVisible=!0,this.setupResize("top"),this.setupResize("bottom"),this.setupResize("left"),this.setupResize("right"),this.setupResize("topleft"),this.setupResize("topright"),this.setupResize("bottomleft"),this.setupResize("bottomright"),this._element.appendChild(this.options.content),this.options.container.appendChild(this._element),this.setBounds(Object.assign(Object.assign(Object.assign(Object.assign({height:this.options.height,width:this.options.width},"top"in this.options&&{top:this.options.top}),"bottom"in this.options&&{bottom:this.options.bottom}),"left"in this.options&&{left:this.options.left}),"right"in this.options&&{right:this.options.right})),arialLevelTracker.push(this._element)}setVisible(t){t!==this.isVisible&&(this._isVisible=t,toggleClass(this.element,"dv-hidden",!this.isVisible))}bringToFront(){arialLevelTracker.push(this._element)}setBounds(t={}){"number"==typeof t.height&&(this._element.style.height=`${t.height}px`),"number"==typeof t.width&&(this._element.style.width=`${t.width}px`),"top"in t&&"number"==typeof t.top&&(this._element.style.top=`${t.top}px`,this._element.style.bottom="auto",this.verticalAlignment="top"),"bottom"in t&&"number"==typeof t.bottom&&(this._element.style.bottom=`${t.bottom}px`,this._element.style.top="auto",this.verticalAlignment="bottom"),"left"in t&&"number"==typeof t.left&&(this._element.style.left=`${t.left}px`,this._element.style.right="auto",this.horiziontalAlignment="left"),"right"in t&&"number"==typeof t.right&&(this._element.style.right=`${t.right}px`,this._element.style.left="auto",this.horiziontalAlignment="right");const e=this.options.container.getBoundingClientRect(),i=this._element.getBoundingClientRect(),s=Math.max(0,this.getMinimumWidth(i.width)),n=Math.max(0,this.getMinimumHeight(i.height));if("top"===this.verticalAlignment){const t=clamp(i.top-e.top,-n,Math.max(0,e.height-i.height+n));this._element.style.top=`${t}px`,this._element.style.bottom="auto"}if("bottom"===this.verticalAlignment){const t=clamp(e.bottom-i.bottom,-n,Math.max(0,e.height-i.height+n));this._element.style.bottom=`${t}px`,this._element.style.top="auto"}if("left"===this.horiziontalAlignment){const t=clamp(i.left-e.left,-s,Math.max(0,e.width-i.width+s));this._element.style.left=`${t}px`,this._element.style.right="auto"}if("right"===this.horiziontalAlignment){const t=clamp(e.right-i.right,-s,Math.max(0,e.width-i.width+s));this._element.style.right=`${t}px`,this._element.style.left="auto"}this._onDidChange.fire()}toJSON(){const t=this.options.container.getBoundingClientRect(),e=this._element.getBoundingClientRect(),i={};return"top"===this.verticalAlignment?i.top=parseFloat(this._element.style.top):"bottom"===this.verticalAlignment?i.bottom=parseFloat(this._element.style.bottom):i.top=e.top-t.top,"left"===this.horiziontalAlignment?i.left=parseFloat(this._element.style.left):"right"===this.horiziontalAlignment?i.right=parseFloat(this._element.style.right):i.left=e.left-t.left,i.width=e.width,i.height=e.height,i}setupDrag(t,e={inDragMode:!1}){const i=new MutableDisposable,s=()=>{let t=null;const e=disableIframePointEvents();i.value=new CompositeDisposable({dispose:()=>{e.release()}},addDisposableListener(window,"pointermove",(e=>{const i=this.options.container.getBoundingClientRect(),s=e.clientX-i.left,n=e.clientY-i.top;toggleClass(this._element,"dv-resize-container-dragging",!0);const o=this._element.getBoundingClientRect();null===t&&(t={x:e.clientX-o.left,y:e.clientY-o.top});const h=Math.max(0,this.getMinimumWidth(o.width)),l=Math.max(0,this.getMinimumHeight(o.height)),a=clamp(n-t.y,-l,Math.max(0,i.height-o.height+l)),r=clamp(t.y-n+i.height-o.height,-l,Math.max(0,i.height-o.height+l)),m=clamp(s-t.x,-h,Math.max(0,i.width-o.width+h)),p=clamp(t.x-s+i.width-o.width,-h,Math.max(0,i.width-o.width+h)),d={};a<=r?d.top=a:d.bottom=r,m<=p?d.left=m:d.right=p,this.setBounds(d)})),addDisposableListener(window,"pointerup",(()=>{toggleClass(this._element,"dv-resize-container-dragging",!1),i.dispose(),this._onDidChangeEnd.fire()})))};this.addDisposables(i,addDisposableListener(t,"pointerdown",(t=>{t.defaultPrevented?t.preventDefault():quasiDefaultPrevented(t)||s()})),addDisposableListener(this.options.content,"pointerdown",(t=>{t.defaultPrevented||quasiDefaultPrevented(t)||t.shiftKey&&s()})),addDisposableListener(this.options.content,"pointerdown",(()=>{arialLevelTracker.push(this._element)}),!0)),e.inDragMode&&s()}setupResize(t){const e=document.createElement("div");e.className=`dv-resize-handle-${t}`,this._element.appendChild(e);const i=new MutableDisposable;this.addDisposables(i,addDisposableListener(e,"pointerdown",(e=>{e.preventDefault();let s=null;const n=disableIframePointEvents();i.value=new CompositeDisposable(addDisposableListener(window,"pointermove",(e=>{const i=this.options.container.getBoundingClientRect(),n=this._element.getBoundingClientRect(),o=e.clientY-i.top,h=e.clientX-i.left;let l,a,r,m,p,d;null===s&&(s={originalY:o,originalHeight:n.height,originalX:h,originalWidth:n.width});const g=()=>{l=clamp(o,-Number.MAX_VALUE,s.originalY+s.originalHeight>i.height?this.getMinimumHeight(i.height):Math.max(0,s.originalY+s.originalHeight-Overlay.MINIMUM_HEIGHT)),r=s.originalY+s.originalHeight-l,a=i.height-l-r},u=()=>{l=s.originalY-s.originalHeight,r=clamp(o-l,l<0&&"number"==typeof this.options.minimumInViewportHeight?-l+this.options.minimumInViewportHeight:Overlay.MINIMUM_HEIGHT,Number.MAX_VALUE),a=i.height-l-r},c=()=>{m=clamp(h,-Number.MAX_VALUE,s.originalX+s.originalWidth>i.width?this.getMinimumWidth(i.width):Math.max(0,s.originalX+s.originalWidth-Overlay.MINIMUM_WIDTH)),d=s.originalX+s.originalWidth-m,p=i.width-m-d},b=()=>{m=s.originalX-s.originalWidth,d=clamp(h-m,m<0&&"number"==typeof this.options.minimumInViewportWidth?-m+this.options.minimumInViewportWidth:Overlay.MINIMUM_WIDTH,Number.MAX_VALUE),p=i.width-m-d};switch(t){case"top":g();break;case"bottom":u();break;case"left":c();break;case"right":b();break;case"topleft":g(),c();break;case"topright":g(),b();break;case"bottomleft":u(),c();break;case"bottomright":u(),b()}const _={};l<=a?_.top=l:_.bottom=a,m<=p?_.left=m:_.right=p,_.height=r,_.width=d,this.setBounds(_)})),{dispose:()=>{n.release()}},addDisposableListener(window,"pointerup",(()=>{i.dispose(),this._onDidChangeEnd.fire()})))})))}getMinimumWidth(t){return"number"==typeof this.options.minimumInViewportWidth?t-this.options.minimumInViewportWidth:0}getMinimumHeight(t){return"number"==typeof this.options.minimumInViewportHeight?t-this.options.minimumInViewportHeight:0}dispose(){arialLevelTracker.destroy(this._element),this._element.remove(),super.dispose()}}Overlay.MINIMUM_HEIGHT=20,Overlay.MINIMUM_WIDTH=20;
//# sourceMappingURL=/sm/744ff8db27f6f17b6e10c4f6be14a9328ead3b97a3c91d73ca023a90c10225eb.map