/**
 * Minified by jsDelivr using Terser v5.39.0.
 * Original file: /npm/dockview-core@4.7.1/dist/cjs/dockview/dockviewGroupPanelModel.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";var __extends=this&&this.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),__read=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,o,r=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)a.push(i.value)}catch(e){o={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return a},__spreadArray=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var i,o=0,r=t.length;o<r;o++)!i&&o in t||(i||(i=Array.prototype.slice.call(t,0,o)),i[o]=t[o]);return e.concat(i||Array.prototype.slice.call(t))},__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(exports,"__esModule",{value:!0}),exports.DockviewGroupPanelModel=exports.DockviewWillDropEvent=exports.DockviewDidDropEvent=void 0;var component_api_1=require("../api/component.api"),dataTransfer_1=require("../dnd/dataTransfer"),dom_1=require("../dom"),events_1=require("../events"),events_2=require("./events"),lifecycle_1=require("../lifecycle"),content_1=require("./components/panel/content"),tabsContainer_1=require("./components/titlebar/tabsContainer"),options_1=require("./options"),DockviewDidDropEvent=function(e){function t(t){var n=e.call(this)||this;return n.options=t,n}return __extends(t,e),Object.defineProperty(t.prototype,"nativeEvent",{get:function(){return this.options.nativeEvent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"position",{get:function(){return this.options.position},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"panel",{get:function(){return this.options.panel},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"group",{get:function(){return this.options.group},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"api",{get:function(){return this.options.api},enumerable:!1,configurable:!0}),t.prototype.getData=function(){return this.options.getData()},t}(events_1.DockviewEvent);exports.DockviewDidDropEvent=DockviewDidDropEvent;var DockviewWillDropEvent=function(e){function t(t){var n=e.call(this,t)||this;return n._kind=t.kind,n}return __extends(t,e),Object.defineProperty(t.prototype,"kind",{get:function(){return this._kind},enumerable:!1,configurable:!0}),t}(DockviewDidDropEvent);exports.DockviewWillDropEvent=DockviewWillDropEvent;var DockviewGroupPanelModel=function(e){function t(t,n,i,o,r){var a,s=e.call(this)||this;return s.container=t,s.accessor=n,s.id=i,s.options=o,s.groupPanel=r,s._isGroupActive=!1,s._locked=!1,s._location={type:"grid"},s.mostRecentlyUsed=[],s._overwriteRenderContainer=null,s._overwriteDropTargetContainer=null,s._onDidChange=new events_1.Emitter,s.onDidChange=s._onDidChange.event,s._width=0,s._height=0,s._panels=[],s._panelDisposables=new Map,s._onMove=new events_1.Emitter,s.onMove=s._onMove.event,s._onDidDrop=new events_1.Emitter,s.onDidDrop=s._onDidDrop.event,s._onWillDrop=new events_1.Emitter,s.onWillDrop=s._onWillDrop.event,s._onWillShowOverlay=new events_1.Emitter,s.onWillShowOverlay=s._onWillShowOverlay.event,s._onTabDragStart=new events_1.Emitter,s.onTabDragStart=s._onTabDragStart.event,s._onGroupDragStart=new events_1.Emitter,s.onGroupDragStart=s._onGroupDragStart.event,s._onDidAddPanel=new events_1.Emitter,s.onDidAddPanel=s._onDidAddPanel.event,s._onDidPanelTitleChange=new events_1.Emitter,s.onDidPanelTitleChange=s._onDidPanelTitleChange.event,s._onDidPanelParametersChange=new events_1.Emitter,s.onDidPanelParametersChange=s._onDidPanelParametersChange.event,s._onDidRemovePanel=new events_1.Emitter,s.onDidRemovePanel=s._onDidRemovePanel.event,s._onDidActivePanelChange=new events_1.Emitter,s.onDidActivePanelChange=s._onDidActivePanelChange.event,s._onUnhandledDragOverEvent=new events_1.Emitter,s.onUnhandledDragOverEvent=s._onUnhandledDragOverEvent.event,(0,dom_1.toggleClass)(s.container,"dv-groupview",!0),s._api=new component_api_1.DockviewApi(s.accessor),s.tabsContainer=new tabsContainer_1.TabsContainer(s.accessor,s.groupPanel),s.contentContainer=new content_1.ContentContainer(s.accessor,s),t.append(s.tabsContainer.element,s.contentContainer.element),s.header.hidden=!!o.hideHeader,s.locked=null!==(a=o.locked)&&void 0!==a&&a,s.addDisposables(s._onTabDragStart,s._onGroupDragStart,s._onWillShowOverlay,s.tabsContainer.onTabDragStart((function(e){s._onTabDragStart.fire(e)})),s.tabsContainer.onGroupDragStart((function(e){s._onGroupDragStart.fire(e)})),s.tabsContainer.onDrop((function(e){s.handleDropEvent("header",e.event,"center",e.index)})),s.contentContainer.onDidFocus((function(){s.accessor.doSetGroupActive(s.groupPanel)})),s.contentContainer.onDidBlur((function(){})),s.contentContainer.dropTarget.onDrop((function(e){s.handleDropEvent("content",e.nativeEvent,e.position)})),s.tabsContainer.onWillShowOverlay((function(e){s._onWillShowOverlay.fire(e)})),s.contentContainer.dropTarget.onWillShowOverlay((function(e){s._onWillShowOverlay.fire(new events_2.WillShowOverlayLocationEvent(e,{kind:"content",panel:s.activePanel,api:s._api,group:s.groupPanel,getData:dataTransfer_1.getPanelData}))})),s._onMove,s._onDidChange,s._onDidDrop,s._onWillDrop,s._onDidAddPanel,s._onDidRemovePanel,s._onDidActivePanelChange,s._onUnhandledDragOverEvent,s._onDidPanelTitleChange,s._onDidPanelParametersChange),s}return __extends(t,e),Object.defineProperty(t.prototype,"element",{get:function(){throw new Error("dockview: not supported")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"activePanel",{get:function(){return this._activePanel},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"locked",{get:function(){return this._locked},set:function(e){this._locked=e,(0,dom_1.toggleClass)(this.container,"dv-locked-groupview","no-drop-target"===e||e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isActive",{get:function(){return this._isGroupActive},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"panels",{get:function(){return this._panels},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._panels.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isEmpty",{get:function(){return 0===this._panels.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasWatermark",{get:function(){return!(!this.watermark||!this.container.contains(this.watermark.element))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"header",{get:function(){return this.tabsContainer},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isContentFocused",{get:function(){return!!document.activeElement&&(0,dom_1.isAncestor)(document.activeElement,this.contentContainer.element)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"location",{get:function(){return this._location},set:function(e){switch(this._location=e,(0,dom_1.toggleClass)(this.container,"dv-groupview-floating",!1),(0,dom_1.toggleClass)(this.container,"dv-groupview-popout",!1),e.type){case"grid":this.contentContainer.dropTarget.setTargetZones(["top","bottom","left","right","center"]);break;case"floating":this.contentContainer.dropTarget.setTargetZones(["center"]),this.contentContainer.dropTarget.setTargetZones(e?["center"]:["top","bottom","left","right","center"]),(0,dom_1.toggleClass)(this.container,"dv-groupview-floating",!0);break;case"popout":this.contentContainer.dropTarget.setTargetZones(["center"]),(0,dom_1.toggleClass)(this.container,"dv-groupview-popout",!0)}this.groupPanel.api._onDidLocationChange.fire({location:this.location})},enumerable:!1,configurable:!0}),t.prototype.focusContent=function(){this.contentContainer.element.focus()},Object.defineProperty(t.prototype,"renderContainer",{get:function(){var e;return null!==(e=this._overwriteRenderContainer)&&void 0!==e?e:this.accessor.overlayRenderContainer},set:function(e){var t=this;this.panels.forEach((function(e){t.renderContainer.detatch(e)})),this._overwriteRenderContainer=e,this.panels.forEach((function(e){t.rerender(e)}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropTargetContainer",{get:function(){var e;return null!==(e=this._overwriteDropTargetContainer)&&void 0!==e?e:this.accessor.rootDropTargetContainer},set:function(e){this._overwriteDropTargetContainer=e},enumerable:!1,configurable:!0}),t.prototype.initialize=function(){var e=this;this.options.panels&&this.options.panels.forEach((function(t){e.doAddPanel(t)})),this.options.activePanel&&this.openPanel(this.options.activePanel),this.setActive(this.isActive,!0),this.updateContainer(),this.accessor.options.createRightHeaderActionComponent&&(this._rightHeaderActions=this.accessor.options.createRightHeaderActionComponent(this.groupPanel),this.addDisposables(this._rightHeaderActions),this._rightHeaderActions.init({containerApi:this._api,api:this.groupPanel.api,group:this.groupPanel}),this.tabsContainer.setRightActionsElement(this._rightHeaderActions.element)),this.accessor.options.createLeftHeaderActionComponent&&(this._leftHeaderActions=this.accessor.options.createLeftHeaderActionComponent(this.groupPanel),this.addDisposables(this._leftHeaderActions),this._leftHeaderActions.init({containerApi:this._api,api:this.groupPanel.api,group:this.groupPanel}),this.tabsContainer.setLeftActionsElement(this._leftHeaderActions.element)),this.accessor.options.createPrefixHeaderActionComponent&&(this._prefixHeaderActions=this.accessor.options.createPrefixHeaderActionComponent(this.groupPanel),this.addDisposables(this._prefixHeaderActions),this._prefixHeaderActions.init({containerApi:this._api,api:this.groupPanel.api,group:this.groupPanel}),this.tabsContainer.setPrefixActionsElement(this._prefixHeaderActions.element))},t.prototype.rerender=function(e){this.contentContainer.renderPanel(e,{asActive:!1})},t.prototype.indexOf=function(e){return this.tabsContainer.indexOf(e.id)},t.prototype.toJSON=function(){var e,t={views:this.tabsContainer.panels,activeView:null===(e=this._activePanel)||void 0===e?void 0:e.id,id:this.id};return!1!==this.locked&&(t.locked=this.locked),this.header.hidden&&(t.hideHeader=!0),t},t.prototype.moveToNext=function(e){e||(e={}),e.panel||(e.panel=this.activePanel);var t,n=e.panel?this.panels.indexOf(e.panel):-1;if(n<this.panels.length-1)t=n+1;else{if(e.suppressRoll)return;t=0}this.openPanel(this.panels[t])},t.prototype.moveToPrevious=function(e){if(e||(e={}),e.panel||(e.panel=this.activePanel),e.panel){var t,n=this.panels.indexOf(e.panel);if(n>0)t=n-1;else{if(e.suppressRoll)return;t=this.panels.length-1}this.openPanel(this.panels[t])}},t.prototype.containsPanel=function(e){return this.panels.includes(e)},t.prototype.init=function(e){},t.prototype.update=function(e){},t.prototype.focus=function(){var e;null===(e=this._activePanel)||void 0===e||e.focus()},t.prototype.openPanel=function(e,t){void 0===t&&(t={}),("number"!=typeof t.index||t.index>this.panels.length)&&(t.index=this.panels.length);var n=!!t.skipSetActive;e.updateParentGroup(this.groupPanel,{skipSetActive:t.skipSetActive}),this.doAddPanel(e,t.index,{skipSetActive:n}),this._activePanel!==e?(n||this.doSetActivePanel(e),t.skipSetGroupActive||this.accessor.doSetGroupActive(this.groupPanel),t.skipSetActive||this.updateContainer()):this.contentContainer.renderPanel(e,{asActive:!0})},t.prototype.removePanel=function(e,t){void 0===t&&(t={skipSetActive:!1});var n="string"==typeof e?e:e.id,i=this._panels.find((function(e){return e.id===n}));if(!i)throw new Error("invalid operation");return this._removePanel(i,t)},t.prototype.closeAllPanels=function(){var e,t;if(this.panels.length>0){var n=__spreadArray([],__read(this.panels),!1);try{for(var i=__values(n),o=i.next();!o.done;o=i.next()){var r=o.value;this.doClose(r)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}}else this.accessor.removeGroup(this.groupPanel)},t.prototype.closePanel=function(e){this.doClose(e)},t.prototype.doClose=function(e){var t=1===this.panels.length&&1===this.accessor.groups.length;this.accessor.removePanel(e,t&&"emptyGroup"===this.accessor.options.noPanelsOverlay?{removeEmptyGroup:!1}:void 0)},t.prototype.isPanelActive=function(e){return this._activePanel===e},t.prototype.updateActions=function(e){this.tabsContainer.setRightActionsElement(e)},t.prototype.setActive=function(e,t){void 0===t&&(t=!1),(t||this.isActive!==e)&&(this._isGroupActive=e,(0,dom_1.toggleClass)(this.container,"dv-active-group",e),(0,dom_1.toggleClass)(this.container,"dv-inactive-group",!e),this.tabsContainer.setActive(this.isActive),!this._activePanel&&this.panels.length>0&&this.doSetActivePanel(this.panels[0]),this.updateContainer())},t.prototype.layout=function(e,t){var n;this._width=e,this._height=t,this.contentContainer.layout(this._width,this._height),(null===(n=this._activePanel)||void 0===n?void 0:n.layout)&&this._activePanel.layout(this._width,this._height)},t.prototype._removePanel=function(e,t){var n=this._activePanel===e;if(this.doRemovePanel(e),n&&this.panels.length>0){var i=this.mostRecentlyUsed[0];this.openPanel(i,{skipSetActive:t.skipSetActive,skipSetGroupActive:t.skipSetActiveGroup})}return this._activePanel&&0===this.panels.length&&this.doSetActivePanel(void 0),t.skipSetActive||this.updateContainer(),e},t.prototype.doRemovePanel=function(e){var t=this.panels.indexOf(e);if(this._activePanel===e&&this.contentContainer.closePanel(),this.tabsContainer.delete(e.id),this._panels.splice(t,1),this.mostRecentlyUsed.includes(e)){var n=this.mostRecentlyUsed.indexOf(e);this.mostRecentlyUsed.splice(n,1)}var i=this._panelDisposables.get(e.id);i&&(i.dispose(),this._panelDisposables.delete(e.id)),this._onDidRemovePanel.fire({panel:e})},t.prototype.doAddPanel=function(e,t,n){var i=this;void 0===t&&(t=this.panels.length),void 0===n&&(n={skipSetActive:!1});var o=this._panels.indexOf(e)>-1;this.tabsContainer.show(),this.contentContainer.show(),this.tabsContainer.openPanel(e,t),n.skipSetActive||this.contentContainer.openPanel(e),o||(this.updateMru(e),this.panels.splice(t,0,e),this._panelDisposables.set(e.id,new lifecycle_1.CompositeDisposable(e.api.onDidTitleChange((function(e){return i._onDidPanelTitleChange.fire(e)})),e.api.onDidParametersChange((function(e){return i._onDidPanelParametersChange.fire(e)})))),this._onDidAddPanel.fire({panel:e}))},t.prototype.doSetActivePanel=function(e){this._activePanel!==e&&(this._activePanel=e,e&&(this.tabsContainer.setActivePanel(e),e.layout(this._width,this._height),this.updateMru(e),this._onDidActivePanelChange.fire({panel:e})))},t.prototype.updateMru=function(e){this.mostRecentlyUsed.includes(e)&&this.mostRecentlyUsed.splice(this.mostRecentlyUsed.indexOf(e),1),this.mostRecentlyUsed=__spreadArray([e],__read(this.mostRecentlyUsed),!1)},t.prototype.updateContainer=function(){var e,t,n=this;if(this.panels.forEach((function(e){return e.runEvents()})),this.isEmpty&&!this.watermark){var i=this.accessor.createWatermarkComponent();i.init({containerApi:this._api,group:this.groupPanel}),this.watermark=i,(0,events_1.addDisposableListener)(this.watermark.element,"pointerdown",(function(){n.isActive||n.accessor.doSetGroupActive(n.groupPanel)})),this.contentContainer.element.appendChild(this.watermark.element)}!this.isEmpty&&this.watermark&&(this.watermark.element.remove(),null===(t=(e=this.watermark).dispose)||void 0===t||t.call(e),this.watermark=void 0)},t.prototype.canDisplayOverlay=function(e,t,n){var i=new options_1.DockviewUnhandledDragOverEvent(e,n,t,dataTransfer_1.getPanelData,this.accessor.getPanel(this.id));return this._onUnhandledDragOverEvent.fire(i),i.isAccepted},t.prototype.handleDropEvent=function(e,t,n,i){if("no-drop-target"!==this.locked){var o="number"==typeof i?this.panels[i]:void 0,r=new DockviewWillDropEvent({nativeEvent:t,position:n,panel:o,getData:function(){return(0,dataTransfer_1.getPanelData)()},kind:function(){switch(e){case"header":return"number"==typeof i?"tab":"header_space";case"content":return"content"}}(),group:this.groupPanel,api:this._api});if(this._onWillDrop.fire(r),!r.defaultPrevented){var a=(0,dataTransfer_1.getPanelData)();if(a&&a.viewId===this.accessor.id){if("content"===e&&a.groupId===this.id){if("center"===n)return;if(null===a.panelId)return}if("header"===e&&a.groupId===this.id&&null===a.panelId)return;if(null===a.panelId){var s=a.groupId;return void this._onMove.fire({target:n,groupId:s,index:i})}if(-1!==this.tabsContainer.indexOf(a.panelId)&&1===this.tabsContainer.size)return;var l=a.groupId,p=a.panelId;if(this.id===l&&!n)if(this.tabsContainer.indexOf(p)===i)return;this._onMove.fire({target:n,groupId:a.groupId,itemId:a.panelId,index:i})}else this._onDidDrop.fire(new DockviewDidDropEvent({nativeEvent:t,position:n,panel:o,getData:function(){return(0,dataTransfer_1.getPanelData)()},group:this.groupPanel,api:this._api}))}}},t.prototype.updateDragAndDropState=function(){this.tabsContainer.updateDragAndDropState()},t.prototype.dispose=function(){var t,n,i,o,r;e.prototype.dispose.call(this),null===(i=this.watermark)||void 0===i||i.element.remove(),null===(r=null===(o=this.watermark)||void 0===o?void 0:o.dispose)||void 0===r||r.call(o),this.watermark=void 0;try{for(var a=__values(this.panels),s=a.next();!s.done;s=a.next()){s.value.dispose()}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}this.tabsContainer.dispose(),this.contentContainer.dispose()},t}(lifecycle_1.CompositeDisposable);exports.DockviewGroupPanelModel=DockviewGroupPanelModel;
//# sourceMappingURL=/sm/86734325396863a6e59461426126800369556843c3b0f7aa6febae0d2bd6b4fe.map