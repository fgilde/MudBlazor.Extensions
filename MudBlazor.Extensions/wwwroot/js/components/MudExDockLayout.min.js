export function initializeMudExDockLayout(t,i,r,u){return new n(t,i,r,u)}class n{elementRef;dotnet;options;containerRef;api;elementStore=new Map;bootstrapped=false;observer=null;constructor(n,t,i,r){this.elementRef=n;this.dotnet=i;this.containerRef=t;this.options=r||{};this.init()}async init(){const{createDockview:n}=await import(this.options.module);if(this.api=n(this.containerRef,{theme:{className:this.options.className??"dockview-theme-abyss"},dndEdges:{top:!0,right:!0,bottom:!0,left:!0},createComponent:n=>{const t=this.elementStore.get(n.id);if(t)return t.style.display="",t.style.height="100%",t.style.width="100%",t.style.overflow="auto",{element:t,init(){},update(){},dispose(){}};const i=document.createElement("div");return i.textContent="blazor",{element:i,init(){},update(){},dispose(){}}}}),this.indexDomLeaves(),this.options.initialLayoutJson)try{this.api.fromJSON(JSON.parse(this.options.initialLayoutJson));this.bootstrapped=!0;this.dotnet?.invokeMethodAsync("OnJsReady");return}catch(t){console.warn("fromJSON failed",t)}this.dotnet?.invokeMethodAsync("OnJsReady");this.observeAndBootstrap()}indexDomLeaves(){const n=this.containerRef.querySelectorAll(".dv-node");for(const t of n){const n=Array.from(t.children).some(n=>n.classList?.contains("dv-node"));if(!n){const n=JSON.parse(t.dataset.options||"{}");if(!n.id)continue;t.style.display="none";this.elementStore.set(n.id,t)}}}observeAndBootstrap(){const n=()=>{if(!this.bootstrapped){const n=this._rootNodes();n.length!==0&&(this.bootstrapFromDom(n),this.bootstrapped=!0,this.observer?.disconnect())}};n();this.observer=new MutationObserver(()=>n());this.observer.observe(this.containerRef,{childList:!0,subtree:!0})}setOptions(n){this.options=n}_rootNodes(){return Array.from(this.containerRef.children).filter(n=>n.classList?.contains("dv-node"))}bootstrapFromDom(n){const t=[];for(const i of n){const r=JSON.parse(i.dataset.options||"{}"),u=r.direction?.toLowerCase()||"right";let n=null;this._planFromNode(i,u,t,()=>n,t=>{n=t})}for(const n of t){const i={id:n.id,component:"blazor",title:n.title};n.position&&(i.position=n.position);const t=this.api.addPanel(i);n.hideHeader!==!0||this.containerRef.classList.contains("dv-hide-tabs")||(t.group.header.hidden=!0);n.float===!0&&this.api.addFloatingGroup(t,n.floatBounds||undefined);n.locked!=null&&(t.group.locked=n.locked===!0?!0:n.locked)}}_planFromNode(n,t,i,r,u){const e=Array.from(n.children).filter(n=>n.classList?.contains("dv-node")),s=e.length>0,f=JSON.parse(n.dataset.options||"{}");if(!s){const n=f.id,o=f.title??n,s=!!f.hideHeader,h=!!f.isFloating,e=r(),c={id:n,title:o,hideHeader:s,float:h,position:e?{referencePanel:e,direction:t}:{direction:t}};i.push(c);u(n);return}const h=f.direction?.toLowerCase()||t||"right";let o=null;for(const n of e)this._planFromNode(n,h,i,()=>o,n=>{o=n})}toJSON(){try{return JSON.stringify(this.api?.toJSON()??{})}catch(n){return"{}"}}fromJSON(n){try{this.api?.fromJSON(typeof n=="string"?JSON.parse(n):n)}catch(t){}}}window.MudExDockLayout=n;