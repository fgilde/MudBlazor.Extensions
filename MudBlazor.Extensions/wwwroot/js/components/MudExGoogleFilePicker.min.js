export function initializeMudExGoogleFilePicker(t,i,r){return new n(t,i,r)}class n{elementRef;dotnet;options;accessToken=null;pickerInited=false;gisInited=false;tokenClient;constructor(n,t,i){this.elementRef=n;this.dotnet=t;this.options=i;this.loadGoogleApis()}loadGoogleApis(){const n=document.createElement("script");n.async=!0;n.defer=!0;n.src="https://apis.google.com/js/api.js";n.onload=this.gapiLoaded.bind(this);document.body.appendChild(n);const t=document.createElement("script");t.async=!0;t.defer=!0;t.src="https://accounts.google.com/gsi/client";t.onload=this.gisLoaded.bind(this);document.body.appendChild(t)}gapiLoaded(){gapi.load("client:picker",this.initializePicker.bind(this))}async initializePicker(){await gapi.client.load("https://www.googleapis.com/discovery/v1/apis/drive/v3/rest");this.pickerInited=!0;this.maybeEnableButtons()}gisLoaded(){this.tokenClient=google.accounts.oauth2.initTokenClient({client_id:this.options.clientId,scope:"https://www.googleapis.com/auth/drive.metadata.readonly",callback:""});this.gisInited=!0;this.maybeEnableButtons()}maybeEnableButtons(){this.pickerInited&&this.gisInited&&this.dotnet.invokeMethodAsync("OnReady")}handleAuthClick(){this.tokenClient.callback=async n=>{if(n.error!==undefined)throw n;this.accessToken=n.access_token;await this.createPicker()};this.accessToken===null?this.tokenClient.requestAccessToken({prompt:"consent"}):this.tokenClient.requestAccessToken({prompt:""})}handleSignoutClick(){this.accessToken&&(this.accessToken=null,google.accounts.oauth2.revoke(this.accessToken))}createPicker(){const n=new google.picker.View(google.picker.ViewId.DOCS),t=(new google.picker.PickerBuilder).enableFeature(google.picker.Feature.MULTISELECT_ENABLED).setDeveloperKey(this.options.apiKey).setAppId(this.options.appId).setOAuthToken(this.accessToken).addView(n).addView(new google.picker.DocsUploadView).setCallback(this.pickerCallback.bind(this)).build();t.setVisible(!0)}async pickerCallback(n){if(n.action===google.picker.Action.PICKED)const t=n[google.picker.Response.DOCUMENTS][0],i=t[google.picker.Document.ID],r=await gapi.client.drive.files.get({fileId:i,fields:"*"})}dispose(){}}window.MudExGoogleFilePicker=n;