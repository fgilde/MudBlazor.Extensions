export function initializeMudExOneDriveFilePicker(t,i,r){return new n(t,i,r)}class n{elementRef;dotnet;options;accessToken=null;pickerInited=false;constructor(n,t,i){this.elementRef=n;this.dotnet=t;this.setOptions(i)}setOptions(n){this.options=n;this.options.clientId&&this.loadOneDriveApi()}loadOneDriveApi(){const n=document.getElementById("onedrivejs");if(n)this.apiLoaded();else{const n=document.createElement("script");n.async=!0;n.defer=!0;n.id="onedrivejs";n.src="https://js.live.net/v7.2/OneDrive.js";n.onload=this.apiLoaded.bind(this);document.body.appendChild(n)}}apiLoaded(){this.pickerInited=!0;this.dotnet.invokeMethodAsync("OnReady")}openPicker(){const n={clientId:this.options.clientId,action:"query",multiSelect:this.options.multiSelect||!1,advanced:{redirectUri:this.options.redirectUri||window.location.origin,accessToken:this.accessToken||undefined},success:n=>{const t=n.value.map(n=>{const t=n.name.split(".").pop();return{id:n.id,accessToken:this.accessToken,fileName:n.name,extension:t,contentType:n.file?n.file.mimeType:null,webViewLink:n.webUrl,webContentLink:null,data:null,size:n.size}});this.dotnet.invokeMethodAsync("OnFilesSelected",t)},cancel:()=>{this.dotnet.invokeMethodAsync("OnFilesSelected",[])},error:n=>{console.error(n)}};OneDrive.open(n)}dispose(){}}window.MudExOneDriveFilePicker=n;